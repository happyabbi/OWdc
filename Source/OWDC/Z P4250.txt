Listing of ER for Application : Shipment Confirmation (P4205)


=======================================================================
     FORM: Shipment Confirmation Line Defaults [FIX INSPECT] (W4205B)
=======================================================================
     CONTROL:  FORM
     EVENT:  Dialog is Initialized
-----------------------------------------------------------------------
0001 // ========================================================================
0002 // Demand Scheduling - Times - Shipment Confirmation
0003 // Determine if demand scheduling is delivered and set flag.
0004 // ========================================================================
0005 Is Demand Scheduling Delivered For Use
        VA frm_cDSReleased_DSRFU <- cDemandSchedulingReleased

-----------------------------------------------------------------------
     EVENT:  Post Dialog is Initialized
-----------------------------------------------------------------------
0001 FC Container I.D = FI Containerid
0002 FC Carrier Number = FI Carrier
0003 FC Actual Ship = FI Actualdeliverydate
0004 //
0005 // ========================================================================
0006 // Demand Scheduling - Times - Shipment Confirmation
0007 // ========================================================================
0008 If VA frm_cDSReleased_DSRFU is equal to "1"
0009    FC Actual Shipment Time = FI mnActualShipTime
0010 Else
0011    Hide Control(FC Actual Shipment Time)
0012 End If
0013 //
0014 //     Default today's date if not specified.
0015 //
0016 If FC Actual Ship is equal to <Zero>
0017    FC Actual Ship = date_today( )
0018 End If
0019 //
0020 // SAR #2117915
0021 //  Disable Carrier and Ship Date Controls if P4205 was called by Transportation
0022 If FI mnTRAN_JobnumberA is greater than <Zero>
0023    Disable Control(FC Actual Ship)
0024    Disable Control(FC Carrier Number)
0025    //
0026    // ========================================================================
0027    // Demand Scheduling - Times - Shipment Confirmation
0028    // ========================================================================
0029    If VA frm_cDSReleased_DSRFU is equal to "1"
0030       Disable Control(FC Actual Shipment Time)
0031    End If
0032 End If

-----------------------------------------------------------------------
     EVENT:  Variable
-----------------------------------------------------------------------
     frm_cDSReleased_DSRFU

=======================================================================
     CONTROL:  HYPITEM &OK
     EVENT:  Post Button Clicked
-----------------------------------------------------------------------
0001 //
0002 //     After OK button is clicked , move form values into form interconnect
0003 //     fields.
0004 //
0005 BC Date - Actual Ship Date (F4211) = FC Actual Ship
0006 BC Container I.D. (F4211) = FC Container I.D
0007 BC Carrier Number (F4211) = FC Carrier Number
0008 //
0009 // =========================================================================
0010 // Demand Scheduling - Times - Shipment Confirmation
0011 // =========================================================================
0012 If VA frm_cDSReleased_DSRFU is equal to "1"
0013    BC Actual Shipment Time (F4211) = FC Actual Shipment Time
0014 End If

=======================================================================
     CONTROL:  EDIT Actual Shipment Time
     EVENT:  Control Exited/Changed-Inline
-----------------------------------------------------------------------
0001 // =======================================================
0002 // Edit entered time
0003 // =======================================================
0004 Edit Numeric Time Entry
        FC Actual Shipment Time <> mnTimeEntered
        <Blank> -> cSuppressErrorMessages

=======================================================================
     FORM: Additional Line Items [HEADERLESS DETAIL] (W4205D)
=======================================================================
     CONTROL:  FORM
     EVENT:  Dialog is Initialized
-----------------------------------------------------------------------
0001 //                                     REVISIONS LOG
0002 // ********************************************************************
0003 // Date                  Programmer     SAR #            Description
0004 // 06/21/2004      IC8859768       7144277        Show Additional Line Items
0005 // in Sales order detail.
0006 // ********************************************************************
0007 //
0008 //     Initialize work fields.
0009 //
0010 FC JOBS-Job Number (wf) = "0"
0011 FC OTOT-Order Total (wf) = "0"
0012 FC FAP-Foreign Order Total (wf) = "0"
0013 //
0014 //     Disable buttons on toolbar.
0015 //
0016 Disable Control(FC F&ind)
0017 Disable Control(FC &Delete)
0018 //
0019 // ==========================================================
0020 // Demand Scheduling - Times - Shipment Confirmation
0021 // Determine if demand scheduling has been released.
0022 // ==========================================================
0023 Is Demand Scheduling Delivered For Use
        VA frm_cDSReleased_DSRFU <- cDemandSchedulingReleased

-----------------------------------------------------------------------
     EVENT:  Post Dialog is Initialized
-----------------------------------------------------------------------
0001 Get Audit Information
        FC USR0-User ID (wf) [HIDDEN] <- szUserName
        FC UPMJ-Date Updated (wf) [HIDDEN] <- jdDate
        FC TDAY-Time of Day (wf) [HIDDEN] <- mnTime
        VA frm_szWorkstation_JOBN <- szWorkstation_UserId
        FC CTID-Computer ID (wf) [HIDDEN] <- szMachineKey
0002 F0010 Get Currency Conversion Flag
        FC CRYR:  Currency Control [HIDDEN] <- cCurrencyConverFlag
0003 ! F4201 Get Hold Code, Order Totals, and Information
     !    FI DocumentOrderInvoiceE -> mnOrderNumber
     !    FI OrderType -> szOrderType
     !    FI CompanyKeyOrderNo -> szKeyCompany
     !    UNDEFINED X szTakenBy
     !    UNDEFINED X szErrorMesgID
     !    <Zero> -> cSuppressErrorMesg
     !    FC OTOT-Order Total (wf) [HIDDEN] <- mnOrderTotal
     !    FC FAP-Foreign Order Total (wf) [HIDDEN] <- mnForeignOrderTotal
     !    UNDEFINED X szCompany
     !    UNDEFINED X szCustomerPO
     !    UNDEFINED X szHoldCode
     !    UNDEFINED X mnSoldToAddrNumber
     !    UNDEFINED X mnShipToAddrNumber
     !    UNDEFINED X szPaymentTermsCode
     !    UNDEFINED X szDisplayWeightUOM
     !    UNDEFINED X szDisplayVolumeUOM
     !    UNDEFINED X szBranchPlant
     !    UNDEFINED X szCurrencyCodeFrom
     !    UNDEFINED X mnCurrencyConvRate
     !    UNDEFINED X szTaxArea1
     !    UNDEFINED X szTaxExplanationCode1
     !    UNDEFINED X szVendorReference2
     !    UNDEFINED X cBackOrderedYN
     !    UNDEFINED X jdRequestedDate
     !    UNDEFINED X jdTransactionDate
     !    UNDEFINED X jdPromisedDelDate
     !    UNDEFINED X mnCarrierNumber
     !    UNDEFINED X mnBuyerNumber
     !    UNDEFINED X szRouteCode
     !    UNDEFINED X szStopCode
     !    UNDEFINED X szZoneNumber
     !    UNDEFINED X mnTradeDiscount
     !    UNDEFINED X mnCommissionCode1
     !    UNDEFINED X mnCommissionCode2
     !    UNDEFINED X mnCommissionRate1
     !    UNDEFINED X mnCommissionRate2
     !    UNDEFINED X jdOriginalPromiseDate
     !    UNDEFINED X cSubstitutesAllowedYN
     !    UNDEFINED X cPriorityProcessing
     !    UNDEFINED X szPrintMesg
     !    UNDEFINED X szTaxExemptionCode
     !    UNDEFINED X szDeliveryInstrns1
     !    UNDEFINED X szDeliveryInstrns2
     !    UNDEFINED X szFreightHandlingCode
0004 F4201.Fetch Single
        FI CompanyKeyOrderNo =  TK Order Company (Order Number)
        FI DocumentOrderInvoiceE =  TK Document (Order No, Invoice, etc.)
        FI OrderType =  TK Order Type
        FC OTOT-Order Total (wf) [HIDDEN] <- TK Amount - Order Gross
        VA frm_CurrencyMode <- TK Currency Mode-Foreign or Domestic Entry
        FC FAP-Foreign Order Total (wf) [HIDDEN] <- TK Amount - Foreign Open
0005 //
0006 //     If cUseCache == '2', then use cache to store F42UI11 information.
0007 //     If cUseCache == '1', then use F42UI01 and F42UI11 work file.
0008 //
0009 VA frm_cUseCache_EV22 = "1"
0010 //
0011 // Hide or display domestic currency replated fields based upon
0012 // value of SL Currency Processing ("Y" or "Z" equals on) and the
0013 // value of the Currency Mode from the Sales Order Header. This
0014 // logic emulates similar logic used to generate Sales Order Details.
0015 //
0016 If FC CRYR:  Currency Control is equal to "Y"
     Or FC CRYR:  Currency Control is equal to "Z"
0017    If VA frm_CurrencyMode is equal to "F"
        Or VA frm_CurrencyMode is equal to <Blank>
0018       Hide Grid Column(FC Grid, GC UnitCost)
0019       Hide Grid Column(FC Grid, GC ExtendedCost)
0020       Hide Grid Column(FC Grid, GC UnitPrice)
0021       Hide Grid Column(FC Grid, GC ExtendedPrice)
0022       Show Grid Column(FC Grid, GC Foreign UnitCost)
0023       Show Grid Column(FC Grid, GC Foreign ExtendedCost)
0024       Show Grid Column(FC Grid, GC ForeignUnit Price)
0025       Show Grid Column(FC Grid, GC ForeignExtended Price)
0026    Else
0027       Show Grid Column(FC Grid, GC UnitCost)
0028       Show Grid Column(FC Grid, GC ExtendedCost)
0029       Show Grid Column(FC Grid, GC UnitPrice)
0030       Show Grid Column(FC Grid, GC ExtendedPrice)
0031       Hide Grid Column(FC Grid, GC Foreign UnitCost)
0032       Hide Grid Column(FC Grid, GC Foreign ExtendedCost)
0033       Hide Grid Column(FC Grid, GC ForeignUnit Price)
0034       Hide Grid Column(FC Grid, GC ForeignExtended Price)
0035    End If
0036 Else
0037    Show Grid Column(FC Grid, GC UnitCost)
0038    Show Grid Column(FC Grid, GC ExtendedCost)
0039    Show Grid Column(FC Grid, GC UnitPrice)
0040    Show Grid Column(FC Grid, GC ExtendedPrice)
0041    Hide Grid Column(FC Grid, GC Foreign UnitCost)
0042    Hide Grid Column(FC Grid, GC Foreign ExtendedCost)
0043    Hide Grid Column(FC Grid, GC ForeignUnit Price)
0044    Hide Grid Column(FC Grid, GC ForeignExtended Price)
0045 End If

-----------------------------------------------------------------------
     EVENT:  Variable
-----------------------------------------------------------------------
     frm_cUseCache_EV22
     frm_szWorkstation_JOBN
     frm_CurrencyMode
     frm_szLineTypeDescription_LNDS
     frm_cDSReleased_DSRFU
     frm_mn_ProcessID_MATH01
     frm_mnTransactionID_MATH01
     frm_cEditItemMasterFlag_PDC3
     frm_szDescription_DSC1
     frm_idPointer_GENLNG

=======================================================================
     CONTROL:  HYPITEM &OK
     EVENT:  Button Clicked
-----------------------------------------------------------------------
0001 // ~~~~~ SAR 6834735 Begin ~~~~~
0002 F4211 Edit Doc
        FC JOBS-Job Number (wf) [HIDDEN] -> mnCMJobNo
        FI DocumentOrderInvoiceE -> mnSalesOrderNo
        FC CTID-Computer ID (wf) [HIDDEN] -> szCMComputerID
        FC ERRC-Error Condition (wf) [HIDDEN] <- cCMErrorCondition
        FI OrderType -> szOrderType
        FI CompanyKeyOrderNo -> szKeyCompany
        FC OTOT-Order Total (wf) [HIDDEN] -> mnOrderTotal
        FC FAP-Foreign Order Total (wf) [HIDDEN] -> mnForeignOrderTotal
        FC CRDC-Base Currency (wf) [HIDDEN] -> szBaseCurrencyCode
        "EP4205" -> szProgramID
        VA frm_szWorkstation_JOBN -> szWorkstationID
        "P4210" -> szCMProgramID
        PO szSOEVersion -> szCMVersion
        FC TDAY-Time of Day (wf) [HIDDEN] -> mnTimeOfDay
        VA frm_cUseCache_EV22 -> cCMUseWorkFiles
        "1" -> cGenericChar1_EV01
        VA frm_mn_ProcessID_MATH01 <> mnProcessID
        VA frm_mnTransactionID_MATH01 <> mnTransactionID
0003 // ~~~~~ SAR 6834735 End ~~~~~

-----------------------------------------------------------------------
     EVENT:  Post Button Clicked
-----------------------------------------------------------------------
0001 // ~~~~~ SAR 6834735 Begin ~~~~~
0002 If FC ERRC-Error Condition (wf) is less than or equal to <Blank>
0003    // ~~~~~ SAR 6834735 End ~~~~~
0004    F4211 End Document
           FC JOBS-Job Number (wf) [HIDDEN] -> mnCMJobNo
           FI DocumentOrderInvoiceE -> mnSalesOrderNo
           FC CTID-Computer ID (wf) [HIDDEN] -> szCMComputerID
           FC ERRC-Error Condition (wf) [HIDDEN] <- cCMErrorCondition
           FI OrderType -> szOrderType
           FI CompanyKeyOrderNo -> szKeyCompany
           FC OTOT-Order Total (wf) [HIDDEN] -> mnOrderTotal
           FC FAP-Foreign Order Total (wf) [HIDDEN] -> mnForeignOrderTotal
           FC CRDC-Base Currency (wf) [HIDDEN] -> szBaseCurrencyCode
           "EP4205" -> szProgramID
           VA frm_szWorkstation_JOBN -> szWorkstationID
           "P4210" -> szCMProgramID
           PO szSOEVersion -> szCMVersion
           FC TDAY-Time of Day (wf) [HIDDEN] -> mnTimeOfDay
           VA frm_cUseCache_EV22 -> cCMUseWorkFiles
           "1" <> cGenericChar2
           VA frm_mn_ProcessID_MATH01 <> mnProcessID
           VA frm_mnTransactionID_MATH01 <> mnTransactionID
0005 End If

=======================================================================
     CONTROL:  HYPITEM &Cancel
     EVENT:  Post Button Clicked
-----------------------------------------------------------------------
0001 F4211 Delete Work File
        FC JOBS-Job Number (wf) [HIDDEN] -> mnJobNo
        FC CTID-Computer ID (wf) [HIDDEN] -> szComputerID
        UNDEFINED X mnFromLineNo
        UNDEFINED X mnThruLineNo
        VA frm_cUseCache_EV22 -> cClearHeaderWF
        VA frm_cUseCache_EV22 -> cClearDetailWF
        "EP4205" -> szProgramID
        UNDEFINED X mnWKRelatedOrderProcess
        PO szSOEVersion -> szCMVersion
        UNDEFINED X cGenericChar1_EV01
        UNDEFINED X cGenericChar2_EV02
        UNDEFINED X szGenericString1_DL01
        UNDEFINED X mnSODRelatedJobNumber
        UNDEFINED X mnProcessID
        UNDEFINED X mnTransactionID

=======================================================================
     CONTROL:  GRID Grid
     EVENT:  Add Last Entry Row to Grid
-----------------------------------------------------------------------
0001 GC LnTy = PO szLinetypeNewLine
0002 GC XLIN:  WF Line Number = "0"
0003 //
0004 If GC LnTy is not equal to <Blank> And GC LnTy is not equal to <Null>
0005    FC ERR (wf) = "0"
0006    F40205 Get Line Type Constants
           GC Ln Ty -> szLineType
           VA frm_szLineTypeDescription_LNDS <- szLineTypeDesc
           FC IVI-Inventory Interface [HIDDEN] <- cInventoryInterface
           VA frm_cEditItemMasterFlag_PDC3 <- cPrintDocument3
           <Zero> -> cSuppressErrorMessage
           FC ERR (wf) [HIDDEN] <- cErrorCode
0007    If FC IVI-Inventory Interface is not equal to "N"
        And FC ERR (wf) is equal to "0"
0008       Set Grid Cell Error(FC Grid, <Current Row>, GC LnTy, "0239")
0009       FC ERR (wf) = "1"
0010    End If
0011    //
0012    // If the 'Edit Item Master for Non-Stock' flag is turned on, the item
0013    // description should be passed to Edit Line, otherwise the line type
0014    // description should be passed.
0015    If VA frm_cEditItemMasterFlag_PDC3 is not equal to "1,Y"
0016       GC Description = VA frm_szLineTypeDescription_LNDS
0017    End If
0018 End If

-----------------------------------------------------------------------
     EVENT:  Row Exit & Changed - Asynch
-----------------------------------------------------------------------
     evt_mnProcessId_MATH01
     evt_mnTransactionId_MATH01
0001 //
0002 //
0003 // If a domestic or foreign Price or Cost field is zeroed, zero out the
0004 // corresponding Price or Cost field (depending which is not displayed)
0005 //
0006 If FC CRYR:  Currency Control is equal to "Y"
     Or FC CRYR:  Currency Control is equal to "Z"
0007    If VA frm_CurrencyMode is equal to "F"
        Or VA frm_CurrencyMode is equal to <Blank>
0008       If GC Foreign UnitCost is equal to <Zero>
0009          GC UnitCost = "0"
0010       End If
0011       If GC Foreign ExtendedCost is equal to <Zero>
0012          GC ExtendedCost = "0"
0013       End If
0014       If GC ForeignUnit Price is equal to <Zero>
0015          GC UnitPrice = "0"
0016       End If
0017       If GC ForeignExtended Price is equal to <Zero>
0018          GC ExtendedPrice = "0"
0019       End If
0020    Else
0021       If GC UnitCost is equal to <Zero>
0022          GC Foreign UnitCost = "0"
0023       End If
0024       If GC ExtendedCost is equal to <Zero>
0025          GC Foreign ExtendedCost = "0"
0026       End If
0027       If GC UnitPrice is equal to <Zero>
0028          GC ForeignUnit Price = "0"
0029       End If
0030       If GC ExtendedPrice is equal to <Zero>
0031          GC ForeignExtended Price = "0"
0032       End If
0033    End If
0034 Else
0035    If GC UnitCost is equal to <Zero>
0036       GC Foreign UnitCost = "0"
0037    End If
0038    If GC ExtendedCost is equal to <Zero>
0039       GC Foreign ExtendedCost = "0"
0040    End If
0041    If GC UnitPrice is equal to <Zero>
0042       GC ForeignUnit Price = "0"
0043    End If
0044    If GC ExtendedPrice is equal to <Zero>
0045       GC ForeignExtended Price = "0"
0046    End If
0047 End If
0048 //
0049 //     If a line is entered, process this line using the F4211 Edit Line.
0050 //
0051 If GC QuantityShipped is not equal to "0"
     Or GC UnitPrice is not equal to "0"
     Or GC ExtendedPrice is not equal to "0"
     Or GC Description is greater than " "
0052    //
0053    //     This window only allows non-stock or text lines to be entered, if
0054    //     attempting to enter a stock line item, issue error.
0055    //
0056    FC ERR (wf) = "0"
0057    F40205 Get Line Type Constants
           GC Ln Ty -> szLineType
           VA frm_szLineTypeDescription_LNDS <- szLineTypeDesc
           FC IVI-Inventory Interface [HIDDEN] <- cInventoryInterface
           VA frm_cEditItemMasterFlag_PDC3 <- cPrintDocument3
           <Zero> -> cSuppressErrorMessage
           FC ERR (wf) [HIDDEN] <- cErrorCode
0058    If FC IVI-Inventory Interface is not equal to "N" And FC ERR (wf) is equal to <Zero>
0059       Set Grid Cell Error(FC Grid,  <Currently Selected Row>, GC LnTy, "0239")
0060       FC ERR (wf) = "1"
0061    End If
0062    //
0063    // If the 'Edit Item Master for Non-Stock' flag is turned on, the item
0064    // description should be passed to Edit line, otherwise the line type
0065    // description should be passed.
0066    //
0067    If VA frm_cEditItemMasterFlag_PDC3 is equal to "1,Y"
0068       F4101 Get Item Master Row
              GC Description -> szPrimaryItemNumber
              VA frm_szDescription_DSC1 <- szDescription
              <Blank> -> cSymbolidentifier
              VA frm_idPointer_GENLNG <> idF4101LongRowPtr
0069       Memory, Free Ptr To Data Structure
              VA frm_idPointer_GENLNG <> idGenericLong
0070    Else
0071       VA frm_szDescription_DSC1 = VA frm_szLineTypeDescription_LNDS
0072    End If
0073    //
0074    //     Call the F4211 Edit Line to edit this line if no error to line type.
0075    //
0076    If FC ERR (wf) is equal to "0"
0077       F4211  Edit Line
              FC JOBS-Job Number (wf) [HIDDEN] <> mnCMJobNo
              "A" -> cCMLineAction
              "1" -> cCMProcessEdits
              VA frm_cUseCache_EV22 -> cCMWriteToWFFlag
              GC EV01-Record Written to F42UI11 [HIDDEN] <> cCMRecdWrittenToWF
              FC CTID-Computer ID (wf) [HIDDEN] -> szCMComputerID
              FC ERRC-Error Condition (wf) [HIDDEN] <- cCMErrorConditions
              FI CompanyKeyOrderNo -> szOrderCo
              FI DocumentOrderInvoiceE -> mnOrderNo
              FI OrderType -> szOrderType
              <Zero> -> mnLineNo
              GC Description -> szItemNo
              VA frm_szDescription_DSC1 -> szDescription1
              GC Ln Ty <> szLineType
              "914" -> szLastStatus
              PO szStatusNextAddLine -> szNextStatus
              GC Quantity Shipped <> mnQtyOrdered
              GC Quantity Shipped <> mnQtyShipped
              GC Unit Price <> mnUnitPrice
              GC Extended Price <> mnExtendedPrice
              GC Unit Cost <> mnUnitCost
              GC Extended Cost <> mnExtendedCost
              GC UoM <> szTransactionUOM
              GC UoM <> szPricingUOM
              GC Foreign Unit Price <> mnForeignUnitPrice
              GC Foreign Extended Price <> mnForeignExtPrice
              GC Foreign Unit Cost <> mnForeignUnitCost
              GC Foreign Extended Cost <> mnForeignExtCost
              GC XLIN:  WF Line  Number [HIDDEN] <> mnCMLineNo
              "EP4205" -> szCMProgramID
              PO szSOEVersion -> szCMVersion
              "1" -> cOverridePrice
              "1" -> cOverrideCost
              FC USR0-User ID (wf) [HIDDEN] -> szUserID
              FC UPMJ-Date Updated (wf) [HIDDEN] -> jdDateUpdated
              FC OTOT-Order Total (wf) [HIDDEN] <> mnWKOrderTotal
              FC FAP-Foreign Order Total (wf) [HIDDEN] <> mnWKForeignOrderTotal
              "1" -> cWKProcessingType
              <Blank> -> cWKSourceOfData
              <Blank> -> cWKCheckAvailability
              FC LNIX-Prev WF Line Num [HIDDEN] <> mnLastLineNoAssigned
              VA evt_mnProcessId_MATH01 <> mnProcessID
              VA evt_mnTransactionId_MATH01 <> mnTransactionID
0078       //
0079       F42UI11.Update
              FC CTID-Computer ID (wf) [HIDDEN] =  TK Computer ID
              FC JOBS-Job Number (wf) [HIDDEN] =  TK Job Number
              GC XLIN:  WF Line  Number [HIDDEN] =  TK Line Number - X-REF
              FI CompanyKeyOrderNo =  TK Order Company (Order Number)
              FI DocumentOrderInvoiceE =  TK Document (Order No, Invoice, etc.)
              FI OrderType =  TK Order Type
              FI Actualdeliverydate -> TK Date - Actual Ship Date
              FI szContainer_ID_F4211 -> TK Container I.D.
0080       //
0081       // ==========================================================
0082       // Demand Scheduling - Times - Shipment Confirmation
0083       // Update actual ship time with the default ship time assigned by
0084       // transportation or the line defaults form.
0085       // ==========================================================
0086       If VA frm_cDSReleased_DSRFU is equal to "1"
0087          F42UI12.Update
                 FC CTID-Computer ID (wf) [HIDDEN] =  TK Computer ID
                 FC JOBS-Job Number (wf) [HIDDEN] =  TK Job Number
                 GC XLIN:  WF Line  Number [HIDDEN] =  TK Line Number - X-REF
                 FI CompanyKeyOrderNo =  TK Order Company (Order Number)
                 FI DocumentOrderInvoiceE =  TK Document (Order No, Invoice, etc.)
                 FI OrderType =  TK Order Type
                 FI mnActualShipTime -> TK Actual Shipment Time
0088       End If
0089    End If
0090 End If

=======================================================================
     CONTROL:  GRIDCOL Ln Ty
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 FC ERR (wf) = "0"
0002 F40205 Get Line Type Constants
        GC Ln Ty -> szLineType
        VA frm_szLineTypeDescription_LNDS <- szLineTypeDesc
        FC IVI-Inventory Interface [HIDDEN] <- cInventoryInterface
        VA frm_cEditItemMasterFlag_PDC3 <- cPrintDocument3
        <Zero> -> cSuppressErrorMessage
        FC ERR (wf) [HIDDEN] <- cErrorCode
0003 If FC IVI-Inventory Interface is not equal to "N"
     And FC ERR (wf) is equal to "0"
0004    Set Grid Cell Error(FC Grid, <Current Row>, GC LnTy, "0239")
0005    FC ERR (wf) = "1"
0006 End If
0007 //
0008 // If the 'Edit Item Master for Non-Stock' flag is turned on, the item
0009 // description should be passed to Edit Line, otherwise the line type
0010 // description should be passed.
0011 If VA frm_cEditItemMasterFlag_PDC3 is equal to "1,Y"
0012    F4101 Get Item Master Row
           GC Description -> szPrimaryItemNumber
           VA frm_szDescription_DSC1 <- szDescription
           <Blank> -> cSymbolidentifier
           VA frm_idPointer_GENLNG <> idF4101LongRowPtr
0013    Memory, Free Ptr To Data Structure
           VA frm_idPointer_GENLNG <> idGenericLong
0014 Else
0015    VA frm_szDescription_DSC1 = VA frm_szLineTypeDescription_LNDS
0016    If GC Description is equal to or empty <Blank>
0017       GC Description = VA frm_szDescription_DSC1
0018    End If
0019 End If

=======================================================================
     FORM: Work with Shipment Confirmation [FIND BROWSE] (W4205H)
=======================================================================
     CONTROL:  FORM
     EVENT:  Dialog is Initialized
-----------------------------------------------------------------------
0001 // ==================================================================
0002 // Revisions Log:
0003 // ==================================================================
0004 // Date           Programmer      SAR#         Description
0005 // 07/09/04    I_8849981         7138619   To prevent showing all the
0006 // shipments when the user searches in the Find/Browse form on shipment
0007 // number.
0008 // 10/28/04    IC8761912         7395076   Show all selected lines when Form
0009 // Exit 'Confirm Shown Rows' is taken.
0010 // ==================================================================
0011 //
0012 //      The following selection criteria are implemented using filter fields:
0013 //      1.  Bypass if line is cancelled  (SDNXTR == '999')
0014 //      2. Bypass if branch/plant is different from header B/P filter.
0015 //      3. Bypass if the OH has already been updated   (SDSO02 == '1')
0016 //      4. Bypass if future qty (SDSONE) > 0
0017 //
0018 FC NXTR: Next Status Filter = "999"
0019 FC SO02: On Hand Updated = "1"
0020 FC SONE: Future Qty Filter = "0"
0021 //
0022 If FC Order Type is equal to  <Blank>
     Or FI szOrderType is equal to <Null>
0023    FC Order Type = PO szDefaultOrdertype
0024 End If
0025 //
0026 // disable buttons Confirm Row and Confirm All Shown Rows until after the Find
0027 // button has been pressed.
0028 //
0029 Disable Control(HC Confirm &Line)
0030 Disable Control(HC Confirm Shown &Rows)
0031 //
0032 // Bulk Refactoring - Begin
0033 // Initialize Previous Order Keys
0034 VA frm_Previous_OrderNumber_DOCO = ""
0035 VA frm_Previous_OrderType_DCTO = ""
0036 VA frm_Previous_OrderCompany_KCOO = ""
0037 // Bulk Refactoring - End

-----------------------------------------------------------------------
     EVENT:  Post Dialog is Initialized
-----------------------------------------------------------------------
0001 F40095 Get Default Branch
        FC Business Unit <- szBranch
        UNDEFINED X szApprovalRouteCode
0002 If FC Business Unit is equal to  <Blank>
0003    FC Business Unit = "           *"
0004 End If
0005 //

-----------------------------------------------------------------------
     EVENT:  Grid Record is Fetched
-----------------------------------------------------------------------
     evt_TextLineYN
0001 If VA frm_LTYI_PreviousLineType is not equal to BC Line Type (F4211)
0002    F40205 Get Line Type Constants
           BC Line Type (F4211) -> szLineType
           UNDEFINED X szLineTypeDesc
           UNDEFINED X szLineTypeDesc2
           UNDEFINED X cGLInterface
           VA frm_IVI_InventoryInterface_YN <- cInventoryInterface
           UNDEFINED X cARInterface
           UNDEFINED X cAPInterface
           UNDEFINED X cReverseSign
           VA frm_TXYN_TEXT_YN <- cTextLine
           UNDEFINED X cIncludeSalesCOGS
           UNDEFINED X cIncludeCashDiscount
           UNDEFINED X cIncludeTax1
           UNDEFINED X cIncludeTax2
           UNDEFINED X szGLOffset
           UNDEFINED X cPrintDocument1
           UNDEFINED X cPrintDocument2
           UNDEFINED X cPrintDocument3
           UNDEFINED X cRecordVariance
           UNDEFINED X cIncludeTotalDocument1
           UNDEFINED X cIncludeTotalDocument2
           UNDEFINED X cIncludeTotalDocument3
           UNDEFINED X cIncludeTotaldocument4
           UNDEFINED X cIncludeColumnSalesJournal
           UNDEFINED X szOrderType
           UNDEFINED X cApplyRetainage
           UNDEFINED X cApplyFreight
           UNDEFINED X cGenerateWorkOrder
           UNDEFINED X cSuppressErrorMessage
           UNDEFINED X cErrorCode
           UNDEFINED X cCallMaterialsIssue
0003    VA frm_LTYI_PreviousLineType = BC Line Type (F4211)
0004 End If
0005 //
0006 //     Suppress a line if it is not a text line and a nonstock line and it has a
0007 //     zero ship quantity.
0008 //
0009 If BC Quantity Shipped (F4211) is equal to <Zero>
     And VA frm_TXYN_TEXT_YN is not equal to "Y"
     And VA frm_IVI_InventoryInterface_YN is not equal to "N"
0010    Suppress Grid Line(FC Grid)
0011    Stop Processing
0012 End If
0013 //
0014 //     If next status of the sales detail line is outside of the range specified
0015 //     in the processing option, bypass this line.
0016 //
0017 If BC Status Code - Next (F4211) is less than PO szStatusNextFrom
     Or BC Status Code - Next (F4211) is greater than PO szStatusNextThru
0018    Suppress Grid Line(FC Grid)
0019    Stop Processing
0020 End If
0021 //
0022 //     If this order is on hold, suppress line from ship confirmation.
0023 //
0024 // Bulk Refactoring - Begin
0025 If BC Document (Order No, Invoice, etc.) (F4211) is not equal to VA frm_Previous_OrderNumber_DOCO Or BC Order Type (F4211) is not equal to VA frm_Previous_OrderType_DCTO Or BC Order Company (Order Number) (F4211) is not equal to VA frm_Previous_OrderCompany_KCOO
0026    F4201 Get Hold Code, Order Totals, and Information
           BC Document (Order No, Invoice, etc.) (F4211) -> mnOrderNumber
           BC Order Type (F4211) -> szOrderType
           BC Order Company (Order Number) (F4211) -> szKeyCompany
           UNDEFINED X szTakenBy
           UNDEFINED X szErrorMesgID
           "1" -> cSuppressErrorMesg
           UNDEFINED X mnOrderTotal
           UNDEFINED X mnForeignOrderTotal
           UNDEFINED X szCompany
           UNDEFINED X szCustomerPO
           VA frm_HOLD5_F4201OrderHold <- szHoldCode
           UNDEFINED X mnSoldToAddrNumber
           UNDEFINED X mnShipToAddrNumber
           UNDEFINED X szPaymentTermsCode
           UNDEFINED X szDisplayWeightUOM
           UNDEFINED X szDisplayVolumeUOM
           UNDEFINED X szBranchPlant
           UNDEFINED X szCurrencyCodeFrom
           UNDEFINED X mnCurrencyConvRate
           UNDEFINED X szTaxArea1
           UNDEFINED X szTaxExplanationCode1
           UNDEFINED X szVendorReference2
           UNDEFINED X cBackOrderedYN
           UNDEFINED X jdRequestedDate
           UNDEFINED X jdTransactionDate
           UNDEFINED X jdPromisedDelDate
           UNDEFINED X mnCarrierNumber
           UNDEFINED X mnBuyerNumber
           UNDEFINED X szRouteCode
           UNDEFINED X szStopCode
           UNDEFINED X szZoneNumber
           UNDEFINED X mnTradeDiscount
           UNDEFINED X mnCommissionCode1
           UNDEFINED X mnCommissionCode2
           UNDEFINED X mnCommissionRate1
           UNDEFINED X mnCommissionRate2
           UNDEFINED X jdOriginalPromiseDate
           UNDEFINED X cSubstitutesAllowedYN
           UNDEFINED X cPriorityProcessing
           UNDEFINED X szPrintMesg
           UNDEFINED X szTaxExemptionCode
           UNDEFINED X szDeliveryInstrns1
           UNDEFINED X szDeliveryInstrns2
           UNDEFINED X szFreightHandlingCode
           UNDEFINED X mnJobNumber
           UNDEFINED X szComputerID
           UNDEFINED X mnProcessID
           UNDEFINED X mnTransactionID
0027    VA frm_Previous_OrderNumber_DOCO = BC Document (Order No, Invoice, etc.) (F4211)
0028    VA frm_Previous_OrderType_DCTO = BC Order Type (F4211)
0029    VA frm_Previous_OrderCompany_KCOO = BC Order Company (Order Number) (F4211)
0030 End If
0031 // Bulk Refactoring - End
0032 If VA frm_HOLD5_F4201OrderHold is greater than  <Blank>
0033    Suppress Grid Line(FC Grid, )
0034    Stop Processing
0035 End If
0036 //
0037 //     If Order line has been shipped via direct ship and the ADDJ is populated,
0038 //     do not display it.
0039 //     SAR 2876954 - SAR 4004674 & 4115702 - Fixes this logic by looking at the
0040 //     SO11 field in the F4211 instead of teh ADDJ.  If the SO11 is a '2', then
0041 //     the record is a direct ship order so don't display it.  RM5906864 3/8/00
0042 //
0043 If BC Transfer/Direct Ship/Intercompany Flag (F4211) is equal to "2"
     And BC Date - Actual Ship Date (F4211) is not equal to <Null Date>
0044    Suppress Grid Line(FC Grid)
0045    Stop Processing
0046 End If
0047 //
0048 // If this order is a future order, do not display it.
0049 //
0050 If BC Units - Future Quantity Committed (F4211) is greater than <Zero>
0051    Suppress Grid Line(FC Grid)
0052    Stop Processing
0053 End If
0054 //
0055 // If this line is being processed by warehousing , do not display it.
0056 //
0057 If BC Status - In Warehouse (F4211) is equal to "I"
0058    Suppress Grid Line(FC Grid)
0059    Stop Processing
0060 End If
0061 //
0062 // If this a work order that is not completed, then do not display it.
0063 //
0064 If BC Manufacturing Variance Accounting Flag (F4211) is equal to "1"
0065    Suppress Grid Line(FC Grid)
0066    Stop Processing
0067 End If
0068 //
0069 // SAR's 1968259 & 3069003 - changes to grid load for Kit and Configured Item
0070 // processing based upon processing option values and line types
0071 //
0072 If BC Kit Master Line Number (F4211) is greater than <Zero>
0073    If BC Related Kit Component (F4211) is greater than <Zero>
0074 !       F40205 Get Line Type Constants
     !          BC Line Type (F4211) -> szLineType
     !          UNDEFINED X szLineTypeDesc
     !          UNDEFINED X szLineTypeDesc2
     !          UNDEFINED X cGLInterface
     !          UNDEFINED X cInventoryInterface
     !          UNDEFINED X cARInterface
     !          UNDEFINED X cAPInterface
     !          UNDEFINED X cReverseSign
     !          VA evt_TextLineYN <- cTextLine
     !          UNDEFINED X cIncludeSalesCOGS
     !          UNDEFINED X cIncludeCashDiscount
     !          UNDEFINED X cIncludeTax1
     !          UNDEFINED X cIncludeTax2
     !          UNDEFINED X szGLOffset
     !          UNDEFINED X cPrintDocument1
     !          UNDEFINED X cPrintDocument2
     !          UNDEFINED X cPrintDocument3
     !          UNDEFINED X cRecordVariance
     !          UNDEFINED X cIncludeTotalDocument1
     !          UNDEFINED X cIncludeTotalDocument2
     !          UNDEFINED X cIncludeTotalDocument3
     !          UNDEFINED X cIncludeTotaldocument4
     !          UNDEFINED X cIncludeColumnSalesJournal
     !          UNDEFINED X szOrderType
     !          UNDEFINED X cApplyRetainage
     !          UNDEFINED X cApplyFreight
     !          UNDEFINED X cGenerateWorkOrder
     !          UNDEFINED X cSuppressErrorMessage
     !          UNDEFINED X cErrorCode
0075       If VA frm_TXYN_TEXT_YN is equal to "1,Y"
0076          Suppress Grid Line(FC Grid)
0077          Stop Processing
0078       End If
0079    Else
0080       If PO szDisplayKitLines is not equal to "1"
0081          Suppress Grid Line(FC Grid)
0082          Stop Processing
0083       End If
0084    End If
0085 End If
0086 //
0087 //     Display generic text indicator
0088 //
0089 BC Associated Text (F4211) = " "
0090 Media Object Structures(GT4211A, <Exist>, BC Associated Text (F4211), BC Document (Order No, Invoice, etc.) (F4, BC Order Type (F4211), BC Order Company (Order Number) (F4211), BC Line Number (F4211))
0091 If BC Associated Text (F4211) is equal to "1"
0092    Set Grid Text Indicator(FC Grid, <Current Row>, <Yes>)
0093 End If

-----------------------------------------------------------------------
     EVENT:  Write Grid Line-Before
-----------------------------------------------------------------------
0001 //
0002 //     Get Alpha Descriptions from F0101
0003 //
0004 If VA frm_AN8_Prev_SoldToNumber is not equal to GC Sold ToNumber
0005    F0101 Get Address Information for OP
           GC Sold To Number -> mnAddressNumber
           VA frm_DSC1_Prev_SoldToName <- szAlphaName
           UNDEFINED X jdAddressEffectiveDate
           UNDEFINED X szTaxCertificate
           UNDEFINED X szCreditMessage
           UNDEFINED X mnRelatedAddress1
           UNDEFINED X mnRelatedAddress2
           UNDEFINED X mnRelatedAddress3
           UNDEFINED X mnRelatedAddress4
           UNDEFINED X mnRelatedAddress5
           UNDEFINED X mnRelatedAddress6
           UNDEFINED X szBranchPlant
           UNDEFINED X szLanguagePreference
           UNDEFINED X szErrorMessage
           "1" -> cSuppressError
           UNDEFINED X szTaxID
           UNDEFINED X cPersonCorporationCode
0006    VA frm_AN8_Prev_SoldToNumber = GC Sold ToNumber
0007 End If
0008 GC Sold ToName = VA frm_DSC1_Prev_SoldToName

-----------------------------------------------------------------------
     EVENT:  Variable
-----------------------------------------------------------------------
     frm_TXYN_TEXT_YN
     frm_IVI_InventoryInterface_YN
     frm_LTYI_PreviousLineType
     frm_MCU2_CostCenter
     frm_HOLD5_F4201OrderHold
     frm_MCU_CostCenter
     frm_AN8_Prev_SoldToNumber
     frm_DSC1_Prev_SoldToName
     frm_Previous_OrderNumber_DOCO
     frm_Previous_OrderType_DCTO
     frm_Previous_OrderCompany_KCOO

=======================================================================
     CONTROL:  HYPITEM &Select
     EVENT:  Button Clicked
-----------------------------------------------------------------------
0001 If FC Business Unit is not equal to <Blank>
     And FC Business Unit is not equal to <Null>
0002    VA frm_MCU2_CostCenter = FC Business Unit
0003 Else
0004    VA frm_MCU2_CostCenter = ""
0005 End If
0006 Call( App:P4205 , Form: W4205K )
        GC Order Number -> mnDocumentOrderInvoiceE
        GC Or Ty -> szOrderType
        GC Order Co -> szCompanyKeyOrderNo
        GC Line Number -> mnLineNumber
        UNDEFINED X cOn_Hand_Updated_F4211
        UNDEFINED X mnUnits__Future_Quantity_Commi
        UNDEFINED X szStatus_Code__Next_F4211
        VA frm_MCU2_CostCenter -> szBusiness_Unit_F4211
        UNDEFINED X szReference_F4211
        UNDEFINED X mnPick_Slip_Number_F4211
        UNDEFINED X jdTRAN_ActualDeliveryDate
        UNDEFINED X mnTRAN_ActualShipmentTime
        UNDEFINED X jdTRAN_DELIVERY_DATE
        UNDEFINED X cTRAN_SyncrhonousEndDoc
        UNDEFINED X cTRAN_InventoryAffectFlag
        UNDEFINED X szTRAN_OverrideDocType
        UNDEFINED X szTRAN_OverrideNextStatusCode
        UNDEFINED X mnTRAN_TransportationJobNumber
        UNDEFINED X cTRAN_OverrideLeaveShippable
        UNDEFINED X szTRAN_PrimaryVehicleId
        UNDEFINED X szTRAN_RegistrationLicNumber
        UNDEFINED X mnTRAN_OverrideDocNumber
        UNDEFINED X jdTRAN_LoadConfirmDate_2
        UNDEFINED X mnTRAN_TimeLoad_2
        UNDEFINED X szTRAN_OverrideCompanyKey
        UNDEFINED X cCancelButtonClicked_EV01
        UNDEFINED X mnShipmentNumber
        UNDEFINED X idXAPIWorkflowErrorID
        UNDEFINED X szCartonNextStatus
        UNDEFINED X cCalledByTransportation
        UNDEFINED X cReconcileCartonShipmentDetail
        UNDEFINED X mnTran_LoadNumber

=======================================================================
     CONTROL:  HYPITEM F&ind
     EVENT:  Button Clicked
-----------------------------------------------------------------------
0001 Enable Control(HC Confirm &Line)
0002 Enable Control(HC Confirm Shown &Rows)
0003 //
0004 // SAR 6224259 - If an order is released from hold after a user has already
0005 //     did a find in the ship confirm work with screen, the user should not
0006 //     have to exit out of ship confirm in order to find the order once it is
0007 //     released.  This reinitialization of the previous values allows the hold
0008 //      to be checked again.
0009 VA frm_Previous_OrderNumber_DOCO = ""
0010 VA frm_Previous_OrderType_DCTO = ""
0011 VA frm_Previous_OrderCompany_KCOO = ""

=======================================================================
     CONTROL:  HYPITEM Confirm Shown &Rows
     EVENT:  Button Clicked
-----------------------------------------------------------------------
0001 If FC Business Unit is not equal to <Blank>
     And FC Business Unit is not equal to <Null>
0002    VA frm_MCU2_CostCenter = FC Business Unit
0003 Else
0004    VA frm_MCU2_CostCenter = ""
0005 End If
0006 // SAR 7395076  - Show all selected Line numbers.
0007 ! Call( App:P4205 , Form: W4205K )
     !    FC Order Number -> mnDocumentOrderInvoiceE
     !    FC Order Type -> szOrderType
     !    FC Order Company -> szCompanyKeyOrderNo
     !    UNDEFINED X mnLineNumber
     !    UNDEFINED X cOn_Hand_Updated_F4211
     !    UNDEFINED X mnUnits__Future_Quantity_Commi
     !    UNDEFINED X szStatus_Code__Next_F4211
     !    VA frm_MCU2_CostCenter -> szBusiness_Unit_F4211
     !    FC Reference -> szReference_F4211
     !    FC Pick Slip Number -> mnPick_Slip_Number_F4211
     !    UNDEFINED X jdTRAN_ActualDeliveryDate
     !    UNDEFINED X mnTRAN_ActualShipmentTime
     !    UNDEFINED X jdTRAN_DELIVERY_DATE
     !    UNDEFINED X cTRAN_SyncrhonousEndDoc
     !    UNDEFINED X cTRAN_InventoryAffectFlag
     !    UNDEFINED X szTRAN_OverrideDocType
     !    UNDEFINED X szTRAN_OverrideNextStatusCode
     !    UNDEFINED X mnTRAN_TransportationJobNumber
     !    UNDEFINED X cTRAN_OverrideLeaveShippable
     !    UNDEFINED X szTRAN_PrimaryVehicleId
     !    UNDEFINED X szTRAN_RegistrationLicNumber
     !    UNDEFINED X mnTRAN_OverrideDocNumber
     !    UNDEFINED X jdTRAN_LoadConfirmDate_2
     !    UNDEFINED X mnTRAN_TimeLoad_2
     !    UNDEFINED X szTRAN_OverrideCompanyKey
     !    UNDEFINED X cCancelButtonClicked_EV01
     !    FC Shipment Number -> mnShipmentNumber
     !    UNDEFINED X idXAPIWorkflowErrorID
     !    UNDEFINED X szCartonNextStatus
     !    UNDEFINED X cCalledByTransportation
     !    UNDEFINED X cReconcileCartonShipmentDetail
     !    UNDEFINED X mnTran_LoadNumber
0008 Call( App:P4205 , Form: W4205K )
        FC Order Number -> mnDocumentOrderInvoiceE
        FC Order Type -> szOrderType
        FC Order Company -> szCompanyKeyOrderNo
        <Blank> -> mnLineNumber
        VA frm_MCU2_CostCenter -> szBusiness_Unit_F4211
        FC Reference -> szReference_F4211
        FC Pick Slip Number -> mnPick_Slip_Number_F4211
        FC Shipment Number -> mnShipmentNumber
0009 // end SAR 7395076.

=======================================================================
     CONTROL:  HYPITEM A&ttachments
     EVENT:  Button Clicked
-----------------------------------------------------------------------
     OPT: Repeat ER for Event
0001 Media Object Structures(GT4211A, <Edit>, BC Associated Text (F4211), GC OrderNumber, GC OrTy, GC OrderCo, GC LineNumber)
0002 If BC Associated Text is equal to "1"
0003    Set Grid Text Indicator(FC Grid, <Current Row>, <Yes>)
0004 Else
0005    Set Grid Text Indicator(FC Grid,  <Current Row>,  <No>)
0006 End If

=======================================================================
     CONTROL:  HYPITEM Confirm &Line
     EVENT:  Button Clicked
-----------------------------------------------------------------------
     OPT: Repeat ER for Event
0001 If FC Business Unit is not equal to <Blank>
     And FC Business Unit is not equal to <Null>
0002    VA frm_MCU2_CostCenter = FC Business Unit
0003 Else
0004    VA frm_MCU2_CostCenter = ""
0005 End If
0006 Call( App:P4205 , Form: W4205K )
        GC Order Number -> mnDocumentOrderInvoiceE
        GC Or Ty -> szOrderType
        GC Order Co -> szCompanyKeyOrderNo
        GC Line Number -> mnLineNumber
        UNDEFINED X cOn_Hand_Updated_F4211
        UNDEFINED X mnUnits__Future_Quantity_Commi
        UNDEFINED X szStatus_Code__Next_F4211
        VA frm_MCU2_CostCenter -> szBusiness_Unit_F4211
        UNDEFINED X szReference_F4211
        UNDEFINED X mnPick_Slip_Number_F4211
        UNDEFINED X jdTRAN_ActualDeliveryDate
        UNDEFINED X mnTRAN_ActualShipmentTime
        UNDEFINED X jdTRAN_DELIVERY_DATE
        UNDEFINED X cTRAN_SyncrhonousEndDoc
        UNDEFINED X cTRAN_InventoryAffectFlag
        UNDEFINED X szTRAN_OverrideDocType
        UNDEFINED X szTRAN_OverrideNextStatusCode
        UNDEFINED X mnTRAN_TransportationJobNumber
        UNDEFINED X cTRAN_OverrideLeaveShippable
        UNDEFINED X szTRAN_PrimaryVehicleId
        UNDEFINED X szTRAN_RegistrationLicNumber
        UNDEFINED X mnTRAN_OverrideDocNumber
        UNDEFINED X jdTRAN_LoadConfirmDate_2
        UNDEFINED X mnTRAN_TimeLoad_2
        UNDEFINED X szTRAN_OverrideCompanyKey
        UNDEFINED X cCancelButtonClicked_EV01
        UNDEFINED X mnShipmentNumber
        UNDEFINED X idXAPIWorkflowErrorID
        UNDEFINED X szCartonNextStatus
        UNDEFINED X cCalledByTransportation
        UNDEFINED X cReconcileCartonShipmentDetail
        UNDEFINED X mnTran_LoadNumber

=======================================================================
     CONTROL:  HYPITEM &Revision History
     EVENT:  Button Clicked
-----------------------------------------------------------------------
0001 Call( App:P42420 , Form: W42420B )
        GC Order Co -> szCompanyKeyOrderNo
        GC Order Number -> mnDocumentOrderInvoiceE
        GC Or Ty -> szOrderType
        GC Line Number -> mnLineNumber
        GC Rev Nbr [HIDDEN] -> mnNumberChangeOrder

=======================================================================
     CONTROL:  HYPITEM Customer &Service
     EVENT:  Button Clicked
-----------------------------------------------------------------------
0001 Call( App:P4210 , Form: W4210E )
        GC Order Number -> Documentorderinvoicee
        GB Or Ty -> Ordertype
        GC Order Co -> Companykeyorderno
        UNDEFINED X Reference1
        UNDEFINED X Itemnounknownformat
        BC Business Unit (F4211) <> Costcenter
        UNDEFINED X mnAddressNumber

=======================================================================
     CONTROL:  GRID Grid
     EVENT:  Double Click on Row Header
-----------------------------------------------------------------------
0001 Press Button(HC A&ttachments)

=======================================================================
     FORM: Shipment Confirmation [HEADERLESS DETAIL] (W4205K)
=======================================================================
     CONTROL:  FORM
     EVENT:  Dialog is Initialized
-----------------------------------------------------------------------
     evt_HideAgreements
     evt_DualUOMActive
0001 // ******************************************************************
0002 // Modifications:
0003 // 02/14/2005  MD5644340  7459720 - Ship Confirm Edit Line Performance
0004 // ******************************************************************
0005 //
0006 //  Get Version Name for MBF
0007 VA frm_VersionName = SL VersionName
0008 //
0009 // Set PO Options Retrieved Flag Off.
0010 VA frm_PO_Options_Retrieved = "0"
0011 //
0012 //     If specified in PO, disable the Line Type field so that it can't be
0013 //     changed.
0014 //
0015 If PO szOverrideLT is not equal to "1"
0016    Disable Grid(FC Grid, <All Rows>, GC LnTy)
0017 End If
0018 //
0019 //     If specified in PO, disable the ship to field so that it can't be changed
0020 //
0021 If PO szOverrideSHAN is not equal to "1"
0022    Disable Grid(FC Grid, <All Rows>, GC Ship ToNumber)
0023 End If
0024 //
0025 Disable Grid(FC Grid, <All Rows>, GC LineNumber)
0026 //
0027 //   BULK
0028 //     Determine if Bulk Module is installed.
0029 Get Environment Value
        "SY41B" -> szDataItem
        VA frm_UseBulkManagement <- cModuleExistance
0030 //
0031 // Disable Lot/Serial Entry if SRCE = 4
0032 //
0033 //
0034 // SAR# 2112997 Agreements - Borrow
0035 VA evt_HideAgreements = " "
0036 If PO cAgreementSearchFlag is equal to <Blank>
     Or PO cAgreementSearchFlag is equal to <Null>
     Or PO cAgreementSearchFlag is equal to "3"
0037    VA evt_HideAgreements = "1"
0038 End If
0039 If PO szAgreementDestination is equal to <Blank>
     Or PO szAgreementDestination is equal to <Null>
0040    If PO cAgreementBPFlag is equal to <Blank>
        Or PO cAgreementBPFlag is equal to <Null>
0041       VA evt_HideAgreements = "1"
0042    End If
0043 End If
0044 If VA evt_HideAgreements is equal to "1"
0045    Disable Control(HC Agreements)
0046 Else
0047    Enable Control(HC Agreements)
0048 End If
0049 //
0050 // SAR 5028512 - Dual Unit of Measure processing
0051 // Determine whether Dual UOM is active, and hide or display fields accordingly
0052 //
0053 Vertical Feature
        "01" -> szVerticalEnhancement
        VA evt_DualUOMActive <- cEnhancementExistance
0054 //
0055 If VA evt_DualUOMActive is equal to "1"
0056    Show Grid Column(FC Grid, GC SecondaryQty Shipped)
0057    Show Grid Column(FC Grid, GC SecondaryUoM)
0058 Else
0059    Hide Grid Column(FC Grid, GC SecondaryQty Shipped)
0060    Hide Grid Column(FC Grid, GC SecondaryUoM)
0061 End If
0062 // end SAR 5028512
0063 //
0064 // Bulk Refactoring - Begin
0065 // Initialize Previous Order Keys
0066 VA frm_Previous_OrderNumber_DOCO = ""
0067 VA frm_Previous_OrderType_DCTO = ""
0068 VA frm_Previous_OrderCompany_KCOO = ""
0069 // Bulk Refactoring - End
0070 //
0071 // =============================================================
0072 // Demand Scheduling
0073 // Check if Demand Scheduling has been delivered
0074 // =============================================================
0075 Is Demand Scheduling Delivered For Use
        VA frm_cDemandSchedReleased_DSRFU <- cDemandSchedulingReleased
0076 // =============================================================
0077 // Demand Scheduling - Confirmation Carton Status
0078 // If Demand Scheduling has been delivered
0079 // If Carton Status is being verified display Shipment Number on grid
0080 // =============================================================
0081 If VA frm_cDemandSchedReleased_DSRFU is equal to "1"
0082    If PO szMinimumCartonStatusCode is not equal to <Null> And PO szMinimumCartonStatusCode is not equal to <Blank>
0083       Show Grid Column(FC Grid, GC ShipmentNumber)
0084    Else
0085       Hide Grid Column(FC Grid, GC ShipmentNumber)
0086    End If
0087 End If
0088 //
0089 // =============================================================
0090 // Demand Scheduling - Times - Shipment Confirmation
0091 // If demand scheduling has not been delivered hide actual ship time
0092 // =============================================================
0093 If VA frm_cDemandSchedReleased_DSRFU is not equal to "1"
0094    Hide Grid Column(FC Grid, GC ActualShip Time)
0095    Disable Control(HC Carton Reorg)
0096    // =============================================================
0097    // Carton Reconciliation Line Level - 6271856
0098    // =============================================================
0099    VA frm_cEditDocSuccessfulYN_EV01 = "Y"
0100    If FI cCalledByTransportation is not equal to "1,2"
0101       FI cCalledByTransportation = "0"
0102    End If
0103 End If
0104 //
0105 // Get Unique Transaction Identifier for Record Reservation.  This new ID will
0106 // be used rather than program ID (P4205) to prevent the same user from
0107 // confirming the same record multiple times.  First need to get the next
0108 // uniqued ID which is a math numeric.  Then need to convert the math numeric
0109 // value toa string.
0110 Get Next Unique Key ID
        "RRESERVE" -> szObjectName
        VA frm_mnUniqueIDRecReserve_UKID <- mnUniqueKeyID
0111 Math Numeric to String, Convert
        VA frm_mnUniqueIDRecReserve_UKID -> mnMathNumeric01
        VA frm_szUniqueIDRecReserve_PID <- szVideoConstant30A
0112 //
0113 // SAR 7459720    2/14/2004    MD5644340
0114 // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
0115 // Retrieve next number for cache processing
0116 // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
0117 Get Internal Next NUmber
        VA frm_Job_Number <> mnJobnumberA
0118 //
0119 // SAR 7649494 E811 Translation QA
0120 // The translation tool cannot translate grid columns that are not visible
0121 // upon form entry, the properties of the Bulk columns were changed to
0122 // "Visible" and then the columns are hidden in Dialog is Initialized.
0123 Hide Grid Column(FC Grid, GC AmbientVolume)
0124 Hide Grid Column(FC Grid, GC Ambient Volume UOM)
0125 Hide Grid Column(FC Grid, GC StandardVolume)
0126 Hide Grid Column(FC Grid, GC StandardVolume UOM)
0127 Hide Grid Column(FC Grid, GC WeightQuantity)
0128 Hide Grid Column(FC Grid, GC Weight Qty UOM)
0129 Hide Grid Column(FC Grid, GC Temperature)
0130 Hide Grid Column(FC Grid, GC TempType)
0131 Hide Grid Column(FC Grid, GC DisplayDensity)
0132 Hide Grid Column(FC Grid, GC DensityType)
0133 Hide Grid Column(FC Grid, GC DensityTemp)
0134 Hide Grid Column(FC Grid, GC Density Temp Type)
0135 Hide Grid Column(FC Grid, GC Vol CorFactor)
0136 Hide Grid Column(FC Grid, GC TransactionTime - Bulk)
0137 // End of SAR 7649494

-----------------------------------------------------------------------
     EVENT:  Post Dialog is Initialized
-----------------------------------------------------------------------
0001 // ******************************************************************
0002 // Modifications:
0003 // 02/14/2005  MD5644340  7459720 - Ship Confirm Edit Line Performance
0004 // ******************************************************************
0005 //
0006 // Initialize Hidden Filter Fields
0007 FC On Hand Updated = "1"
0008 FC Future Quantity Committed = 0
0009 FC Status Code - Next = "999"
0010 //
0011 //     If specified to display only lines that match a certain branch/plant,
0012 //     display this branch/plant.
0013 //
0014 //   Initialize Branch/Plant Filter
0015 If FI szBusiness_Unit_F4211 is not equal to  <Blank>
     And FI szBusiness_Unit_F4211 is not equal to  <Null>
0016    FC MCU_BranchFilter = FI szBusiness_Unit_F4211
0017 Else
0018    FC MCU_BranchFilter = "*"
0019 End If
0020 //
0021 // Initialize Customer PO Number Filter
0022 If FI szReference_F4211 is not equal to <Blank>
     And FI szReference_F4211 is not equal to <Null>
0023    FC CustomerPONumber = FI szReference_F4211
0024 Else
0025    FC CustomerPONumber = "*"
0026 End If
0027 //
0028 // Initialize Line Number Filter
0029 If FI mnLineNumber is not equal to <Zero>
     And FI mnLineNumber is not equal to <Null>
0030    FC LNID-Line Number Hidden Filter = FI mnLineNumber
0031 Else
0032    FC LNID-Line Number Hidden Filter = ""
0033 End If
0034 //
0035 // Initialize Commodity Code (ShipNumber) Filter
0036 If FI mnShipmentNumber is not equal to <Zero>
0037    FC Shipment Number = FI mnShipmentNumber
0038 Else
0039    FC Shipment Number = "*"
0040 End If
0041 //
0042 // Initialize Pick Slip Number Filter
0043 If FI mnPick_Slip_Number_F4211 is not equal to <Blank>
     And FI mnPick_Slip_Number_F4211 is not equal to  <Null>
0044    FC Pick Slip Number = FI mnPick_Slip_Number_F4211
0045 Else
0046    FC Pick Slip Number = "*"
0047 End If
0048 //
0049 //     Initialize Order type filter.
0050 //
0051 If FI szOrderType is not equal to  <Blank>
     And FI szOrderType is not equal to  <Null>
0052    FC Order Type = FI szOrderType
0053 Else
0054    FC Order Type = "*"
0055 End If
0056 //
0057 //     Initialize Order Company filter.
0058 //
0059 If FI szCompanyKeyOrderNo is not equal to  <Blank>
     And FI szCompanyKeyOrderNo is not equal to  <Null>
0060    FC Order Company = FI szCompanyKeyOrderNo
0061 Else
0062    FC Order Company = "*"
0063 End If
0064 //
0065 //     Get time stamp.
0066 //
0067 Get Audit Information
        VA frm_UserID <- szUserName
        VA frm_AuditInfoDate <- jdDate
        VA frm_DefaultLoadTime <- mnTime
        UNDEFINED X szWorkstation_UserId
        VA frm_ComputerID <- szMachineKey
0068 //
0069 // Assign System Date to Default Ship Date
0070 // SAR #2117915 -
0071 //   Disable Carrier and ShipDate entry if called by Transportation.
0072 If FI mnTRAN_TransportationJobNumber is greater than <Zero>
0073    VA frm_Default_ShipDate = FI jdTRAN_ActualDeliveryDate
0074    VA frm_DefaultLoadTime = FI mnTRAN_TimeLoad_2
0075    Disable Grid(FC Grid,  <All Rows>, GC Actual ShipDate)
0076    // Carrier# will already be in F4211 records when called by Transportation.
0077    Disable Grid(FC Grid,  <All Rows>, GC CarrierNumber)
0078    //
0079    // =============================================================
0080    // Demand Scheduling - Actual Ship Time
0081    // If called from transportation, load actual ship time and disable grid
0082    // column
0083    // =============================================================
0084    If VA frm_cDemandSchedReleased_DSRFU is equal to "1"
0085       VA frm_mnDefaultShipTime_TME0 = FI mnTRAN_ActualShipmentTime
0086       Disable Grid(FC Grid,  <All Rows>, GC ActualShip Time)
0087    End If
0088 Else
0089    VA frm_Default_ShipDate = VA frm_AuditInfoDate
0090 End If
0091 //
0092 // Disable Line Type Entry if specified in Process Options.
0093 If PO szOverrideLT is not equal to "1"
0094    Disable Grid(FC Grid,  <All Rows>, GC LnTy)
0095 End If
0096 //
0097 //  Disable Ship To Number if specified in Process Options.
0098 If PO szOverrideSHAN is not equal to "1"
0099    Disable Grid(FC Grid,  <All Rows>, GC Ship ToNumber)
0100 End If
0101 //
0102 //     Initialize roww number counter to 0.  This counter is used to keep track
0103 //     of the rows inserted for multiple location processing.
0104 //
0105 VA frm_LNIX_RowNumberCounter = "0"
0106 //
0107 VA frm_PO_PreventNegOnHand = [PO szPreventNegativeShip]
0108 VA frm_PO_PreventOverShip = [PO szPreventOvership]
0109 VA frm_PO_CheckAvailability = [PO szCheckAvailability]
0110 VA frm_PO_AutoBackCancel = [PO szBOorCANRemains]
0111 //
0112 // Quality Management
0113 VA frm_GetEnvironmentExistance = " "
0114  VA frm_GetEnvironmentExistance is equal to <Blank>
0115    Get Environment Value
           "SY37" -> szDataItem
           VA frm_ModularExistanceSYS37 <- cModuleExistance
0116    VA frm_GetEnvironmentExistance = "1"
0117    If VA frm_ModularExistanceSYS37 is equal to <Blank>
        Or VA frm_ModularExistanceSYS37 is equal to <Null>
        Or VA frm_ModularExistanceSYS37 is equal to <Zero>
0118       Disable Control(HC Test Results)
0119    Else
0120       Enable Control(HC Test Results)
0121    End If
0122 End If
0123 //
0124 // SAR 7459720    2/14/2005    MD5644340
0125 // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
0126 // Used User Selection instead of retrieving all the grid records
0127 // and then suppressing the ones that shouldn't be processed
0128 // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
0129 Set Selection Append Flag(FC Grid,  <Yes>)
0130 Set Selection(FC Grid, "F4211", "NXTR",  <Greater Than or Equal To>, PO szStatusNextFrom,  <And>)
0131 Set Selection Append Flag(FC Grid,  <Yes>)
0132 Set Selection(FC Grid, F4211, NXTR,  <Less Than or Equal To>, PO szStatusNextThru, <And>)
0133 Set Selection Append Flag(FC Grid,  <Yes>)
0134 Set Selection(FC Grid, F4211, "SONE",  <Equal To>,  <Zero>, <And>)
0135 Set Selection Append Flag(FC Grid,  <Yes>)
0136 Set Selection(FC Grid, F4211, "SWMS",  <Not Equal To>, "I", <And>)
0137 Set Selection Append Flag(FC Grid,  <Yes>)
0138 Set Selection(FC Grid, F4211, "SO16", <Not Equal To>, "1", <And>)
0139 Set Selection Append Flag(FC Grid,  <Yes>)
0140 Set Selection(FC Grid, "F4201", "HOLD",  <Equal To>,  <Blank>, <And>)
0141 //
0142 // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
0143 // The Validate Application ID for record reservation only needs to be
0144 // processed once per form.  The function will return a '0' to validate and a
0145 // '1' to bypass validation.  The logic is moved here to improve performance
0146 // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
0147 Validate Application Id
        "P4205" -> szApplicationID_PID
        VA frm_cValidateApplication_ERR1 <- cValidateApplication_ERR1
0148 //
0149 If VA frm_cValidateApplication_ERR1 is not equal to <Zero>
0150    VA frm_cValidateApplication_ERR1 = "2"
0151 End If
0152 //

-----------------------------------------------------------------------
     EVENT:  Grid Record is Fetched
-----------------------------------------------------------------------
     evt_CurrencyCodeBaseCompany
     evt_CurrToConvertFlagAgreement
     evt_cGenerateWorkorder_GWO
0001 // ******************************************************************
0002 // Modifications:
0003 // 02/14/2005  MD5644340  7459720 - Ship Confirm Edit Line Performance
0004 // ******************************************************************
0005 //
0006 // SAR 4142936 - If Drop Ship line and Actual Ship Date is not null, suppress
0007 If BC Transfer/Direct Ship/Intercompany Flag (F4211) is equal to "2"
     And BC Date - Actual Ship Date (F4211) is not equal to <Null Date>
0008    Suppress Grid Line(FC Grid)
0009    Stop Processing
0010 End If
0011 //
0012 // SAR 7459720    MD5644340    02/14/2005
0013 // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
0014 // Add a Ship Confirm Line Type Cache to store line type
0015 // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
0016 If VA frm_LTYI_LastLineTypeRead is not equal to BC Line Type (F4211)
0017    Ship Confirm Cache For Line Type
           "1" -> szCacheActionCode
           "3" -> mnNumberKeys
           VA frm_Job_Number -> mnJobnumberA
           VA frm_ComputerID -> szComputerID
           BC Line Type (F4211) -> szLineType
           VA frm_IVI_Inv_Interface <- cInvInterfaceFlag
           VA frm_TXYN_Text_YN <- cTextLineYN
           "1" -> cSuppressErrorMessage
           VA frm_ERRC_GenericErrorCode <- cErrorCode
           VA frm_szErrorMessageID_DTAI <- szErrorMessage
0018    //
0019    If VA frm_szErrorMessageID_DTAI is not equal to <Blank> And VA frm_szErrorMessageID_DTAI is not equal to <Null>
0020       F40205 Get Line Type Constants
              BC Line Type (F4211) -> szLineType
              VA frm_IVI_Inv_Interface <- cInventoryInterface
              VA frm_TXYN_Text_YN <- cTextLine
              VA evt_cGenerateWorkorder_GWO <- cGenerateWorkOrder
0021       Ship Confirm Cache For Line Type
              "7" -> szCacheActionCode
              "3" -> mnNumberKeys
              VA frm_Job_Number -> mnJobnumberA
              VA frm_ComputerID -> szComputerID
              BC Line Type (F4211) -> szLineType
              VA frm_IVI_Inv_Interface -> cInvInterfaceFlag
              VA frm_TXYN_Text_YN -> cTextLineYN
              VA evt_cGenerateWorkorder_GWO -> cGenerateWorkOrder
              "1" -> cSuppressErrorMessage
              VA frm_ERRC_GenericErrorCode <- cErrorCode
              VA frm_szErrorMessageID_DTAI <- szErrorMessage
0022       VA frm_LTYI_LastLineTypeRead = BC Line Type (F4211)
0023    End If
0024 End If
0025 //
0026 // SAR's 1968259 & 3069003 - changes to grid load for Kit and Configured Item
0027 // processing based upon processing option values and line types
0028 //
0029 If BC Kit Master Line Number (F4211) is greater than <Zero>
0030    If BC Related Kit Component (F4211) is greater than <Zero>
0031       If VA frm_TXYN_Text_YN is equal to "1,Y"
0032          Suppress Grid Line(FC Grid)
0033          Stop Processing
0034       End If
0035    Else
0036       If PO szDisplayKitLines is not equal to "1"
0037          Suppress Grid Line(FC Grid)
0038          Stop Processing
0039       End If
0040    End If
0041 End If
0042 //
0043 //     Suppress a line if it is not a text line or non-stock line and it has a
0044 //     zero ship quantity.
0045 //
0046 If BC Quantity Shipped (F4211) is equal to <Zero> And VA frm_TXYN_Text_YN is not equal to "Y" And VA frm_IVI_Inv_Interface is not equal to "N"
0047    Suppress Grid Line(FC Grid)
0048    Stop Processing
0049 End If
0050 //
0051 //     Load Line Number from F4211 for display.
0052 //
0053 GC LineNumber = BC Line Number (F4211)
0054 //
0055 //    If specified in PO to pre-select all lines, assign '1' to all grid lines.
0056 //
0057 If PO szPreloadOption is equal to "1"
0058    GC Sel = 1 = "1"
0059 End If
0060 //
0061 // assign value to static Quantity Shipped
0062 //
0063 GC Orig Quantity Shipped - Static = BC Quantity Shipped (F4211)
0064 GC QuantityBackordered - Orig = BC Units - Qty Backordered/Held (F4211)
0065 GC QuantityCanceled - Orig = BC Units - Quantity Canceled/Scrapped (F4211)
0066 GC OriginalSecondary Quantity = BC Units - Secondary Quantity Ordered (F4211)
0067 //
0068 // Agreements
0069 If PO szAgreementDestination is equal to <Blank>
     Or PO szAgreementDestination is equal to <Null>
0070    If PO cAgreementBPFlag is equal to "2"
0071       //
0072       // SAR #2893421- Replaced assingnment statement which assigned the Header Branch
0073       // Plant to the Agreement Destination with call to F40095 Get Default Branch
0074       // (B4000370).  This is becuase PO_AgreementBPFlag being a "2" means the user
0075       // default Branch Plant should be used to search for agreements.
0076       F40095 Get Default Branch
              VA frm_PO_AgreementDestinationSAV <- szBranch
              UNDEFINED X szApprovalRouteCode
0077       VA frm_DestinationType1 = "CC"
0078    Else
0079       VA frm_PO_AgreementDestinationSAV = "*ANY"
0080       VA frm_DestinationType1 = "*A"
0081    End If
0082    //
0083 Else
0084    //
0085    VA frm_DestinationType1 = "CC"
0086    VA frm_PO_AgreementDestinationSAV = PO szAgreementDestination
0087 End If
0088 //
0089 VA frm_SystemCodeBPSearch = " "
0090 //
0091 // SAR 7459720    MD5644340    02/14/2005
0092 // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
0093 // Utilized a new business view with only table columns
0094 // that are needed to improve table I/O operation
0095 // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
0096 If GB AgreementNumber is equal to or empty <Blank>
0097    V41001E.Fetch Single
           VA frm_SystemCodeBPSearch =  TK Product Code
           BC Business Unit (F4211) =  TK Business Unit
           VA frm_AN8AgreementDestination <- TK Address Number
           VA frm_ForeignDepot <- TK Foreign Depot
0098 End If
0099 //
0100 If VA frm_ForeignDepot is equal to "Y"
     Or VA frm_ForeignDepot is equal to "1"
0101    If PO cAgreementSearchFlag is equal to <Blank>
        Or PO cAgreementSearchFlag is equal to <Null>
0102       PO cAgreementSearchFlag = "3"
0103    End If
0104    //
0105    // Get Job Number
0106    If VA frm_Job_Number is equal to <Blank>
0107       X0010 - Get Next Number
              "00" -> szSystemCode
              "4" -> mnNextNumberingIndexNo
              "00000" -> szCompanyKey
              UNDEFINED X szDocumentType
              UNDEFINED X mnCentury
              UNDEFINED X mnFiscalYear1
              UNDEFINED X szSameAsDocumentType
              VA frm_Job_Number <- mnNextNumber001
0108    End If
0109    //
0110    If GB AgreementNumber is equal to <Blank>
        Or GB AgreementNumber is equal to <Null>
0111       VA evt_CurrToConvertFlagAgreement = " "
0112       F0010 Get Company Currency Code
              BC Order Company (Order Number) (F4211) -> szCompany
              VA evt_CurrencyCodeBaseCompany <- szCurrencyCode
              UNDEFINED X cDetailedCurrencyRestatement
              UNDEFINED X cPostByCurrency
0113       //
0114       If BC Currency Code - From (F4211) is not equal to VA evt_CurrencyCodeBaseCompany
0115          VA evt_CurrToConvertFlagAgreement = "1"
0116       End If
0117       //
0118       F38010 Agreement Search
              "C" -> cDueTo
              BC Item Number - Short (F4211) -> mnIdentifierShortItem
              BC Business Unit (F4211) -> szSource1
              "CC" -> szSourceType1
              UNDEFINED X szSource2
              UNDEFINED X szSourceType2
              VA frm_PO_AgreementDestinationSAV -> szDestination1
              VA frm_DestinationType1 -> szDestinationType1
              UNDEFINED X szDestination2
              UNDEFINED X szDestinationType2
              BC Date - Updated (F4211) -> jdDate
              BC Quantity Shipped (F4211) -> mnQuantity1
              UNDEFINED X mnQuantity2
              BC Unit of Measure as Input (F4211) -> szUnitOfMeasure1
              UNDEFINED X szUnitOfMeasure2
              PO cAgreementSearchFlag -> cAgreementSearchMethod
              BC Document (Order No, Invoice, etc.) (F4211) -> mnOrderNumber
              BC Order Type (F4211) -> szOrderType
              BC Order Company (Order Number) (F4211) -> szOrderCompany
              BC Line Number (F4211) -> mnLineNumber
              UNDEFINED X szProductSource
              UNDEFINED X szProductSourceType
              GC Agreement Number <- szAgreementNumber
              GC Supp No <- mnAgreementSupplement
              UNDEFINED X mnSequenceNumber
              VA frm_AgreementsFound <- mnAgreementsFound
              UNDEFINED X cSuppressError
              VA frm_Job_Number -> mnJobnumberA
              VA frm_ComputerID -> szComputerID
              VA evt_CurrencyCodeBaseCompany -> szBaseCurrencyCode
              BC Currency Code - From (F4211) -> szForeignCurrencyCode
              UNDEFINED X mnAmountField
              "000" -> szOrderSuffix
              UNDEFINED X szErrorMessage
              UNDEFINED X cAccommodations
              UNDEFINED X cUpdateAmbStdWgt
              UNDEFINED X mnUnitPrice
              UNDEFINED X szPriceSchedule
              UNDEFINED X cAgreementType
              UNDEFINED X mnPartner
              UNDEFINED X cCommingled
              UNDEFINED X szUnitOfMeasurePricing
              UNDEFINED X mnForeignUnitPrice
              UNDEFINED X szCostCenter
              UNDEFINED X cAccommodationAgreeOnly
              VA evt_CurrToConvertFlagAgreement -> cCurrencyToConvert
              UNDEFINED X mnExchangeRate
0119       //
0120       If PO cAgreementSearchFlag is equal to "1"
           Or PO cAgreementSearchFlag is equal to "2"
0121          If VA frm_AgreementsFound is not equal to "1"
              Or GB AgreementNumber is equal to <Blank>
              Or GB AgreementNumber is equal to <Null>
0122             Set Grid Cell Error(FC Grid, <Current Row>, GC AgreementNumber, "009U")
0123          End If
0124       End If
0125       //
0126    Else
0127       //
0128       F38010 Full Edit Mode
              "2" -> cModeProcessing
              "C" -> cDueTo
              BC Item Number - Short (F4211) -> mnIdentifierShortItem
              BC Business Unit (F4211) -> szSource1
              "CC" -> szSourceType1
              UNDEFINED X szSource2
              UNDEFINED X szSourceType2
              VA frm_PO_AgreementDestinationSAV -> szDestination1
              VA frm_DestinationType1 -> szDestinationType1
              UNDEFINED X szDestination2
              UNDEFINED X szDestinationType2
              BC Date - Actual Ship Date (F4211) -> jdDate
              BC Quantity Shipped (F4211) -> mnQuantity1
              UNDEFINED X mnQuantity2
              BC Unit of Measure - Primary (F4211) -> szUnitOfMeasure1
              UNDEFINED X szUnitOfMeasure2
              PO cAgreementSearchFlag -> cAgreementSearchMethod
              GC Agreement Number -> szAgreementNumber
              GC Supp No -> mnAgreementSupplement
              UNDEFINED X mnSequenceNumber
              UNDEFINED X szProductSource
              UNDEFINED X szProductSourceType
              BC Document (Order No, Invoice, etc.) (F4211) -> mnOrderNumber
              BC Order Type (F4211) -> szOrderType
              BC Order Company (Order Number) (F4211) -> szOrderCompany
              BC Line Number (F4211) -> mnLineNumber
              UNDEFINED X mnUnitPrice
              UNDEFINED X cAgreementType
              UNDEFINED X szUnitOfMeasurePricing
              UNDEFINED X mnAmountField
              VA evt_CurrencyCodeBaseCompany -> szBaseCurrencyCode
              BC Currency Code - From (F4211) -> szForeignCurrencyCode
              UNDEFINED X mnForeignPrice
              UNDEFINED X szDepot
              UNDEFINED X mnAgreementsFound
              UNDEFINED X szPriceAdjustmentScheduleN
              VA frm_Job_Number -> mnJobnumberA
              VA frm_ComputerID -> szComputerID
              "000" -> szOrderSuffix
              VA frm_ErrorMessageCode <- szErrorMessage
              UNDEFINED X cAccommodations
              UNDEFINED X cUpdateAmbStdWgt
              UNDEFINED X mnPartner
              UNDEFINED X cCommingled
              UNDEFINED X cAccommodationAgreeOnly
              UNDEFINED X cSuppressError
              VA evt_CurrToConvertFlagAgreement -> cCurrencyToConvert
              UNDEFINED X mnExchangeRate
0129       VA frm_ErrorMessageCode = "    "
0130       //
0131       If VA frm_ErrorMessageCode is not equal to <Blank>
0132          Clear Grid Cell Error(FC Grid, <Current Row>, GC AgreementNumber)
0133       End If
0134    End If
0135 End If
0136 //

-----------------------------------------------------------------------
     EVENT:  Write Grid Line-Before
-----------------------------------------------------------------------
0001 // ******************************************************************
0002 // Modifications:
0003 //
0004 // 08/26/2004  JS6787836  7189942 - Retrieve the Memo Lot fields
0005 // 02/14/2005  MD5644340  7459720 - Ship Confirm Edit Line Performance
0006 // ******************************************************************
0007 //
0008 //     Move the quantity shipped from F4211 into a display field.  This is
0009 //     because the qty shipped is used in various calculations in the
0010 //     confirmation logic and its value may be chnaged to support these
0011 //     calculations.  Therefore, this display field is used to keep the entered
0012 //     qty shipped from changing visually to the user.
0013 //
0014 GC QuantityShipped = GC QuantityShippedDB
0015 GC SecondaryQty Shipped = GC SecondaryQtyShippedDB
0016 //
0017 // SAR 7459720    MD5644340    02/14/2005
0018 // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
0019 // Add a Ship Confirm Item Cache to store item information
0020 // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
0021 Ship Confirm Cache For Items
        "1" -> szCacheActionCode
        "3" -> mnNumberKeys
        VA frm_Job_Number -> mnJobnumberA
        VA frm_ComputerID -> szComputerID
        GC Short Item No -> mnIdentifierShortItem
        GC Item Number <- szItemNoUnknownFormat
        GC Bulk Flag [HIDDEN] <- cBulkPackedFlag
        "1" -> cSuppressErrorMessage
        VA frm_ERRC_GenericErrorCode <- cErrorCode
        VA frm_szErrorMessageID_DTAI <- szErrorMessage
0022 //
0023 If VA frm_szErrorMessageID_DTAI is not equal to <Blank> And VA frm_szErrorMessageID_DTAI is not equal to <Null>
0024    F4101 Get Item Master Information
           GC Short Item No -> mnShortItemNumber
           GC Item Number <- szPrimaryItemNumber
           GC Bulk Flag [HIDDEN] <- cBulkPackedFlag
0025    //
0026    If VA frm_ERRC_GenericErrorCode is equal to "1"
        Or VA frm_IVI_Inv_Interface is equal to "N"
0027       GC ItemNumber = GC 2nd ItemNumber
0028    End If
0029    //
0030    Ship Confirm Cache For Items
           "7" -> szCacheActionCode
           "3" -> mnNumberKeys
           VA frm_Job_Number -> mnJobnumberA
           VA frm_ComputerID -> szComputerID
           GC Short Item No -> mnIdentifierShortItem
           GC Item Number -> szItemNoUnknownFormat
           GC Bulk Flag [HIDDEN] -> cBulkPackedFlag
           "1" -> cSuppressErrorMessage
           VA frm_ERRC_GenericErrorCode <- cErrorCode
           VA frm_szErrorMessageID_DTAI <- szErrorMessage
0031 End If
0032 //
0033 // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
0034 // Add a Ship Confirm Location Cache to store location
0035 // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
0036 Ship Confirm Cache For Locations
        "1" -> szCacheActionCode
        "4" -> mnNumberKeys
        VA frm_Job_Number -> mnJobnumberA
        VA frm_ComputerID -> szComputerID
        GC Branch/ Plant -> szBranchPlant
        GC Location (DB Format) [HIDDEN] -> szLocation_DBFormat
        GC Location <- szLocation
        "1" -> cSuppressErrorMessage
        VA frm_ERRC_GenericErrorCode <- cErrorCode
        VA frm_szErrorMessageID_DTAI <- szErrorMessage
0037 If VA frm_szErrorMessageID_DTAI is not equal to <Blank> And VA frm_szErrorMessageID_DTAI is not equal to <Null>
0038    F4100 Format Location
           GC Branch/ Plant -> szCostCenter
           GC Location <- szDisplayFormatLocation
           GC Location (DB Format) [HIDDEN] -> szFileFormatLocation
           "4" -> cValidate
           UNDEFINED X szAisle
           UNDEFINED X szBin
           UNDEFINED X szLocation3
           UNDEFINED X szLocation4
           UNDEFINED X szLocation5
           UNDEFINED X szLocation6
           UNDEFINED X szLocation7
           UNDEFINED X szLocation8
           UNDEFINED X szLocation9
           UNDEFINED X szLocation10
           "1" -> cMode
           UNDEFINED X idBranchConstantRecord
0039    Ship Confirm Cache For Locations
           "7" -> szCacheActionCode
           "4" -> mnNumberKeys
           VA frm_Job_Number -> mnJobnumberA
           VA frm_ComputerID -> szComputerID
           GC Branch/ Plant -> szBranchPlant
           GC Location (DB Format) [HIDDEN] -> szLocation_DBFormat
           GC Location -> szLocation
           "1" -> cSuppressErrorMessage
           VA frm_ERRC_GenericErrorCode <- cErrorCode
           VA frm_szErrorMessageID_DTAI <- szErrorMessage
0040 End If
0041 //
0042 //  Increment and  assign grid row number.
0043 VA frm_LNIX_RowNumberCounter = [VA frm_LNIX_RowNumberCounter]+1
0044 GC LNIX-LastAssignedNumber = VA frm_LNIX_RowNumberCounter
0045 //
0046 //  Save Column Data that can be changed by User for later Comparison.
0047 GC QuantityShipped_SAVE = GC QuantityShipped
0048 GC Secondary Quantity_SAVE = GC SecondaryQty Shipped
0049 GC LocationSAVE = GC LocationSAVE
0050 GC Lot SerialNumber_SAVE = GC Lot/Serial
0051 GC BusinessUnit_SAVE = GC Branch/Plant
0052 GC QuantityBackordered_SAVE = GC QuantityBackordered
0053 GC QuantityCanceled_SAVE = GC QuantityCanceled
0054 GC ContainerI.D._SAVE = GC ContainerI.D.
0055 GC CarrierNumberSAVE = GC CarrierNumberSAVE
0056 GC Actual ShipDate_SAVE = GC Actual ShipDate
0057 GC Ship ToNumber_SAVE = GC Ship ToNumber
0058 GC LnTy_SAVE = GC LnTy
0059 GC ActualShip Time - Save = GC ActualShip Time
0060 //
0061 // =====================================
0062 // Pinnacle - Multiple Lot Dates
0063 // =====================================
0064 GC Lot ExpirationDate_Save = GC Lot ExpirationDate
0065 GC Lot EffectivityDate_Save = GC Lot EffectivityDate
0066 // =====================================
0067 // End Pinnacle - Multiple Lot Dates
0068 // =====================================
0069 //
0070 //  All Lines read from Business View - Set Action Code = C
0071 GC AC = "C"
0072 //
0073 GC RecordWritten = "0"
0074 GC Edit Mode = "1"
0075 //
0076 // Save Original Key Information (For Use by Split Line Functionality)
0077 GC OriginalOrderCo = GC OrderCo
0078 GC OriginalOrderNum = GC OrderNumber
0079 GC OriginalLineNum = GC LineNumber
0080 GC OriginalOrderType = GC OrTy
0081 //
0082 // *******************************************************************
0083 // SAR 3031486 - Add test to see if Short Item Number is present before
0084 // erforming test of Item for Bulk .  04/21/99 R. Bolei
0085 //
0086 //     BULK
0087 //
0088 If VA frm_UseBulkManagement is equal to "1"
     And BC Item Number - Short (F4211) is greater than <Zero>
0089    If GC BulkFlag is equal to "B"
0090       //
0091       Enable Grid(FC Grid, <Current Row>, GC AmbientVolume)
0092       Enable Grid(FC Grid, <Current Row>, GC Ambient Volume UOM)
0093       Enable Grid(FC Grid, <Current Row>, GC StandardVolume)
0094       Enable Grid(FC Grid, <Current Row>, GC StandardVolume UOM)
0095       Enable Grid(FC Grid, <Current Row>, GC WeightQuantity)
0096       Enable Grid(FC Grid, <Current Row>, GC Weight Qty UOM)
0097       Enable Grid(FC Grid, <Current Row>, GC Temperature)
0098       Enable Grid(FC Grid, <Current Row>, GC TempType)
0099       Enable Grid(FC Grid, <Current Row>, GC DisplayDensity)
0100       Enable Grid(FC Grid, <Current Row>, GC DensityType)
0101       Enable Grid(FC Grid, <Current Row>, GC DensityTemp)
0102       Enable Grid(FC Grid, <Current Row>, GC Density Temp Type)
0103       Enable Grid(FC Grid, <Current Row>, GC Vol CorFactor)
0104       Enable Grid(FC Grid, <Current Row>, GC TransactionTime - Bulk)
0105       //
0106       //
0107       // Show All Bulk Columns for first Bulk record found.
0108       If VA frm_BulkPackFlag_F4101 is not equal to "B"
0109          //
0110          VA frm_BulkPackFlag_F4101 = "B"
0111          //
0112          Show Grid Column(FC Grid, GC AmbientVolume)
0113          Show Grid Column(FC Grid, GC Ambient Volume UOM)
0114          Show Grid Column(FC Grid, GC StandardVolume)
0115          Show Grid Column(FC Grid, GC StandardVolume UOM)
0116          Show Grid Column(FC Grid, GC WeightQuantity)
0117          Show Grid Column(FC Grid, GC Weight Qty UOM)
0118          Show Grid Column(FC Grid, GC Temperature)
0119          Show Grid Column(FC Grid, GC TempType)
0120          Show Grid Column(FC Grid, GC DisplayDensity)
0121          Show Grid Column(FC Grid, GC DensityType)
0122          Show Grid Column(FC Grid, GC DensityTemp)
0123          Show Grid Column(FC Grid, GC Density Temp Type)
0124          Show Grid Column(FC Grid, GC Vol CorFactor)
0125          Show Grid Column(FC Grid, GC TransactionTime - Bulk)
0126       End If
0127       //  End - Show Bulk Columns
0128       //
0129       // GET BULK QUANTITIES   -  from Transaction Amount
0130       Determine Which Bulk Quantity to Load From Trans Qty
              GC Quantity ShippedDB [HIDDEN] <> mnQuantityTransaction
              GC Unit of Measure <> szUnitOfMeasureAsInput
              GC Ambient Volume <> mnAmbientResult
              GC Ambient  Volume UOM <> szUnitofMeasure3
              GC Standard Volume <> mnStockTotalVolume
              GC Standard Volume UOM <> szUnitofMeasure4
              GC Weight Quantity <> mnWeightResult
              GC Weight  Qty UOM <> szUnitofMeasure5
              PO cBulkTransactionVolFlag -> cAmbientOrStandard
0131       // Bulk Refactoring - Begin
0132       GC AmbientVolume_Save = GC AmbientVolume
0133       GC Ambient_Vol_UOM_Save = GC Ambient Volume UOM
0134       GC StandardVolume_Save = GC StandardVolume
0135       GC Standard_VolumeUOM_Save = GC StandardVolume UOM
0136       GC WeightResult_Save = GC WeightQuantity
0137       GC Weight_QtyUOM_Save = GC Weight Qty UOM
0138       // Bulk Refactoring - End
0139    End If
0140    //  End - Check Bulk Flag
0141    //
0142 End If
0143 //  End - Check Bulk Management Use
0144 //
0145 // SAR 7189942 - Retrieve the Memo Lot fields
0146 If GC Lot/Serial is not equal to <Blank> And GC Lot/Serial is not equal to <Null>
0147    //
0148    // SAR 7459720    MD5644340    02/14/2005
0149    // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
0150    // Add a Ship Confirm Lot Cache to store lot information
0151    // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
0152    Ship Confirm Cache For Lots
           "1" -> szCacheActionCode
           "3" -> mnNumberKeys
           VA frm_Job_Number -> mnJobnumberA
           VA frm_ComputerID -> szComputerID
           GC Short Item No -> mnShortItemNumber
           GC Branch/ Plant -> szBranchPlant
           GC Lot/Serial -> szLot_SerialNo
           GC Memo Lot 1 <- szMemoLot1
           GC Memo Lot 2 <- szMemoLot2
           "1" -> cSuppressErrorMessage
           VA frm_ERRC_GenericErrorCode <- cErrorCode
           VA frm_szErrorMessageID_DTAI <- szErrorMessage
0153    //
0154    If VA frm_szErrorMessageID_DTAI is not equal to <Blank> And VA frm_szErrorMessageID_DTAI is not equal to <Null>
0155       F4108 Get Lot Master Information
              GC Short Item No -> mnShortItemNumber
              GC Branch/ Plant -> szBranchPlant
              GC Lot/Serial -> szLotNumber
              GC Memo Lot 1 <- szMemoLot1
              GC Memo Lot 2 <- szMemoLot2
0156       Ship Confirm Cache For Lots
              "7" -> szCacheActionCode
              "3" -> mnNumberKeys
              VA frm_Job_Number -> mnJobnumberA
              VA frm_ComputerID -> szComputerID
              GC Short Item No -> mnShortItemNumber
              GC Branch/ Plant -> szBranchPlant
              GC Lot/Serial -> szLot_SerialNo
              GC Memo Lot 1 -> szMemoLot1
              GC Memo Lot 2 -> szMemoLot2
              "1" -> cSuppressErrorMessage
              VA frm_ERRC_GenericErrorCode <- cErrorCode
              VA frm_szErrorMessageID_DTAI <- szErrorMessage
0157    End If
0158    //
0159 End If
0160 // end SAR 7189942

-----------------------------------------------------------------------
     EVENT:  Last Grid Record Has Been Read
-----------------------------------------------------------------------
0001 // ******************************************************************
0002 // Modifications:
0003 // 02/14/2005  MD5644340  7459720 - Ship Confirm Edit Line Performance
0004 // ******************************************************************
0005 //
0006 // SAR 7459720    MD5644340    02/14/2005
0007 // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
0008 // The grid rows only need to be disabled once and not for every grid row
0009 // The following columns must be protected so that the user will not
0010 // accdentially change the values.
0011 // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
0012 Disable Grid(FC Grid,  <All Rows>, GC ItemNumber)
0013 Disable Grid(FC Grid,  <All Rows>, GC Description)
0014 Disable Grid(FC Grid,  <All Rows>, GC DescriptionLine 2)
0015 Disable Grid(FC Grid,  <All Rows>, GC LastStat)
0016 Disable Grid(FC Grid,  <All Rows>, GC NextStat)
0017 Disable Grid(FC Grid,  <All Rows>, GC OrderNumber)
0018 Disable Grid(FC Grid,  <All Rows>, GC OrTy)
0019 Disable Grid(FC Grid,  <All Rows>, GC OrderCo)
0020 //
0021 If PO szPreloadOption is equal to "1"
0022    Change Row Selection(FC Grid,  <All Rows>,  <Selected (1)>)
0023 End If

-----------------------------------------------------------------------
     EVENT:  End Dialog
-----------------------------------------------------------------------
0001 // ******************************************************************
0002 // Modifications:
0003 //
0004 // ******************************************************************
0005 // Remove all Kit Parent Line cache records created for Multi Location
0006 //
0007 If VA frm_MultiLocationJobnumber is greater than <Zero>
0008    Process Kit Parent Line Cache
           VA frm_MultiLocationJobnumber -> mnKitParentJobNumber
           VA frm_ComputerID -> szComputerID
           UNDEFINED X mnDocumentOrderInvoiceE
           UNDEFINED X szOrderType
           UNDEFINED X szCompanyKeyOrderNo
           UNDEFINED X mnLineNumber
           "5" -> szCacheActionCode
           UNDEFINED X idCacheCursor
           "2" -> mnNumberKeys
           "1" -> cSuppressErrorMessage
           UNDEFINED X szErrorMessageID
           UNDEFINED X cSDAllowBackorders
           UNDEFINED X cIBBackordersFlag
           UNDEFINED X cIMBackordersFlag
0009 End If
0010 //

-----------------------------------------------------------------------
     EVENT:  Write Grid Line-After
-----------------------------------------------------------------------
     evt_szDocumentNumber_DOC8
0001 // ******************************************************************
0002 // Modifications:
0003 // 02/14/2005  MD5644340  7459720 - Ship Confirm Edit Line Performance
0004 // ******************************************************************
0005 //
0006 // SAR 7459720    MD5644340    02/14/2005
0007 // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
0008 // Disabling of grid row will only need to happen once, therefore the logic
0009 // has been moved to the Last Grid Record Has Been Written event.
0010 // The validation of for record reservation only needs to be performed once,
0011 // therefore the logic has been moved to the Post Dialog is Initialized event
0012 // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
0013 //
0014 //  If reservations are being tested then build a unique key for the file being
0015 //  processed by concatinating fields together.
0016 If VA frm_cValidateApplication_ERR1 is equal to "0"
0017    //
0018    //  To limit the I/O and testing only process the reserve business object
0019    //  function when the key has changed.  In this case the key is Order Number,
0020    //  Order Type, and Order Company.  Use save fields to help limit this action.
0021    If VA frm_mnRecordReserveOrder_DOCO is not equal to BC Document (Order No, Invoice, etc.) (F4211)
        Or VA frm_szRecordReserveType_DCTO is not equal to BC Order Type (F4211)
        Or VA frm_szRecordReserveCompanyKCOO is not equal to BC Order Company (Order Number) (F4211)
0022       Math Numeric to String, Convert
              BC Document (Order No, Invoice, etc.) (F4211) -> mnMathNumeric01
              VA evt_szDocumentNumber_DOC8 <- szVideoConstant30A
0023       VA frm_szGenericKey_GENKEY = concat([VA evt_szDocumentNumber_DOC8],[BC Order Type (F4211)])
0024       VA frm_szGenericKey_GENKEY = concat([VA frm_szGenericKey_GENKEY],[BC Order Company (Order Number) (F4211)])
0025       //
0026       //  Une function to reserve or issue a Warning / Error if the key / file is
0027       //  already being used by another user / application.
0028       //
0029       F00095 Reserve Object
              "F4211" -> szNameObject
              SL UserID                          -> szUserId
              "1" -> cSuppressErrorMessage
              VA frm_szRecordReserveErrMsg_DTAI <- szErrorMessageID
              VA frm_szReserversnameAlpha_ALPH <- szReserversNameAlpha
              VA frm_szGenericKey_GENKEY -> szGenericKey
              VA frm_szUniqueIDRecReserve_PID -> szApplication
              VA frm_szReserverAppId_PID <- szReserversApplication
              "1" -> cWarningError
0030       VA frm_mnRecordReserveOrder_DOCO = BC Document (Order No, Invoice, etc.) (F4211)
0031       VA frm_szRecordReserveType_DCTO = BC Order Type (F4211)
0032       VA frm_szRecordReserveCompanyKCOO = BC Order Company (Order Number) (F4211)
0033    End If
0034    If VA frm_szRecordReserveErrMsg_DTAI is not equal to <Blank>
        And VA frm_szRecordReserveErrMsg_DTAI is not equal to <Null>
0035       //
0036       //  On lines that have a warning/ error because the line is reserved by another
0037       //  user suppress grid line and issue a warning / error.  Also place a "X" on th
0038       //  grid line so the user sees which lines are problems.
0039       //
0040       Set Object Reservation Text Substitution Error
              VA frm_szReserversnameAlpha_ALPH -> szReserversNameAlpha
              VA frm_szGenericKey_GENKEY -> szGenericKey
              VA frm_szReserverAppId_PID -> szApplication
              "1" -> cWarningError
0041       Disable Grid(FC Grid,  <Current Row>,  <All Columns>)
0042       Set Grid Row Bitmap(FC Grid,  <Current Row>,  <X Mark>)
0043       VA grd_cGridRecordDisabled_EV01 = "1"
0044       If PO szPreloadOption is equal to "1"
0045          GC Sel = 1 = " "
0046       End If
0047       //
0048    Else
0049       //    Performance (Reverse)
0050 !       If GC Sel = 1 is equal to "1"
0051 !          Press Button(FC OKButtonEditLineLogic)
0052 !       End If
0053       // 3069003 - RB5679171  06/14/99
0054       // Add grid variable Related Kit Component, and initialize it's value
0055       //
0056       VA grd_RelatedKitComponent = BC Related Kit Component (F4211)
0057       //
0058       // end 3069003
0059       // ============================================================
0060       // SAR 6621220 - Kits & Times
0061       // Disable Actual Ship TIme for Kit/Configured Item Parent and Kit/Configured
0062       // Item Component Lines
0063       // ============================================================
0064       If BC Committed (F4211) (H/S) is equal to "K" Or BC Kit Master Line (F4211) Number is greater than <Zero>
0065          Disable Grid(FC Grid,  <Currently Selected Row>, GC ActualShip Time)
0066       End If
0067    End If
0068 End If
0069 //

-----------------------------------------------------------------------
     EVENT:  Post Commit
-----------------------------------------------------------------------
0001 // ===========================================================================
0002 // Autor:  Randy Mendyk
0003 // Date:  06/23/03
0004 // SAR Number:  6612745
0005 // Notes:
0006 // This event will handle all the processing which needs to happen after the
0007 // transaction boundary (TP) is complete.  The only logic that is in this
0008 // event at this time is the auto-rollback of the F41021.
0009 // ---------------------------------------------------------------------------
0010 // SAR LOG
0011 // ===========================================================================
0012 // SAR 6612745 - Auto Rollback of F41021 Enhancement
0013 If SV TP_Commit_Status is equal to CO TP_COMMIT_FAIL
0014    If FI cTRAN_SyncrhonousEndDoc is not equal to "1"
0015       Process F41021WF Records
              VA frm_ComputerID -> szComputerID
              VA frm_Job_Number -> mnJobnumberA
              VA frm_mnUniqueKeyIDF41021WF_UKID -> mnUniqueKeyIDInternal
0016    End If
0017 End If

-----------------------------------------------------------------------
     EVENT:  Variable
-----------------------------------------------------------------------
     frm_UserID
     frm_AuditInfoDate
     frm_ComputerID
     frm_HCOD_HoldCode
     frm_DTAI_Data_Item
     frm_IVI_Inv_Interface
     frm_TXYN_Text_YN
     frm_LTYI_LastLineTypeRead
     frm_SYM1_GenericFlag
     frm_ERRC_GenericErrorCode
     frm_Job_Number
     frm_VersionName
     frm_ActionCode
     frm_CancelForm
     frm_RowChanged
     frm_RecordsInCache
     frm_PO_Options_Retrieved
     frm_Default_ContainerID
     frm_Default_CarrierNumber
     frm_Default_ShipDate
     frm_MCU_szCacheBranch
     frm_LOCN_szCacheLocation
     frm_LOTN_szCacheLotNumber
     frm_idCacheCursor_GENLNG
     frm_UORG_mnTotalQty_Wrkfld
     frm_GridRowNumber
     frm_FormErrorCount
     frm_MuliLoc_CheckAvail
     frm_MultiLoc_PreventNegOH
     frm_MultiLoc_PreventOverShip
     frm_PO_ErrorHeldLocations
     frm_PO_CheckAvailability
     frm_PO_PreventNegOnHand
     frm_PO_PreventOverShip
     frm_PO_AutoBackCancel
     frm_PO_NextStatusConfirm
     frm_PO_NextStatusBackOrder
     frm_PO_NextStatusAdd
     frm_PO_DisplayKitComponents
     frm_PO_NextStatusAddlLines
     frm_LNIX_RowNumberCounter
     frm_BSN_SOQS_Ship_Qty
     frm_BSN_EV15_EndOfCacheFlag
     frm_BSN_EV16_OpenCacheFlag
     frm_BSN_GENLNG_F42UI05CacheHdl
     frm_BSN_SRNR_SerialNumberReq
     frm_BSN_ITM_ShortItemNumber
     frm_BSN_MCU2_BranchPlant
     frm_BSN_DOC_OrderNumber
     frm_BSN_DCT_OrderType
     frm_BSN_KCO_OrderCompany
     frm_BSN_LNID_LineNumber
     frm_BSN_UOM_TransactionUoM
     frm_BSN_LOCN_Location
     frm_BSN_LOTN_LotNumber
     frm_BSN_DATE01_ActualShipDate
     frm_BSN_NXT2_NextStatus
     frm_INT01_RowNumber
     frm_SaveCurrentLineNumber
     frm_BSN_AN8_CustomerNumber
     frm_BSN_SHAN_ShipToNumber
     frm_BSN_TRDJ_OrderDate
     frm_ModularExistanceSYS37
     frm_SaveMCU
     frm_GetEnvironmentExistance
     frm_AgreementProductSource
     frm_AgreementSourceType
     frm_DestinationType1
     frm_SystemCodeBPSearch
     frm_AN8AgreementDestination
     frm_ForeignDepot
     frm_AgreementsFound
     frm_ErrorMessageCode
     frm_PO_AgreementDestinationSAV
     frm_BulkPackFlag_F4101
     frm_UseBulkManagement
     frm_BSN_ShipmentNumber
     frm_cCreateNonSerialFromShip
     frm_GENLNG_ItemMasterPtr
     grd_WeightQtyReversed_WGTR
     grd_StandardQtyReversed_STOK
     grd_AmbientVolumeReversed_AMBR
     grd_ShipQtyReversed_SOQS
     frm_cValidateApplication_ERR1
     frm_mnRecordReserveOrder_DOCO
     frm_szRecordReserveType_DCTO
     frm_szRecordReserveCompanyKCOO
     frm_szGenericKey_GENKEY
     frm_szReserverAppId_PID
     frm_szRecordReserveErrMsg_DTAI
     frm_szReserversnameAlpha_ALPH
     grd_cGridRecordDisabled_EV01
     frm_ConfiguredItemFlag
     grd_RelatedKitComponent
     frm_KitParentFlag
     frm_szSave_DefContainer_CNID
     frm_mnSave_DefCarrier_CARS
     frm_MultiLocationJobnumber
     frm_DefaultLoadTime
     frm_SQOR_TotalQty_Wrkfld
     frm_ShipAscendingDateActive
     frm_BulkPackedFlag_Save
     frm_MMEJ_jdLotExpiration
     frm_Previous_OrderNumber_DOCO
     frm_Previous_OrderType_DCTO
     frm_Previous_OrderCompany_KCOO
     frm_cDemandSchedReleased_DSRFU
     frm_cEditDocSuccessfulYN_EV01
     frm_mnDefaultShipTime_TME0
     frm_mnMaxNumOfGridRows_MATH01
     frm_mnUniqueIDRecReserve_UKID
     frm_szUniqueIDRecReserve_PID
     frm_mnUniqueKeyIDF41021WF_UKID
     frm_cClearMemo_CHAR
     frm_szErrorMessageID_DTAI

=======================================================================
     CONTROL:  HYPITEM &OK
     EVENT:  Button Clicked
-----------------------------------------------------------------------
     evt_szErrorMessageID_DTAI
     evt_cCallShipCnfrmEditDoc_EV01
0001 // ==================================================================
0002 // Author:  Randy Mendyk
0003 // Date:  01/06/03
0004 // SAR Number:  6271856
0005 // Notes:
0006 // This event will handle all the processing needed to support calling
0007 // Shipment Confirmation Edit Doc (N4200790).  Currently, Edit Doc is only
0008 // called when processing the Carton Reconciliation Line Level functionality.
0009 // ---------------------------------------------------------------------------
0010 // SAR LOG
0011 // 6581256 - Need to run edit line for all lines before Edit Doc
0012 // 03/04/2005   IC9024623   SAR#7484061 Constants Refactor - Sys 49
0013 // ==================================================================
0014 //
0015 // Carton Reconciliation Line Level - 6271856
0016 // Check to see if Demand Sched Released flag is turned on.  If it is, perform
0017 // the following logic.
0018 // ==================================================================
0019 // ==============
0020 // Initialize Variables
0021 // ==============
0022 VA evt_szErrorMessageID_DTAI = ""
0023 VA frm_cEditDocSuccessfulYN_EV01 = "Y"
0024 VA evt_cCallShipCnfrmEditDoc_EV01 = ""
0025 //
0026 If VA frm_cDemandSchedReleased_DSRFU is equal to "1"
0027    //
0028    // SAR 6581256 - Need to run all grid rows through edit line before running
0029    // Edit Doc.  See OKButtonEditLineLogic - Button Clicked event for more
0030    // details.
0031    //
0032    //    Performance (Reverse)
0033    Get Max Grid Rows(FC Grid, VA frm_mnMaxNumOfGridRows_MATH01)
0034    If VA frm_mnMaxNumOfGridRows_MATH01 is greater than <Zero>
0035       Press Button(FC OKButtonEditLineLogic)
0036    End If
0037    //
0038    // ==========================================================
0039    // This function will clear all edit line errors/warnings from the work center
0040    // queue.  This is needed because the first time a work center level is set,
0041    // all edit line errors/warnings will appear as if they occurred on that order
0042    // key when that may not be the case.
0043    // ==========================================================
0044    Clear Work Center Errors
           "1" -> cModeProcessing
0045    //
0046    // =======================================================
0047    // If Load Confirm is calling and Load Confirm's PO is set to perform Carton
0048    // Reconciliation, set the call edit doc flag on (1)
0049    // else set it off (<>1) because the Load Confirm PO overrides the P4205 PO
0050    // value to reconcile cartons
0051    // =======================================================
0052    If FI cCalledByTransportation is equal to "1,2" And FI mnTran_LoadNumber is greater than <Zero>
0053       If FI cReconcileCartonShipmentDetail is equal to "1"
0054          VA evt_cCallShipCnfrmEditDoc_EV01 = "1"
0055       Else
0056          VA evt_cCallShipCnfrmEditDoc_EV01 = ""
0057       End If
0058    Else
0059       If PO cReconcileCartonShipmentDetail is equal to "1"
0060          VA evt_cCallShipCnfrmEditDoc_EV01 = "1"
0061       Else
0062          VA evt_cCallShipCnfrmEditDoc_EV01 = ""
0063       End If
0064    End If
0065    // ===================================================
0066    // Call Ship Confirm Edit Document If Reconciling Carton Detail
0067    // ----------------------
0068    // Need to always be calling Edit Doc by passing in the FI Reconcile Flag as
0069    // it represents what transportations PO value is.  This combined with the
0070    // called by TMS flag will be used to determine if Reconciliation is performed
0071    // for transportation.  If TMS is not calling, Edit Doc will use P4205's PO
0072    // retrieved by the ship confirm PO/Constants Cache.
0073    // ===================================================
0074    If VA evt_cCallShipCnfrmEditDoc_EV01 is equal to "1"
0075       Shipment Confirmation Edit Document
              VA frm_Job_Number -> mnJobNumber
              VA frm_ComputerID -> szComputerID
              "EP4205" -> szProgramId
              "APPL" -> szProgramType
              VA evt_szErrorMessageID_DTAI <- szErrorMessageID
              FI cCalledByTransportation -> cCalledByTransportation
              FI cReconcileCartonShipmentDetail -> cReconcileCartonShipmentDetail
              FI mnShipmentNumber -> mnShipmentNumber
              FI mnTran_LoadNumber -> mnLoadNumber
0076       // ============================================================
0077       // If An Error Is Returned From Ship Confirm Edit Doc, Set A Form Level Error
0078       // To Indicate Edit Doc Was Not Successful And To Prevent Post OK Button Event
0079       // From Processing
0080       // ============================================================
0081       If VA evt_szErrorMessageID_DTAI is greater than <Blank>
0082          VA frm_cEditDocSuccessfulYN_EV01 = "N"
0083          Set Control Error(FC Order Number, VA evt_szErrorMessageID_DTAI)
0084       End If
0085    End If
0086 End If

-----------------------------------------------------------------------
     EVENT:  Post Button Clicked
-----------------------------------------------------------------------
     evt_cCSMSInstalled
     evt_szUKIDError_DTAI
0001 // ===========================================================================
0002 // If Edit Doc Has Not Produced Errors, Continue With The Processing Of Post
0003 // OK Button Clicked To Perform Updates (Condition Added By Carton
0004 // Reconciliation Line Level Enhancement - 6271856).
0005 // ===========================================================================
0006 If VA frm_cEditDocSuccessfulYN_EV01 is equal to "Y"
0007    If VA frm_RecordsInCache is equal to "Y"
0008       //
0009       //     For basic serial number processing, read the Shp Confirm Cache (F42UI05)
0010       //     for all of the records in the cache and check for the Serial Number
0011       //     Required flag.  If it is equal to 'Y', call the Serial Number Selection
0012       //     Window (P4220).
0013       //
0014       VA frm_BSN_EV15_EndOfCacheFlag = "0"
0015       VA frm_BSN_EV16_OpenCacheFlag = "0"
0016       VA frm_DTAI_Data_Item = " "
0017       VA frm_BSN_GENLNG_F42UI05CacheHdl = 0
0018       Load Or Unload Ship Confirm Cache
              VA frm_BSN_DOC_OrderNumber <- mnOrderNumber
              VA frm_BSN_DCT_OrderType <- szOrderType
              VA frm_BSN_KCO_OrderCompany <- szOrderCompany
              VA frm_BSN_LNID_LineNumber <- mnLineNumber
              UNDEFINED X mnReferenceLineNumber
              VA frm_BSN_ITM_ShortItemNumber <- mnItemNumber
              UNDEFINED X szLineType
              UNDEFINED X mnQuantityOrdered
              VA frm_BSN_SOQS_Ship_Qty <- mnQuantityShipped
              UNDEFINED X mnQuantityBackordered
              UNDEFINED X mnQuantityCanceled
              VA frm_BSN_MCU2_BranchPlant <- szBranchPlant
              VA frm_BSN_LOCN_Location <- szLocation
              VA frm_BSN_LOTN_LotNumber <- szLot
              UNDEFINED X cCommitmentFlag
              UNDEFINED X cOtherQuantityFlag
              UNDEFINED X szLastStatus
              VA frm_BSN_NXT2_NextStatus <- szNextStatus
              UNDEFINED X cOnHandFlag
              VA frm_BSN_DATE01_ActualShipDate <- jdActualShipDate
              UNDEFINED X cCostLevel
              UNDEFINED X mnUnitCost
              UNDEFINED X mnExtendedCost
              UNDEFINED X mnForeignUnitCost
              UNDEFINED X mnForeignExtendedCost
              UNDEFINED X mnUnitPrice
              UNDEFINED X mnExtendedAmount
              UNDEFINED X mnForeignUnitPrice
              UNDEFINED X mnForeignExtendedPrice
              UNDEFINED X szContainerID
              UNDEFINED X mnCarrierID
              UNDEFINED X mnItemWeight
              UNDEFINED X szWeightUOM
              UNDEFINED X cApplyFreightFlag
              UNDEFINED X mnCurrencyConverRate
              UNDEFINED X cFreightCalculated
              UNDEFINED X szFreightRateCode
              UNDEFINED X cAllowPartialShipments
              UNDEFINED X cSalesDetailBackorderFlag
              UNDEFINED X szRelatedItemNumber
              UNDEFINED X szSecondaryUOM
              UNDEFINED X szPricingUOM
              UNDEFINED X szVolumeUOM
              UNDEFINED X cItemMasterBackorderFlag
              UNDEFINED X cItemBalanceBackorderFlag
              UNDEFINED X cPotencyControl
              UNDEFINED X mnStandardPotency
              UNDEFINED X cLotProcessingCode
              UNDEFINED X cInventoryInterface
              UNDEFINED X cEditsProcessedFlag
              VA frm_BSN_EV15_EndOfCacheFlag <- cErrorCode
              "" -> cSuppressErrorMessage
              VA frm_DTAI_Data_Item <- szErrorMessageID
              UNDEFINED X mnCacheLineNumber
              "I" -> cObsoleteCode
              UNDEFINED X szCurrencyCode
              VA frm_BSN_EV16_OpenCacheFlag <> cOpenCacheCursorFlag
              UNDEFINED X cWriteLedgerFlag
              UNDEFINED X mnConversionFactor
              <Blank> -> cCallType
              UNDEFINED X mnLastLineNumAssign
              VA frm_Job_Number -> mnJobNumberA
              VA frm_ComputerID -> szComputerID
              VA frm_BSN_GENLNG_F42UI05CacheHdl <> idCacheCursor
              UNDEFINED X cBatchInteractiveFlag
              UNDEFINED X mnX4111Z1CacheLineNum
              UNDEFINED X mnB4200310CacheLineNum
              UNDEFINED X cRecordWrittenToWFB4200310
              UNDEFINED X cSODetailActionCode
              UNDEFINED X mnActualShipTime
              UNDEFINED X jdActualDeliveryDate
              UNDEFINED X cInventoryAffectFlag
              VA frm_BSN_ShipmentNumber <- mnShipmentNumber
              UNDEFINED X mnAmbientVolume
              UNDEFINED X szAmbientVolumeUOM
              UNDEFINED X mnStandardVolume
              UNDEFINED X szStandardVolumeUOM
              UNDEFINED X mnWeightQuantity
              UNDEFINED X szWeightQuantityUOM
              UNDEFINED X mnTemperature
              UNDEFINED X cTemperatureType
              UNDEFINED X mnDensity
              UNDEFINED X cDensityType
              UNDEFINED X mnDensityTemperature
              UNDEFINED X cDensityTemperatureType
              UNDEFINED X mnTransactionTime
              UNDEFINED X szBranchComponent
              UNDEFINED X mnLineNumberKitMaster
              UNDEFINED X mnComponentNumber
              UNDEFINED X mnRelatedKitComponent
              UNDEFINED X mnNumbOfCpntPerParent
              UNDEFINED X cOHInventoryRelievedFlag
              UNDEFINED X mnVolumeCorrectionFactors
              UNDEFINED X szMemoLotField1
              UNDEFINED X szMemoLotField2
              UNDEFINED X szVendorLotNumber
              UNDEFINED X mnOriginalLineNumber
              UNDEFINED X cValidateStatusCode
              VA frm_BSN_SRNR_SerialNumberReq <- cSerialNumberRequired
              VA frm_BSN_UOM_TransactionUoM <- szUnitOfMeasureAsInput
              UNDEFINED X cPlanTimeFenceRule
              UNDEFINED X mnQtyCountedInPrimary
              UNDEFINED X mnAmountUnitVolume
              UNDEFINED X mnUnitsSecondaryQtyOr
              "2" -> mnNumberKeys
              "6" -> szCacheActionCode
              VA frm_BSN_AN8_CustomerNumber <- mnAddressNumber
              VA frm_BSN_SHAN_ShipToNumber <- mnAddressNumberShipTo
              VA frm_BSN_TRDJ_OrderDate <- jdDateTransactionJulian
              UNDEFINED X mnExtendedCostTransfer
              UNDEFINED X cInterbranchSalesFlag
              UNDEFINED X szNextStatusCodeSplit
              UNDEFINED X szSellingCompanyCurrecyCode
              UNDEFINED X mnContractSupplementDistri
              UNDEFINED X szContractNumberDistributi
              UNDEFINED X szPrimaryVehicleId
              UNDEFINED X szRegistrationLicenseNumbe
              UNDEFINED X szUpdateSalesAgreement
              UNDEFINED X jdLoadConfirmDate
              UNDEFINED X mnTimeLoad
              UNDEFINED X cBulkPackedFlag
              UNDEFINED X szAGREE_ProductSource
              UNDEFINED X szAGREE_ProductSourceType
              UNDEFINED X mnAGREE_SequenceNumber1
              UNDEFINED X cShipDateOverridden
              UNDEFINED X szModeOfTransport
              UNDEFINED X szPurchasingReportCode1
              UNDEFINED X szTranOverride_NXTR
              UNDEFINED X cDualUnitOfMeasureItem
              UNDEFINED X cDualPickingProcessOption
              UNDEFINED X mnConversionFactorTrantoSecnd
              UNDEFINED X mnConvFactorSecondarytoTrans
              UNDEFINED X mnConvFactorScndrytoScndPrime
              UNDEFINED X mnOrderQuantityinSecondaryUOM
              UNDEFINED X cCheckExpirationDate
              UNDEFINED X cCheckSellByDate
              UNDEFINED X cCheckBestBeforeDate
              UNDEFINED X jdBestBeforeDate
              UNDEFINED X jdSellByDate
              UNDEFINED X cPrefLotBasedOnDates
              UNDEFINED X jdDateLotExpiration
              UNDEFINED X cCommitmentDateMethod
              UNDEFINED X szLineTypeTable_LNTY
              UNDEFINED X mnOrderQtyTable_UORG
              UNDEFINED X mnShipQtyTable_SOQS
              UNDEFINED X mnBackorderQtyTable_SOBK
              UNDEFINED X mnCancelQtyTable_SOCN
              UNDEFINED X szBranchPlantTable_MCU
              UNDEFINED X szLocationTable_LOCN
              UNDEFINED X szLotNumberTable_LOTN
              UNDEFINED X cCommitFlagTable_COMM
              UNDEFINED X szNextStatusTable_NXTR
              UNDEFINED X cOnHandFlagF4211_SO02
              UNDEFINED X mnUnitCostTable_UNCS
              UNDEFINED X mnCostExtendedTable_ECST
              UNDEFINED X mnForeignUnitCostTable_FUC
              UNDEFINED X mnForeignExtCostTable_FEC
              UNDEFINED X mnExtendedPriceTable_AEXP
              UNDEFINED X mnForeignExtPriceTable_FAP
              UNDEFINED X szContainerIDTable_CNID
              UNDEFINED X mnCarrierTable_CARS
              UNDEFINED X mnItemWeightTable_ITWT
              UNDEFINED X szCurrencyCodeTable_CRCD
              UNDEFINED X szPrimaryUoMTable_UOM1
              UNDEFINED X jdSchedPickDateTable_PDDJ
              UNDEFINED X szItemNumber2nd_LITM
              UNDEFINED X szItemNumber3rd_AITM
              UNDEFINED X szCompany_Table_CO
              UNDEFINED X mnPickSlipNumbTable_PSN
              UNDEFINED X mnItemVolumeTable_ITVL
              UNDEFINED X cCostOverrideFlagTable_CSTO
              UNDEFINED X mnPrimaryOrderQtyTable_PQOR
              UNDEFINED X mnSecondOrderQtyTable_SQOR
              UNDEFINED X jdDateRequestedTable_DRQJ
              UNDEFINED X jdDateReleaseTable_RSDJ
              UNDEFINED X szSalesAgreementNumb_DMCT
              UNDEFINED X mnSalesAgreementSupp_DMCS
              UNDEFINED X cUpdateGLAccommodations_UPGL
              UNDEFINED X mnConvFactPricToPrim_CNV1
              UNDEFINED X szStandardUOMConversion_TFLA
              UNDEFINED X cWarehouseOnFlag_WCTL
              UNDEFINED X cTextLineYN
              UNDEFINED X jdShipDateF4211Table_ADDJ
              UNDEFINED X szPortOfEntryExit
              UNDEFINED X cFutureUseChar01
              UNDEFINED X cFutureUseChar02
              UNDEFINED X cFutureUseChar03
              UNDEFINED X cFutureUseChar04
              UNDEFINED X cFutureUseChar05
              UNDEFINED X cFutureUseChar06
              UNDEFINED X szFutureUseString01
              UNDEFINED X szFutureUseString02
              UNDEFINED X szFutureUseString03
              UNDEFINED X szFutureUseString04
              UNDEFINED X szFutureUseString05
              UNDEFINED X szFutureUseString06
              UNDEFINED X mnFutureUseMathNum01
              UNDEFINED X mnFutureUseMathNum02
              UNDEFINED X mnFutureUseMathNum03
              UNDEFINED X jdFutureUseDate01
              UNDEFINED X jdFutureUseDate02
              UNDEFINED X jdDatePromisedPickTable
              UNDEFINED X szFreightHandlingCodeTable
              UNDEFINED X szSecondaryPrimaryUOM
              UNDEFINED X mnActualShipTimeP4205Cache
              UNDEFINED X mnActualShipTimeTable
              UNDEFINED X mnRequestedDeliveryTime
              UNDEFINED X mnPromisedShipmentTime
              UNDEFINED X mnPromisedDeliveryTime
              UNDEFINED X cCacheIndex
              UNDEFINED X cPriceatAmbiantorStandard
0019       While VA frm_BSN_GENLNG_F42UI05CacheHdl is greater than <Zero>
0020          If PO cAllowReliefofInventory is not equal to "1"
0021             If VA frm_BSN_SRNR_SerialNumberReq is equal to "Y"
                 And VA frm_BSN_SOQS_Ship_Qty is not equal to <Zero>
                 And VA frm_BSN_NXT2_NextStatus is not equal to "999"
0022                Call( App:P4220 , Form: W4220D )
                       VA frm_BSN_ITM_ShortItemNumber -> ShortItemNumber
                       VA frm_BSN_MCU2_BranchPlant -> BranchPlant
                       VA frm_BSN_DOC_OrderNumber -> OrderNumber
                       VA frm_BSN_DCT_OrderType -> OrderType
                       VA frm_BSN_KCO_OrderCompany -> OrderCompany
                       "000" -> OrderSuffix
                       VA frm_BSN_LNID_LineNumber -> LineNumber
                       VA frm_BSN_SOQS_Ship_Qty -> QuantityShipped
                       VA frm_BSN_UOM_TransactionUoM -> UnitOfMeasure
                       VA frm_BSN_AN8_CustomerNumber -> SoldToNumber
                       VA frm_BSN_SHAN_ShipToNumber -> ShipToNumber
                       VA frm_BSN_TRDJ_OrderDate -> OrderDate
                       VA frm_BSN_DATE01_ActualShipDate -> ShipDate
                       VA frm_BSN_LOCN_Location -> Location
                       VA frm_BSN_LOTN_LotNumber -> Lot
                       "S" -> ProcessingMode
0023             End If
0024             If VA frm_BSN_SRNR_SerialNumberReq is equal to "6"
                 And VA frm_BSN_SOQS_Ship_Qty is greater than <Zero>
                 And VA frm_BSN_NXT2_NextStatus is not equal to "999"
0025                // SAR # 7484061 - Rehook of N1700050 to C BSFN N1700056
0026 !                F17001 Check For S/WM
     !                   VA evt_cCSMSInstalled <- cCSMSInstalled
     !                   UNDEFINED X cMessageCenterInterface
     !                   UNDEFINED X cDynamicWordRebuild
     !                   UNDEFINED X cWhosWhoRequired
     !                   UNDEFINED X cLogStatusChange
     !                   UNDEFINED X szCallQueueSearchType
     !                   UNDEFINED X mnLineNumber
     !                   UNDEFINED X cWhosWhoRequiredServOrder
     !                   UNDEFINED X szSOQueueSearchType
     !                   UNDEFINED X cValidateFamilyModel
     !                   UNDEFINED X cRespBULocationCalls
     !                   UNDEFINED X cRespBULocationService
     !                   UNDEFINED X cDefaultTypeWOCalls
     !                   UNDEFINED X cChkPrevCustCallSOConstant
     !                   UNDEFINED X cChkPrevProdCallSOConstant
     !                   UNDEFINED X cUseTree
     !                   UNDEFINED X cUseWorkflow
     !                   UNDEFINED X mnAddressNumber1st
     !                   UNDEFINED X szMailBoxforCallEscal
     !                   UNDEFINED X mnQueueforSOEscal
     !                   UNDEFINED X szMailBoxforSOEscal
     !                   UNDEFINED X cPushSiteToContract
     !                   UNDEFINED X cPushInstDateToBWContract
     !                   UNDEFINED X cCallEntTrigger
     !                   UNDEFINED X cSOEntTrigger
     !                   UNDEFINED X mnCustNumBaseWarranties
     !                   UNDEFINED X szOrganizationTypeStructur
     !                   UNDEFINED X szErrorMessageID
     !                   UNDEFINED X cSuppressErrorMessage
     !                   UNDEFINED X cRespBULocationCntrcts
     !                   UNDEFINED X cHolidayCode
     !                   UNDEFINED X cEntitleBy
     !                   UNDEFINED X cPushInventoryToContract_YN06
     !                   UNDEFINED X cSymbolForAssetNumber_YN07
     !                   UNDEFINED X cSymbolForUnitNumber_YN08
     !                   UNDEFINED X cSymbolForSerialNumber_YN09
     !                   VA frm_cCreateNonSerialFromShip <- cCreateNonSerialFromShip
     !                   UNDEFINED X cRecognizeCredit_YN11
     !                   UNDEFINED X cFutureYN12
     !                   UNDEFINED X cFutureYN13
     !                   UNDEFINED X cFutureYN14
     !                   UNDEFINED X cFutureYN15
0027                F17001 Get Installed Flag
                       "1" -> cSuppressErrorMessage_SUPPS
                       VA evt_cCSMSInstalled <- cServiceWarrantyInstalled_CSFL
0028                // End SAR # 7484061
0029                If VA evt_cCSMSInstalled is equal to "1"
0030                   F4220 Non Serial Number Generation
                          VA frm_BSN_ITM_ShortItemNumber -> mnIdentifierShortItem
                          UNDEFINED X szIdentifier2ndItem
                          UNDEFINED X szIdentifier3rdItem
                          UNDEFINED X szDescriptionLine1
                          UNDEFINED X szDescriptionLine2
                          VA frm_BSN_MCU2_BranchPlant -> szCostCenter
                          VA frm_BSN_LOTN_LotNumber -> szLot
                          VA frm_BSN_LOCN_Location -> szLocation
                          VA frm_BSN_AN8_CustomerNumber -> mnAddressNumber
                          VA frm_BSN_SHAN_ShipToNumber -> mnAddressNumberShipTo
                          VA frm_BSN_KCO_OrderCompany -> szCompanyKeyOrderNo
                          VA frm_BSN_DOC_OrderNumber -> mnDocumentOrderInvoiceE
                          VA frm_BSN_DCT_OrderType -> szOrderType
                          UNDEFINED X szOrderSuffix
                          VA frm_BSN_LNID_LineNumber -> mnLineNumber
                          VA frm_BSN_TRDJ_OrderDate -> jdDateOrderedJulian
                          VA frm_BSN_DATE01_ActualShipDate -> jdDateShippedJulian
                          VA frm_BSN_SOQS_Ship_Qty -> mnUnitsQuantityShipped
                          VA frm_BSN_UOM_TransactionUoM -> szUnitOfMeasureAsInput
0031                End If
0032             End If
0033          End If
0034          //
0035          If PO szPackConfirm is equal to "1"
0036             Call( App:P4216 , Form: W4216A )
                    VA frm_BSN_DOC_OrderNumber -> mnDocumentOrderInvoiceE
                    VA frm_BSN_DCT_OrderType -> szOrderType
                    VA frm_BSN_KCO_OrderCompany -> szCompanyKeyOrderNo
                    VA frm_BSN_LNID_LineNumber -> mnLineNumber
                    VA frm_BSN_ShipmentNumber -> mnShipmentNumber
                    VA frm_BSN_AN8_CustomerNumber -> mnAddressNumberSoldTo
                    VA frm_BSN_SHAN_ShipToNumber -> mnAddressNumberShipTo
                    VA frm_BSN_ITM_ShortItemNumber -> mnIdentifierShortItem
                    VA frm_BSN_SOQS_Ship_Qty -> mnUnitsQuantityShipped
                    VA frm_BSN_UOM_TransactionUoM -> szUnitOfMeasureAsInput
                    VA frm_BSN_SRNR_SerialNumberReq -> cContainerSerialNumRequired
                    VA frm_BSN_MCU2_BranchPlant -> szF4211BranchPlant
                    GC Actual Ship Date -> jdActualDeliveryDate
                    PO szVersionconsolidated -> szVersion
0037          End If
0038          //
0039          Load Or Unload Ship Confirm Cache
                 VA frm_BSN_DOC_OrderNumber <- mnOrderNumber
                 VA frm_BSN_DCT_OrderType <- szOrderType
                 VA frm_BSN_KCO_OrderCompany <- szOrderCompany
                 VA frm_BSN_LNID_LineNumber <- mnLineNumber
                 UNDEFINED X mnReferenceLineNumber
                 VA frm_BSN_ITM_ShortItemNumber <- mnItemNumber
                 UNDEFINED X szLineType
                 UNDEFINED X mnQuantityOrdered
                 VA frm_BSN_SOQS_Ship_Qty <- mnQuantityShipped
                 UNDEFINED X mnQuantityBackordered
                 UNDEFINED X mnQuantityCanceled
                 VA frm_BSN_MCU2_BranchPlant <- szBranchPlant
                 VA frm_BSN_LOCN_Location <- szLocation
                 VA frm_BSN_LOTN_LotNumber <- szLot
                 UNDEFINED X cCommitmentFlag
                 UNDEFINED X cOtherQuantityFlag
                 UNDEFINED X szLastStatus
                 VA frm_BSN_NXT2_NextStatus <- szNextStatus
                 UNDEFINED X cOnHandFlag
                 VA frm_BSN_DATE01_ActualShipDate <- jdActualShipDate
                 UNDEFINED X cCostLevel
                 UNDEFINED X mnUnitCost
                 UNDEFINED X mnExtendedCost
                 UNDEFINED X mnForeignUnitCost
                 UNDEFINED X mnForeignExtendedCost
                 UNDEFINED X mnUnitPrice
                 UNDEFINED X mnExtendedAmount
                 UNDEFINED X mnForeignUnitPrice
                 UNDEFINED X mnForeignExtendedPrice
                 UNDEFINED X szContainerID
                 UNDEFINED X mnCarrierID
                 UNDEFINED X mnItemWeight
                 UNDEFINED X szWeightUOM
                 UNDEFINED X cApplyFreightFlag
                 UNDEFINED X mnCurrencyConverRate
                 UNDEFINED X cFreightCalculated
                 UNDEFINED X szFreightRateCode
                 UNDEFINED X cAllowPartialShipments
                 UNDEFINED X cSalesDetailBackorderFlag
                 UNDEFINED X szRelatedItemNumber
                 UNDEFINED X szSecondaryUOM
                 UNDEFINED X szPricingUOM
                 UNDEFINED X szVolumeUOM
                 UNDEFINED X cItemMasterBackorderFlag
                 UNDEFINED X cItemBalanceBackorderFlag
                 UNDEFINED X cPotencyControl
                 UNDEFINED X mnStandardPotency
                 UNDEFINED X cLotProcessingCode
                 UNDEFINED X cInventoryInterface
                 UNDEFINED X cEditsProcessedFlag
                 VA frm_BSN_EV15_EndOfCacheFlag <- cErrorCode
                 "1" -> cSuppressErrorMessage
                 VA frm_DTAI_Data_Item <- szErrorMessageID
                 UNDEFINED X mnCacheLineNumber
                 "I" -> cObsoleteCode
                 UNDEFINED X szCurrencyCode
                 VA frm_BSN_EV16_OpenCacheFlag <> cOpenCacheCursorFlag
                 UNDEFINED X cWriteLedgerFlag
                 UNDEFINED X mnConversionFactor
                 <Blank> -> cCallType
                 UNDEFINED X mnLastLineNumAssign
                 VA frm_Job_Number -> mnJobNumberA
                 VA frm_ComputerID -> szComputerID
                 VA frm_BSN_GENLNG_F42UI05CacheHdl <> idCacheCursor
                 UNDEFINED X cBatchInteractiveFlag
                 UNDEFINED X mnX4111Z1CacheLineNum
                 UNDEFINED X mnB4200310CacheLineNum
                 UNDEFINED X cRecordWrittenToWFB4200310
                 UNDEFINED X cSODetailActionCode
                 UNDEFINED X mnActualShipTime
                 UNDEFINED X jdActualDeliveryDate
                 UNDEFINED X cInventoryAffectFlag
                 VA frm_BSN_ShipmentNumber <- mnShipmentNumber
                 UNDEFINED X mnAmbientVolume
                 UNDEFINED X szAmbientVolumeUOM
                 UNDEFINED X mnStandardVolume
                 UNDEFINED X szStandardVolumeUOM
                 UNDEFINED X mnWeightQuantity
                 UNDEFINED X szWeightQuantityUOM
                 UNDEFINED X mnTemperature
                 UNDEFINED X cTemperatureType
                 UNDEFINED X mnDensity
                 UNDEFINED X cDensityType
                 UNDEFINED X mnDensityTemperature
                 UNDEFINED X cDensityTemperatureType
                 UNDEFINED X mnTransactionTime
                 UNDEFINED X szBranchComponent
                 UNDEFINED X mnLineNumberKitMaster
                 UNDEFINED X mnComponentNumber
                 UNDEFINED X mnRelatedKitComponent
                 UNDEFINED X mnNumbOfCpntPerParent
                 UNDEFINED X cOHInventoryRelievedFlag
                 UNDEFINED X mnVolumeCorrectionFactors
                 UNDEFINED X szMemoLotField1
                 UNDEFINED X szMemoLotField2
                 UNDEFINED X szVendorLotNumber
                 UNDEFINED X mnOriginalLineNumber
                 UNDEFINED X cValidateStatusCode
                 VA frm_BSN_SRNR_SerialNumberReq <- cSerialNumberRequired
                 VA frm_BSN_UOM_TransactionUoM <- szUnitOfMeasureAsInput
                 UNDEFINED X cPlanTimeFenceRule
                 UNDEFINED X mnQtyCountedInPrimary
                 UNDEFINED X mnAmountUnitVolume
                 UNDEFINED X mnUnitsSecondaryQtyOr
                 "2" -> mnNumberKeys
                 "6" -> szCacheActionCode
                 VA frm_BSN_AN8_CustomerNumber <- mnAddressNumber
                 VA frm_BSN_SHAN_ShipToNumber <- mnAddressNumberShipTo
                 VA frm_BSN_TRDJ_OrderDate X jdDateTransactionJulian
                 UNDEFINED X mnExtendedCostTransfer
                 UNDEFINED X cInterbranchSalesFlag
                 UNDEFINED X szNextStatusCodeSplit
                 UNDEFINED X szSellingCompanyCurrecyCode
                 UNDEFINED X mnContractSupplementDistri
                 UNDEFINED X szContractNumberDistributi
                 UNDEFINED X szPrimaryVehicleId
                 UNDEFINED X szRegistrationLicenseNumbe
                 UNDEFINED X szUpdateSalesAgreement
                 UNDEFINED X jdLoadConfirmDate
                 UNDEFINED X mnTimeLoad
                 UNDEFINED X cBulkPackedFlag
                 UNDEFINED X szAGREE_ProductSource
                 UNDEFINED X szAGREE_ProductSourceType
                 UNDEFINED X mnAGREE_SequenceNumber1
                 UNDEFINED X cShipDateOverridden
                 UNDEFINED X szModeOfTransport
                 UNDEFINED X szPurchasingReportCode1
                 UNDEFINED X szTranOverride_NXTR
                 UNDEFINED X cDualUnitOfMeasureItem
                 UNDEFINED X cDualPickingProcessOption
                 UNDEFINED X mnConversionFactorTrantoSecnd
                 UNDEFINED X mnConvFactorSecondarytoTrans
                 UNDEFINED X mnConvFactorScndrytoScndPrime
                 UNDEFINED X mnOrderQuantityinSecondaryUOM
                 UNDEFINED X cCheckExpirationDate
                 UNDEFINED X cCheckSellByDate
                 UNDEFINED X cCheckBestBeforeDate
                 UNDEFINED X jdBestBeforeDate
                 UNDEFINED X jdSellByDate
                 UNDEFINED X cPrefLotBasedOnDates
                 UNDEFINED X jdDateLotExpiration
                 UNDEFINED X cCommitmentDateMethod
                 UNDEFINED X szLineTypeTable_LNTY
                 UNDEFINED X mnOrderQtyTable_UORG
                 UNDEFINED X mnShipQtyTable_SOQS
                 UNDEFINED X mnBackorderQtyTable_SOBK
                 UNDEFINED X mnCancelQtyTable_SOCN
                 UNDEFINED X szBranchPlantTable_MCU
                 UNDEFINED X szLocationTable_LOCN
                 UNDEFINED X szLotNumberTable_LOTN
                 UNDEFINED X cCommitFlagTable_COMM
                 UNDEFINED X szNextStatusTable_NXTR
                 UNDEFINED X cOnHandFlagF4211_SO02
                 UNDEFINED X mnUnitCostTable_UNCS
                 UNDEFINED X mnCostExtendedTable_ECST
                 UNDEFINED X mnForeignUnitCostTable_FUC
                 UNDEFINED X mnForeignExtCostTable_FEC
                 UNDEFINED X mnExtendedPriceTable_AEXP
                 UNDEFINED X mnForeignExtPriceTable_FAP
                 UNDEFINED X szContainerIDTable_CNID
                 UNDEFINED X mnCarrierTable_CARS
                 UNDEFINED X mnItemWeightTable_ITWT
                 UNDEFINED X szCurrencyCodeTable_CRCD
                 UNDEFINED X szPrimaryUoMTable_UOM1
                 UNDEFINED X jdSchedPickDateTable_PDDJ
                 UNDEFINED X szItemNumber2nd_LITM
                 UNDEFINED X szItemNumber3rd_AITM
                 UNDEFINED X szCompany_Table_CO
                 UNDEFINED X mnPickSlipNumbTable_PSN
                 UNDEFINED X mnItemVolumeTable_ITVL
                 UNDEFINED X cCostOverrideFlagTable_CSTO
                 UNDEFINED X mnPrimaryOrderQtyTable_PQOR
                 UNDEFINED X mnSecondOrderQtyTable_SQOR
                 UNDEFINED X jdDateRequestedTable_DRQJ
                 UNDEFINED X jdDateReleaseTable_RSDJ
                 UNDEFINED X szSalesAgreementNumb_DMCT
                 UNDEFINED X mnSalesAgreementSupp_DMCS
                 UNDEFINED X cUpdateGLAccommodations_UPGL
                 UNDEFINED X mnConvFactPricToPrim_CNV1
                 UNDEFINED X szStandardUOMConversion_TFLA
                 UNDEFINED X cWarehouseOnFlag_WCTL
                 UNDEFINED X cTextLineYN
                 UNDEFINED X jdShipDateF4211Table_ADDJ
                 UNDEFINED X szPortOfEntryExit
                 UNDEFINED X cFutureUseChar01
                 UNDEFINED X cFutureUseChar02
                 UNDEFINED X cFutureUseChar03
                 UNDEFINED X cFutureUseChar04
                 UNDEFINED X cFutureUseChar05
                 UNDEFINED X cFutureUseChar06
                 UNDEFINED X szFutureUseString01
                 UNDEFINED X szFutureUseString02
                 UNDEFINED X szFutureUseString03
                 UNDEFINED X szFutureUseString04
                 UNDEFINED X szFutureUseString05
                 UNDEFINED X szFutureUseString06
                 UNDEFINED X mnFutureUseMathNum01
                 UNDEFINED X mnFutureUseMathNum02
                 UNDEFINED X mnFutureUseMathNum03
                 UNDEFINED X jdFutureUseDate01
                 UNDEFINED X jdFutureUseDate02
                 UNDEFINED X jdDatePromisedPickTable
                 UNDEFINED X szFreightHandlingCodeTable
                 UNDEFINED X szSecondaryPrimaryUOM
                 UNDEFINED X mnActualShipTimeP4205Cache
                 UNDEFINED X mnActualShipTimeTable
                 UNDEFINED X mnRequestedDeliveryTime
                 UNDEFINED X mnPromisedShipmentTime
                 UNDEFINED X mnPromisedDeliveryTime
                 UNDEFINED X cCacheIndex
                 UNDEFINED X cPriceatAmbiantorStandard
0040       End While
0041       //
0042       // If there is a F41021WF UKID cache record, then use the UKID in that cache.
0043       // If there isn't a F41201WF UKID cache then get a UKID from the F00022 and
0044       // write the cache.
0045       Cache Process Unique F41021WF
              VA frm_Job_Number -> mnJobnumber
              VA frm_ComputerID -> szComputerID
              VA frm_mnUniqueKeyIDF41021WF_UKID <- mnUniqueKeyIDInternal
              "1" -> szCacheActionCode
              "2" -> mnNumberKeys
              "1" -> cSuppressErrorMessage
              VA evt_szUKIDError_DTAI <- szErrorMessageID
0046       If VA evt_szUKIDError_DTAI is not equal to <Blank> And VA evt_szUKIDError_DTAI is not equal to <Null>
0047          Get Next Unique Key ID
                 "F41021WF" -> szObjectName
                 VA frm_mnUniqueKeyIDF41021WF_UKID <- mnUniqueKeyID
0048          Cache Process Unique F41021WF
                 VA frm_Job_Number -> mnJobnumber
                 VA frm_ComputerID -> szComputerID
                 VA frm_mnUniqueKeyIDF41021WF_UKID -> mnUniqueKeyIDInternal
                 "7" -> szCacheActionCode
                 "3" -> mnNumberKeys
                 "1" -> cSuppressErrorMessage
0049       End If
0050       //
0051       //  Call End Doc to update the transactions to the appropriate tables.
0052       //
0053       If FI cTRAN_SyncrhonousEndDoc is not equal to "1"
0054          // Normal call to MBF EndDoc - Asynchronous
0055          Shipment Confirmation End Document
                 VA frm_Job_Number -> mnJobNumber
                 VA frm_ComputerID -> szComputerId
                 VA frm_UserID -> szUserId
                 VA frm_VersionName -> szR42565Version
                 FI cTRAN_SyncrhonousEndDoc -> cTRANSyncEndDoc
                 FI mnTRAN_TransportationJobNumber -> mTRANJobsNumber
                 VA frm_VersionName <> szP4205Version
                 FI idXAPIWorkflowErrorID <> idXAPIWorkflowErrorID
                 FI szCartonNextStatus <> szCartonNextStatus
                 FI szP4210VersionCartonQtyBased <> szP4210VersionCartonQtyBased
                 FI szP4210VersionItemQtyBasedInv <> szP4210VersionItemQtyBasedInv
                 FI szP4210VersionItemQtyBasedChrg <> szP4210VersionItemQtyBasedChrg
                 FI cCreateSalesOrderCartonCharge <> cCreateSalesOrderCartonCharge
0056       Else
0057          // Transportation Request to call MBF EndDoc in Synchronous Mode.
0058          Shipment Confirmation End Document
                 VA frm_Job_Number -> mnJobNumber
                 VA frm_ComputerID -> szComputerId
                 VA frm_UserID -> szUserId
                 VA frm_VersionName -> szR42565Version
                 FI cTRAN_SyncrhonousEndDoc -> cTRANSyncEndDoc
                 FI mnTRAN_TransportationJobNumber -> mTRANJobsNumber
                 VA frm_VersionName -> szP4205Version
0059       End If
0060    End If
0061    //
0062    //     If specified in PO to allow additional line entries, call the additional
0063    //     line entry window.
0064    //
0065    If PO szAllowAddLineEntry is equal to "1"
0066       // Write Additional Lines with Default Ship Date as Ship Date
0067       Call( App:P4205 , Form: W4205D )
              GC Order Number -> DocumentOrderInvoiceE
              GC Or Ty -> OrderType
              GC Order Co -> CompanyKeyOrderNo
              VA frm_Default_CarrierNumber -> Carrier
              VA frm_Default_ShipDate -> Actualdeliverydate
              VA frm_Default_ContainerID -> szContainer_ID_F4211
              FC Shipment Number -> mnShipmentNumber
              VA frm_mnDefaultShipTime_TME0 -> mnActualShipTime
0068    End If
0069 End If
0070 //
0071 // Moved removal of Record Reservation records from End Dialog to here and in
0072 // the cancel button.  A unique ID is now used rather than the program ID
0073 // (P4205).  The records will only be deleted after End Doc successfully
0074 // completes as both the End Doc and Remove Record Reservation calls are made
0075 // Asynch (Transprotation runs synch so no issue for it) and the Asynch thread
0076 // will process them in order.
0077 F00095 Remove Business Object Reservation
        VA frm_UserID -> szUserId
        "F4211" -> szNameObject
        <Blank> -> szGenericKey
        VA frm_szUniqueIDRecReserve_PID -> szApplication
0078 //

=======================================================================
     CONTROL:  HYPITEM &Cancel
     EVENT:  Button Clicked
-----------------------------------------------------------------------
     evt_P4312_POJobNumber
     evt_P4312_InvJobNumber
     evt_P4312_GLJobNumber
     evt_P4312_LCJobNumber
     evt_P4312_BatchNumber
     evt_P4312_OrderNumber
     evt_P4312_OrderType
     evt_P4312_OrderCompany
     evt_P4312_OrderSuffix
     evt_P4312Version
     evt_P4312_BatchType
0001 VA frm_CancelForm = "Y"
0002 F38010 Delete Agreement Cache
        VA frm_Job_Number -> mnJobnumberA
        VA frm_ComputerID -> szComputerID
        "7" -> cModeProcessing
0003 //
0004 //
0005 F42UI05 Delete Cache
        VA frm_Job_Number <> mnJobNumber
        VA frm_ComputerID -> szComputerId
        UNDEFINED X mnLineNumberFrom
        UNDEFINED X mnLineNumberThru
        <Blank> -> cModeofCommitmentClear
        "EP4205" -> szProgramId
0006 FI cCancelButtonClicked_EV01 = "Y"
0007 // ***************************************************************************
0008 // IN-TRANSIT ACCOUNTING     SAR 7445361
0009 // ***************************************************************************
0010 Intransit Accounting Cache
        VA frm_Job_Number -> mnJobNumber
        VA frm_ComputerID -> szComputerID
        "R" -> cActionCode
        VA evt_P4312Version <- szP4312Version
        VA evt_P4312_POJobNumber <- mnPOJobNumber
        VA evt_P4312_InvJobNumber <- mnInvJobNumber
        VA evt_P4312_GLJobNumber <- mnGLJobNumber
        VA evt_P4312_LCJobNumber <- mnLCJobNumber
        VA evt_P4312_BatchNumber <- mnBatchNumber
        VA evt_P4312_BatchType <- szBatchType
        VA evt_P4312_OrderNumber <- mnOrderNumber
        VA evt_P4312_OrderType <- szOrderType
        VA evt_P4312_OrderCompany <- szOrderCompany
        VA evt_P4312_OrderSuffix <- szOrderSuffix
0011 If VA evt_P4312_POJobNumber is greater than <Zero>
0012    F43121 Delete Work File
           VA frm_ComputerID -> szComputerID
           VA evt_P4312_POJobNumber -> mnJobNumber
           VA evt_P4312_OrderNumber -> mnOrderNumber
           VA evt_P4312_OrderType -> szOrderType
           VA evt_P4312_OrderCompany -> szOrderCompany
           VA evt_P4312_OrderSuffix -> szOrderSuffix
           VA evt_P4312Version -> szPOVersion
           VA evt_P4312_LCJobNumber -> mnLandedCostJobNumber
           VA evt_P4312_InvJobNumber -> mnF4111JobNumber
           VA evt_P4312_GLJobNumber -> mnF0911JobNumber
0013    F0011 Close Batch
           VA evt_P4312_BatchNumber -> mnBatchnumber
           VA evt_P4312_BatchType -> szBatchtype
           <Blank> -> cChangeBatchStatus
           "A" -> cOverrideMode
0014 End If
0015 Intransit Accounting Cache Terminate
        VA frm_Job_Number -> mnJobNumber
        VA frm_ComputerID -> szComputerID
0016 // ***************************************************************************
0017 //
0018 // Moved removal of Record Reservation records from End Dialog to here and in
0019 // the OK button.  A unique ID is now used rather than the program ID (P4205).
0020 //  The records will only be deleted if the cancel button is clicked.
0021 F00095 Remove Business Object Reservation
        VA frm_UserID -> szUserId
        "F4211" -> szNameObject
        <Blank> -> szGenericKey
        VA frm_szUniqueIDRecReserve_PID -> szApplication
0022 //

=======================================================================
     CONTROL:  HYPITEM Line &Defaults
     EVENT:  Button Clicked
-----------------------------------------------------------------------
     evt_Save_Default_ShipDate
     evt_MaxGridRowCount
     evt_InputGridRow
     evt_mnSVDefaultShipTime_TME0
     evt_cShipTimeChanged_EV01
0001 VA evt_Save_Default_ShipDate = VA frm_Default_ShipDate
0002 VA evt_mnSVDefaultShipTime_TME0 = VA frm_mnDefaultShipTime_TME0
0003 //
0004 // SAR 3027516 - 06/22/99 RM5906864 - Save off Container and Carrier ID
0005 // so they can be compared to to see if they have changed.  If they have
0006 // the values will default into the detail lines.
0007 //
0008 VA frm_szSave_DefContainer_CNID = VA frm_Default_ContainerID
0009 VA frm_mnSave_DefCarrier_CARS = VA frm_Default_CarrierNumber
0010 //
0011 // End SAR 3027516
0012 //
0013 Call( App:P4205 , Form: W4205B )
        VA frm_Default_CarrierNumber <> Carrier
        VA frm_Default_ContainerID <> Containerid
        VA frm_Default_ShipDate <> Actualdeliverydate
        FI mnTRAN_TransportationJobNumber -> mnTRAN_JobnumberA
        VA frm_mnDefaultShipTime_TME0 <> mnActualShipTime
0014 //
0015 // =======================================================================
0016 // Demand Scheduling - Times - Shipment Confirmation
0017 // If demand scheduling is ON and ship time has changed set flag to change
0018 // grid rows.
0019 // =======================================================================
0020 If VA frm_cDemandSchedReleased_DSRFU is equal to "1"
0021    If VA evt_mnSVDefaultShipTime_TME0 is not equal to VA frm_mnDefaultShipTime_TME0
0022       VA evt_cShipTimeChanged_EV01 = "1"
0023    End If
0024 End If
0025 //
0026 // if Actual Ship Date default is not equal to previous value, change all grid
0027 // rows having the previous value to the new value.
0028 //
0029 // SAR 3027516 - 06/22/99 RM5906864 - If container ID and Carrier ID have
0030 // changed, the values will default into the detail lines.
0031 // Added two OR statements to current IF to accomplish this
0032 //
0033 If VA frm_Default_ShipDate is not equal to VA evt_Save_Default_ShipDate Or VA frm_Default_CarrierNumber is not equal to VA frm_mnSave_DefCarrier_CARS Or VA frm_Default_ContainerID is not equal to VA frm_szSave_DefContainer_CNID Or VA evt_cShipTimeChanged_EV01 is equal to "1"
0034    //
0035    // End SAR 3027516
0036    //
0037    Get Max Grid Rows(FC Grid, VA evt_MaxGridRowCount)
0038    VA evt_InputGridRow = 1
0039    //
0040    // BEGIN SAR  4710958    12/11/2000    MD5644340
0041    // Set GC Sel = 1 to '1' if any of the default values are NOT equal to their sav
0042    // values.
0043    //
0044    While VA evt_InputGridRow is less than or equal to VA evt_MaxGridRowCount
0045       Get Grid Row(FC Grid, VA evt_InputGridRow)
0046       GC Sel = 1 = "1"
0047       //
0048       // SAR 5559719 - only apply default if non-blank
0049       IfGC Actual ShipDateis equal toVA evt_Save_Default_ShipDateAndVA frm_Default_ShipDateis greater than<Null Date>
0050          // end SAR 5559719
0051          GC Actual ShipDate = VA frm_Default_ShipDate
0052          // SAR 5480007 - set change flag to invoke Edit Line and reset save values
0053          GC Actual ShipDate_SAVE = VA frm_Default_ShipDate
0054          GC RowChanged = "Y"
0055          // end SAR 5480007
0056       End If
0057       //
0058       // =======================================================================
0059       // Demand Scheduling - Times - Shipment Confirmation
0060       // Default ship time if greater than zero and changed.  The default ship time
0061       // will not overwrite a manually entered ship time from the user.
0062       // =======================================================================
0063       If VA evt_cShipTimeChanged_EV01 is equal to "1"
0064          If GC ActualShip Time is equal to VA evt_mnSVDefaultShipTime_TME0 And VA frm_mnDefaultShipTime_TME0 is greater than <Zero>
0065             // =============================================================
0066             // SAR 6621220 - Kits & Times
0067             // Do not update Actual Shipment Time for Kit/Configured Item Parent or
0068             // Component Lines.
0069             // =============================================================
0070             If GC Committed is equal to "K" Or GC Kit lnNumber is greater than <Zero>
0071                // Do not update Actual Shipment Time, this is a Kit/Configured Item Parent or
0072                // Component.
0073             Else
0074                GC ActualShip Time = VA frm_mnDefaultShipTime_TME0
0075                GC ActualShip Time - Save = GC ActualShip Time
0076                GC RowChanged = "Y"
0077             End If
0078          End If
0079       End If
0080       //
0081       //     SAR 4488120 - If carrier number is not the same as default carrier, then
0082       //     reassign the default carrier to the grid.
0083       // SAR 5559719 - only apply default if non-blank
0084       IfGC CarrierNumberis not equal toVA frm_Default_CarrierNumberAndVA frm_Default_CarrierNumberis greater than<Zero>
0085          // end SAR 5559719
0086          GC CarrierNumber = VA frm_Default_CarrierNumber
0087          GC CarrierNumberSAVE = GC CarrierNumber
0088          GC RowChanged = "Y"
0089       End If
0090       //
0091       //     SAR 4496816 - If container ID is not the same as default container, then
0092       //     reassign the default container ID to the grid.
0093       // SAR 5559719 - only apply default if non-blank
0094       IfGC ContainerI.D.is not equal toVA frm_Default_ContainerIDAndVA frm_Default_ContainerIDis greater than<Blank>
0095          // end SAR 5559719
0096          GC ContainerI.D. = VA frm_Default_ContainerID
0097          GC ContainerI.D._SAVE = GC ContainerI.D.
0098          GC RowChanged = "Y"
0099       End If
0100       VA evt_InputGridRow = [VA evt_InputGridRow]+1
0101    End While
0102 End If

=======================================================================
     CONTROL:  HYPITEM &Insert Line
     EVENT:  Button Clicked
-----------------------------------------------------------------------
0001 Clear Grid Buffer(FC Grid)
0002 Get Selected Grid Row Number(FC Grid, VA frm_GridRowNumber)
0003 VA frm_GridRowNumber = [VA frm_GridRowNumber]+.01
0004 GB TransactionTime - Bulk = GC TransactionTime - Bulk
0005 GB OrTy = GC OrTy
0006 GB OrderNumber = GC OrderNumber
0007 GB LastStat = GC LastStat
0008 GB NextStat = GC NextStat
0009 GB Ship ToNumber = GC Ship ToNumber
0010 GB Branch/Plant = GC Branch/Plant
0011 GB LineNumber = VA frm_GridRowNumber
0012 Insert Grid Buffer Row(FC Grid, <After Current Row>, <Yes>, <No>, <Yes>, <Yes>,  <No>)
0013 Clear Grid Buffer(FC Grid)
0014 GC AC = "A"
0015 GC Sel = 1 = "1"
0016 //

-----------------------------------------------------------------------
     EVENT:  Post Button Clicked
-----------------------------------------------------------------------
0001 // DISABLE COLUMNS THAT DO NOT APPLY TO ADDITIONAL LINE ITEMS
0002 Disable Grid(FC Grid, VA frm_GridRowNumber, GC Vol CorFactor)
0003 Disable Grid(FC Grid, VA frm_GridRowNumber, GC AmbientVolume)
0004 Disable Grid(FC Grid, VA frm_GridRowNumber, GC Ambient Volume UOM)
0005 Disable Grid(FC Grid, VA frm_GridRowNumber, GC StandardVolume)
0006 Disable Grid(FC Grid, VA frm_GridRowNumber, GC StandardVolume UOM)
0007 Disable Grid(FC Grid, VA frm_GridRowNumber, GC WeightQuantity)
0008 Disable Grid(FC Grid, VA frm_GridRowNumber, GC Weight Qty UOM)
0009 Disable Grid(FC Grid, VA frm_GridRowNumber, GC Temperature)
0010 Disable Grid(FC Grid, VA frm_GridRowNumber, GC TempType)
0011 Disable Grid(FC Grid, VA frm_GridRowNumber, GC DisplayDensity)
0012 Disable Grid(FC Grid, VA frm_GridRowNumber, GC DensityType)
0013 Disable Grid(FC Grid, VA frm_GridRowNumber, GC DensityTemp)
0014 Disable Grid(FC Grid, VA frm_GridRowNumber, GC Density Temp Type)
0015 Disable Grid(FC Grid, VA frm_GridRowNumber, GC TransactionTime - Bulk)
0016 Disable Grid(FC Grid, VA frm_GridRowNumber, GC Location)

=======================================================================
     CONTROL:  HYPITEM &Select Lines
     EVENT:  Button Clicked
-----------------------------------------------------------------------
     OPT: Repeat ER for Event
0001 //
0002 //     When the confirm button is pressed, load '1'  to grid line.  Only the
0003 //     grid lines that have a '*' on the option field (EV01) will be processed
0004 //     for shipment confirmation
0005 //
0006 // Do not reset the GC Sel = 1 control for any row previously processed by
0007 // Multi Location Selection
0008 //
0009 If GC AC is not equal to "P"
     And GC AC is not equal to "S"
0010    If GC Sel = 1 is equal to "1"
0011       GC Sel = 1 = ""
0012    Else
0013       If VA grd_cGridRecordDisabled_EV01 is not equal to "1"
0014          GC Sel = 1 = "1"
0015       End If
0016    End If
0017 End If

=======================================================================
     CONTROL:  HYPITEM Test Results
     EVENT:  Button Clicked
-----------------------------------------------------------------------
     evt_BranchPlantExistance
0001 //
0002 //
0003 // If Test Results Version is blank, use ZJDE0001.
0004 If PO szTestResultsVersion is equal to <Blank>
     Or PO szTestResultsVersion is equal to <Null>
0005    PO szTestResultsVersion = "ZJDE0001"
0006 End If
0007 // If System 37 is installed, Quality Management, call Test Results.
0008 //
0009 If VA frm_ModularExistanceSYS37 is equal to "1"
0010    Quality Management Test Result Driver
           "N" -> cPreferenceCheckYN
           GC Order Number -> mnOrderNumber
           GC Or Ty -> szOrderType
           GC Order Co -> szKeyCompanyOrderNo
           GC Line Number -> mnLineID
           GC Branch/ Plant -> szBranchPlant
           GC Short Item No -> mnShortItem
           GC Lot/Serial <> szLotNumber
           GC Location (DB Format) [HIDDEN] <> szLocation
           "SO" -> szQualityApplicationCode
           GC Address Number [HIDDEN] -> mnAddressNumber
           GC Ship To Number -> mnAddressNumberShipTo
           GC Parent Number [HIDDEN] -> mnAddressNumberParent
           PO szTestResultsVersion -> szVersion
           GC Quantity Ordered [HIDDEN] -> mnOrderQuantity
           GC Request Date [HIDDEN] -> jdOrderDateRequestedJulian
           GC Actual Ship Date -> jdShipCompletionDate
0011    GC RowChanged = "Y"
0012 End If

=======================================================================
     CONTROL:  HYPITEM Agreements
     EVENT:  Button Clicked
-----------------------------------------------------------------------
0001 //
0002 // If agreement row exit is selected then call agreement selection window
0003 Call( App:P38200W , Form: W38200WB )
        VA frm_Job_Number -> mnJobnumberA
        VA frm_ComputerID -> szComputerID
        GC Agreement Number <- szAgreementNumber
        GC Supp No <- mnAgreementSupplement
        UNDEFINED X mnSequenceNumber
        GC Branch/ Plant -> szProductSource
        "CC" -> szProductSourceType
        GC Order Number -> mnOrderNumber
        GC Or Ty -> szOrderType
        GC Order Co -> szOrderCompany
        GC Line Number -> mnLineNumber
        "000" -> szOrderSuffix
        UNDEFINED X cUpdateGeneralLedger
        UNDEFINED X cPriceatAmbiantorStandard
        UNDEFINED X mnUnitPrice
        UNDEFINED X szAdjustmentSchedule
        UNDEFINED X mnPartner
        UNDEFINED X szUnitOfMeasureAsInput
        UNDEFINED X cAgreementType
        UNDEFINED X cCommingledOtherOwner
        UNDEFINED X mnForeignUnitPrice

=======================================================================
     CONTROL:  HYPITEM &Select Location
     EVENT:  Button Clicked
-----------------------------------------------------------------------
     evt_SOQS_MultiLocOverUnderQty
     evt_PreventNegOnHand_wf
     evt_LotProcessType
     evt_StockingType
     evt_SQOR_MultiLocDualOvrUndQty
     evt_SecondaryPrimaryUOM
     evt_DualPickingProcessOption
     evt_ConvFactorTranstoSecondary
     evt_TransactionPrimaryUOM
     evt_ConvFactorTranstoPrimary
     evt_ItemMasterExists
     evt_StandardUOMConversion
     evt_SecondaryQtyinTransUOM
     evt_ConvFactorSecondarytoTrans
     evt_DecimalsforRounding_SQOR
     evt_IsRegCreditOrderFlag_EV01
0001 //
0002 // Need to clear all current grid row errors since the tool will run the row
0003 // is exited and changed event(s) before button clicked event.
0004 Clear Grid Cell Error(FC Grid,  <Currently Selected Row>,  <All Columns>)
0005 //
0006 // assign Job Number for Multi location processing in value is zero
0007 //
0008 If VA frm_MultiLocationJobnumber is less than or equal to <Zero>
0009    Get Internal Next NUmber
           VA frm_MultiLocationJobnumber <- mnJobnumberA
0010 End If
0011 //
0012 VA frm_BulkPackedFlag_Save = GC BulkFlag
0013 //
0014 //  If this line is not  a Kit Item, and has not already been split.....
0015 //
0016 // Change logic to allow Configured Item Parents to be processed,
0017 // and set a flag indicating if the line being processed is part of a
0018 // configuration.
0019 //
0020 VA frm_ConfiguredItemFlag = "0"
0021 VA frm_KitParentFlag = "0"
0022 //
0023 If GC Committed is equal to "K"
     Or GC Committed is equal to "H"
0024    F4102 Get Item Manufacturing Information
           GC Branch/ Plant -> szBranch
           GC Short Item No -> mnShortItemNumber
           VA evt_StockingType <- cStockingType
           UNDEFINED X cIssueTypeCode
           UNDEFINED X cPlanningCode
           UNDEFINED X mnPlanningFence
           UNDEFINED X mnFreezeFence
           UNDEFINED X mnMessageDisplayFence
           UNDEFINED X mnTimeFence
           UNDEFINED X cPlanningFenceRule
           UNDEFINED X cFixedVariableLeadtime
           UNDEFINED X mnLeadtimeLevel
           UNDEFINED X mnLeadtimeMfg
           UNDEFINED X mnLeadtimeCumulative
           UNDEFINED X mnLeadtimePerUnit
           UNDEFINED X mnMFGLeadtimeQty
           UNDEFINED X mnShrinkFactor
           UNDEFINED X cShrinkFactorMethod
           UNDEFINED X cOrderPolicyCode
           UNDEFINED X mnOrderPolicyValue
           UNDEFINED X mnAccountingCostQuantity
           UNDEFINED X cTimeBasisCode
           UNDEFINED X mnMoveHours
           UNDEFINED X mnQueueHours
           UNDEFINED X mnStandardSetupHours
           UNDEFINED X cErrorIndicator
           UNDEFINED X mnPlannerNumber
           UNDEFINED X mnLowLevelCode
           UNDEFINED X cSuppressErrorMessage
           UNDEFINED X szErrorMessageID
           UNDEFINED X cNetChangeFlag
           UNDEFINED X idF4102Pointer
           UNDEFINED X szLineType
           UNDEFINED X mnSafetyStock
           UNDEFINED X cLotStatusCode
           UNDEFINED X cAbcCode
           UNDEFINED X cAllocateByLot
           UNDEFINED X szMasterPlanning
           UNDEFINED X mnBuyer
           UNDEFINED X cPotencyControl
           UNDEFINED X mnStandardPotency
           UNDEFINED X cLotExpDateCalcMeth
           UNDEFINED X cActiveIngredientFlag
           UNDEFINED X cCrossDockFlagYN
0025    If VA evt_StockingType is equal to "K"
        And GC Committed is equal to "K"
0026       VA frm_KitParentFlag = "1"
0027    Else
0028       If VA evt_StockingType is equal to "C"
0029          VA frm_ConfiguredItemFlag = "1"
0030       End If
0031    End If
0032 End If
0033 //
0034 If VA frm_KitParentFlag is not equal to "1"
     And GC EV04MultiLocation is not equal to "2"
     And GC EV04MultiLocation is not equal to "1"
     And VA frm_ConfiguredItemFlag is not equal to "1"
0035    //
0036    // end SAR3069003 change
0037    //
0038    GC RowChanged = "Y"
0039    GC Edit Mode = "2"
0040    //
0041 !    Press Button(FC EditLine)
0042    //
0043    // ********************************************
0044    // CALL SHIP CONFIRM MBF TO PERFORM EDITS.
0045    //
0046    // LINE WAS DESELECTED.  DO NOT SHIP CONFIRM.
0047    If VA frm_CancelForm is not equal to "Y"
0048       If GC Sel = 1 is not equal to "1"
           And GC RecordWritten is greater than <Zero>
0049          //   REMOVE RECORD FROM SHIP CONFIRM CACHE
0050          GC AC = "D"
0051          F42UI05 Edit Line
                 GC Error Code [HIDDEN] <- cErrorConditions
                 GC Record Written [HIDDEN] <> cRecordWritten
                 GC Order Number -> mnOrderNumber
                 GC Or Ty -> szOrderType
                 GC Order Co -> szOrderCompany
                 GC Line Number -> mnLineNumber
                 GC Branch/ Plant -> szBranchPlant
                 GC Location -> szLocation
                 GC Lot/Serial -> szLot
                 GC Quantity Shipped <> mnEnteredShipQuantity
                 GC Quantity Backordered -> mnEnteredBackorderQuantity
                 GC Quantity Canceled -> mnEnteredCancelQuantity
                 GC Ln Ty -> szEnteredLineType
                 GC Container I.D. -> szContainerID
                 GC Carrier Number -> mnCarrier
                 "EP4205" -> szProgramID
                 "1" -> cWriteIfWarning
                 GC Description -> szDescription
                 VA frm_Job_Number <> mnJobnumberA
                 VA frm_UserID -> szUserId
                 VA frm_VersionName -> szVersion
                 GC A C [HIDDEN] -> cActionCode
                 <Zero> -> cModeProcessing
                 GC Ambient Volume -> mnBULK_AmbientQtyEntered
                 GC Ambient  Volume UOM -> szBULK_AmbientQtyEnteredUOM
                 GC Standard Volume -> mnBULK_StandardQtyEntered
                 GC Standard Volume UOM -> szBULK_StandardQtyEnteredUOM
                 GC Weight Quantity -> mnBULK_WeightQtyEntered
                 GC Temperature -> mnBULK_Temperature
                 GC Temp Type -> cBULK_ProductTemperatureType
                 GC Display Density -> mnBULK_ProductDensity
                 GC Density Temp -> mnBULK_DensityTemperature
                 GC Density  Temp Type -> cBULK_DensityTemperatureType
                 GC Transaction Time - Bulk -> mnBULK_TransactionTime
                 GC Weight  Qty UOM -> szBULK_WeightQtyEnteredUOM
                 GC Density Type -> cBULK_ProductDensityType
                 GB Vol Cor Factor -> mnBulk_VolumeCorrectionFactors
                 GC Original OrderCo [HIDDEN] -> szOriginal_CompanyKeyOrderNo
                 GC Original OrderType [HIDDEN] -> szOriginal_OrderType2
                 GC Original OrderNum [HIDDEN] -> mnOriginal_OrderNumber
                 GC Original LineNum [HIDDEN] -> mnOriginal_LineNumber_3
                 GC XT4111 Line Number [HIDDEN] <> mnXT4111LineNumber
                 GC B4200310 Line Number [HIDDEN] <> mnB4200310LineNumber
                 GC Unit of Measure -> szUnitOfMeasureAsInput
                 GC Quantity Shipped - Ovr_Undr [HIDDEN] -> mnMultiLocQtyShipVariance
                 GC UORG - QtyOrdered-Parent [HIDDEN] -> mnMultiLocParentOrderQuantity
                 GC Ship To Number -> mnAddressNumberShipTo
                 GC Ln Ty -> szLineType_2
                 FI szTRAN_PrimaryVehicleId -> szTRAN_PrimaryVehicleId
                 FI szTRAN_RegistrationLicNumber -> szTRAN_RegistrationLicenseNum
                 VA frm_ComputerID -> szComputerID
                 GC Secondary Qty Shipped <> mnUnitsSecondaryQtyOr
                 GC Secondary UoM -> szUnitOfMeasureSecondary
                 GC Secondary Quantity - Over Under [HIDDEN] -> mnMultiLocSecondaryQtyShipVar
                 GC UORG - Qty Ordered - Dual [HIDDEN] -> mnMultiLocSecondaryOrderQty
0052          GC AC = "C"
0053          GC XT4111Line Number = ""
0054          GC PreviousSelect Value = ""
0055       Else
0056          //      ROW HAS CHANGED OR HAS BEEN SELECTED FOR SHIP CONFIRM
0057          If GC RowChanged is equal to "Y"
              Or GC Sel = 1 is equal to "1"
              And GC PreviousSelect Value is not equal to "1"
0058             //
0059             //  Default Ship Information
0060             //
0061             //     SET DEFAULT VALUES FROM SHIP CONFIRM DEFAULT SCREEN.
0062             //
0063             If GC Actual ShipDate is less than or equal to <Blank>
                 Or GC Actual ShipDate is not equal to GC Actual ShipDate_SAVE
0064                GC Actual ShipDate = VA frm_Default_ShipDate
0065                If VA frm_Default_ShipDate is not equal to VA frm_AuditInfoDate
                    And GC Actual ShipDate_SAVE is less than or equal to <Blank>
0066                   GC Actual ShipDate_SAVE = VA frm_Default_ShipDate
0067                End If
0068             End If
0069             //
0070             If GC CarrierNumber is less than or equal to <Zero>
0071                GC CarrierNumber = VA frm_Default_CarrierNumber
0072                GC CarrierNumberSAVE = VA frm_Default_CarrierNumber
0073             End If
0074             //
0075             If GC ContainerI.D. is less than or equal to <Blank>
0076                GC ContainerI.D. = VA frm_Default_ContainerID
0077                GC ContainerI.D._SAVE = VA frm_Default_ContainerID
0078             End If
0079             //
0080             // CALL SHIP CONFIRM EDITLINE
0081             F42UI05 Edit Line
                    GC Error Code [HIDDEN] <- cErrorConditions
                    GC Record Written [HIDDEN] <> cRecordWritten
                    GC Order Number -> mnOrderNumber
                    GC Or Ty -> szOrderType
                    GC Order Co -> szOrderCompany
                    GC Line Number -> mnLineNumber
                    GC Branch/ Plant -> szBranchPlant
                    GC Location -> szLocation
                    GC Lot/Serial -> szLot
                    GC Quantity Shipped -> mnEnteredShipQuantity
                    GC Quantity Backordered -> mnEnteredBackorderQuantity
                    GC Quantity Canceled -> mnEnteredCancelQuantity
                    GC Ln Ty -> szEnteredLineType
                    GC Container I.D. -> szContainerID
                    GC Carrier Number -> mnCarrier
                    GC Actual Ship Date -> jdActualDeliveryDate
                    "EP4205" -> szProgramID
                    "1" -> cWriteIfWarning
                    GC Description -> szDescription
                    VA frm_Job_Number <> mnJobnumberA
                    VA frm_UserID -> szUserId
                    VA frm_VersionName -> szVersion
                    GC A C [HIDDEN] -> cActionCode
                    GC Edit Mode [HIDDEN] -> cModeProcessing
                    FI jdTRAN_DELIVERY_DATE -> jdTRAN_DeliveryDate
                    FI cTRAN_InventoryAffectFlag -> cTRAN_InventoryAffectFlag
                    FI szTRAN_OverrideDocType -> szTRAN_OverrideDocumentType
                    FI szTRAN_OverrideNextStatusCode -> szTRAN_OverrideNextStatus
                    FI cTRAN_OverrideLeaveShippable -> cTRAN_OverrideLeaveShippable
                    GC Ambient Volume -> mnBULK_AmbientQtyEntered
                    GC Ambient  Volume UOM -> szBULK_AmbientQtyEnteredUOM
                    GC Standard Volume -> mnBULK_StandardQtyEntered
                    GC Standard Volume UOM -> szBULK_StandardQtyEnteredUOM
                    GC Weight Quantity -> mnBULK_WeightQtyEntered
                    GC Temperature -> mnBULK_Temperature
                    GC Temp Type -> cBULK_ProductTemperatureType
                    GC Display Density -> mnBULK_ProductDensity
                    GC Density Temp -> mnBULK_DensityTemperature
                    GC Density  Temp Type -> cBULK_DensityTemperatureType
                    GC Transaction Time - Bulk -> mnBULK_TransactionTime
                    GC Weight  Qty UOM -> szBULK_WeightQtyEnteredUOM
                    GC Density Type -> cBULK_ProductDensityType
                    GC Vol Cor Factor -> mnBulk_VolumeCorrectionFactors
                    GC Original OrderCo [HIDDEN] -> szOriginal_CompanyKeyOrderNo
                    GC Original OrderType [HIDDEN] -> szOriginal_OrderType2
                    GC Original OrderNum [HIDDEN] -> mnOriginal_OrderNumber
                    GC Original LineNum [HIDDEN] -> mnOriginal_LineNumber_3
                    GC Memo Lot 1 -> szMemoLotField1
                    GC Memo Lot 2 -> szMemoLotField2
                    GC Supplier Lot Number -> szVendorLotNumber
                    GC XT4111 Line Number [HIDDEN] <> mnXT4111LineNumber
                    GC B4200310 Line Number [HIDDEN] <> mnB4200310LineNumber
                    GC Unit of Measure -> szUnitOfMeasureAsInput
                    GC Quantity Shipped - Ovr_Undr [HIDDEN] -> mnMultiLocQtyShipVariance
                    GC UORG - QtyOrdered-Parent [HIDDEN] -> mnMultiLocParentOrderQuantity
                    GC Ship To Number -> mnAddressNumberShipTo
                    GC Ln Ty -> szLineType_2
                    FI szTRAN_PrimaryVehicleId -> szTRAN_PrimaryVehicleId
                    FI szTRAN_RegistrationLicNumber -> szTRAN_RegistrationLicenseNum
                    FI jdTRAN_DELIVERY_DATE -> jdTRAN_LoadConfirmDate
                    FI mnTRAN_TimeLoad_2 -> mnTRAN_TimeLoad
                    VA frm_ComputerID -> szComputerID
                    GC Secondary Qty Shipped -> mnUnitsSecondaryQtyOr
                    GC Secondary UoM -> szUnitOfMeasureSecondary
                    GC Secondary Quantity - Over Under [HIDDEN] -> mnMultiLocSecondaryQtyShipVar
                    GC UORG - Qty Ordered - Dual [HIDDEN] -> mnMultiLocSecondaryOrderQty
                    GC Check Exp. Date [HIDDEN] <> cCheckExpirationDate
                    GC Check Sell By Date [HIDDEN] <> cCheckSellByDate
                    GC Check Best Before Date [HIDDEN] <> cCheckBestBeforeDate
                    GC Based On Date [HIDDEN] <> jdBasedOnDate
                    GC Lot Effectivity Date <> jdLotEffectivityDate
                    GC Sell By Date [HIDDEN] <> jdSellByDate
                    GC Best Before Date [HIDDEN] <> jdBestBeforeDate
                    GC User Lot Date 1 [HIDDEN] <> jdUserLotDate1
                    GC User Lot Date 2 [HIDDEN] <> jdUserLotDate2
                    GC User Lot Date 3 [HIDDEN] <> jdUserLotDate3
                    GC User Lot Date 4 [HIDDEN] <> jdUserLotDate4
                    GC User Lot Date 5 [HIDDEN] <> jdUserLotDate5
                    GC Inventory Transaction Type [HIDDEN] <> mnInvTransactionType
                    GC Exit/ Entry -> szPortOfEntryExit
                    GC Actual Ship Time -> mnActualShipmentTime
0082             VA frm_RecordsInCache = "Y"
0083             //
0084             If GC Sel = 1 is not equal to "1"
0085                GC Sel = 1 = "1"
0086             End If
0087             If GC ErrorCode is equal to <Blank>
                 Or GC ErrorCode is equal to <Null>
0088                GC PreviousSelect Value = "1"
0089             Else
0090                GC PreviousSelect Value = "0"
0091             End If
0092             GC RowChanged = "N"
0093          End If
0094       End If
0095    End If
0096    GC Edit Mode = "1"
0097    //
0098    If GC ErrorCode is not equal to "2"
0099       // Selected line passed MBF Edits.  Continue with call to MultiLocation Screen.
0100       //
0101       VA frm_ERRC_GenericErrorCode = "1"
0102       VA frm_LNIX_RowNumberCounter = GC LNIX-LastAssignedNumber
0103       Get Selected Grid Row Number(FC Grid, VA frm_GridRowNumber)
0104       //
0105       // calculate Over/Under Quantity prior to calling Select Multi-Location:
0106       //   Over/Under Quantity = Quantity Shipped - Original Quantity Shipped +
0107       //                                      BackOrder Qty - Original BackOrder Qty +
0108       //                                      Canceled Qty - Original Canceled Qty
0109       //
0110       GC Quantity Shipped - Ovr_Undr = [GC QuantityShipped]-[GC Orig Quantity Shipped - Static]+[GC QuantityBackordered]+[GC QuantityCanceled]-[GC QuantityBackordered - Orig]-[GC QuantityCanceled - Orig]
0111       //
0112       // SAR 5028512 - if dual item, compute value of scondary over under
0113       //
0114       GC Secondary Quantity -Over Under = 0
0115       VA evt_SQOR_MultiLocDualOvrUndQty = 0
0116       //
0117       If GC DualItem is greater than <Blank>
0118          F4101 Get Item Master Information
                 GC Short Item No -> mnShortItemNumber
                 UNDEFINED X szPrimaryItemNumber
                 UNDEFINED X szSecondItemNumber
                 UNDEFINED X szThirdItemNumber
                 UNDEFINED X szDescription
                 UNDEFINED X szDescriptionLine2
                 UNDEFINED X szItemFlashMessage
                 VA evt_TransactionPrimaryUOM <- szPrimaryUOM
                 VA evt_SecondaryPrimaryUOM <- szSecondaryUOM
                 UNDEFINED X szPurchasingUOM
                 UNDEFINED X szPricingUOM
                 UNDEFINED X szShippingUOM
                 UNDEFINED X szWeightUOM
                 UNDEFINED X szVolumeUOM
                 UNDEFINED X cSuppressErrorMessage
                 UNDEFINED X szErrorMessageID
                 GC Branch/ Plant -> szBranchPlant
                 UNDEFINED X cBackOrdersAllowedYN
                 UNDEFINED X cStockingType
                 UNDEFINED X cBulkPackedFlag
                 UNDEFINED X cInventoryCostLevel
                 UNDEFINED X szLineType
                 UNDEFINED X cLotProcessType
                 UNDEFINED X mnShelfLifeDays
                 UNDEFINED X szGLClassCode
                 UNDEFINED X cContractItem
                 UNDEFINED X szProductionUOM
                 UNDEFINED X szFromGrade
                 UNDEFINED X szThruGrade
                 UNDEFINED X mnFromPotency
                 UNDEFINED X mnThruPotency
                 UNDEFINED X cPriceLevel
                 UNDEFINED X cGradePotencyPricing
                 UNDEFINED X cRoundToWholeNumber
                 UNDEFINED X cKitPricingMethod
                 UNDEFINED X szComponentUOM
                 VA evt_StandardUOMConversion <- szStandardUOMConversion
                 UNDEFINED X mnBuyer
                 UNDEFINED X mnPlannerNumber
                 UNDEFINED X szPrintMessage
                 UNDEFINED X cCommitmentMethod
                 UNDEFINED X cCheckAvailability
                 UNDEFINED X cSerialNumberReqsted
                 UNDEFINED X cLotStatusCode
                 UNDEFINED X cPurchasePriceLevel
                 UNDEFINED X szTemplate
                 UNDEFINED X szSegment1
                 UNDEFINED X szSegment2
                 UNDEFINED X szSegment3
                 UNDEFINED X szSegment4
                 UNDEFINED X szSegment5
                 UNDEFINED X szSegment6
                 UNDEFINED X szSegment7
                 UNDEFINED X szSegment8
                 UNDEFINED X szSegment9
                 UNDEFINED X szSegment10
                 UNDEFINED X cMatrixControlled
                 UNDEFINED X cDualUnitOfMeasureItem
                 VA evt_DualPickingProcessOption <- cDualPickingProcessOption
                 UNDEFINED X mnDualTolerance
0119          If VA evt_DualPickingProcessOption is equal to "1"
0120             If GC Unit ofMeasure is equal to VA evt_TransactionPrimaryUOM
0121                VA evt_ConvFactorTranstoPrimary = 1
0122             Else
0123                If VA evt_TransactionPrimaryUOM is greater than <Blank>
0124                   VA evt_ItemMasterExists = "1"
0125                End If
0126                F41002 Get Item UoM Conversion
                       GC Branch/ Plant -> szBranchPlant
                       GC Unit of Measure -> szFromUnitOfMeasure
                       VA evt_TransactionPrimaryUOM -> szToUnitOfMeasure
                       "1.00" -> mnQuantityToConvert
                       VA evt_ItemMasterExists -> cInventoryInterfaceFlag
                       VA evt_ConvFactorTranstoPrimary <- mnConversionFactorFromToPrim
                       UNDEFINED X mnConversionFactorFrom_to_To
                       UNDEFINED X mnConversionFactorTo_to_Primar
                       UNDEFINED X mnQuantityConvertedToPrimary
                       UNDEFINED X cConvertToSecondary
                       UNDEFINED X mnQuantityConvertedToSecondary
                       UNDEFINED X cConvertToPurchasing
                       UNDEFINED X mnQuantityConvertedToPurchasin
                       UNDEFINED X cConvertToPricing
                       UNDEFINED X mnQuantityConvertedToPricing
                       UNDEFINED X cConvertToShipping
                       UNDEFINED X mnQuantityConvertedToShipping
                       UNDEFINED X cConvertToWeight
                       UNDEFINED X mnQuantityConvertedToWeight
                       UNDEFINED X cConvertToVolume
                       UNDEFINED X mnQuantityConvertedToVolume
                       UNDEFINED X cPotencyMode
                       UNDEFINED X szLotNumber
                       UNDEFINED X cPotencyControl
                       UNDEFINED X mnStandardPotency
                       UNDEFINED X szErrorMessageID
                       UNDEFINED X cSuppressErrorMsg
                       UNDEFINED X cPotencyType
                       UNDEFINED X mnShortItemNumber
                       UNDEFINED X cUOMByBranch
                       UNDEFINED X szUOMToPrimary
                       UNDEFINED X szUOMToSecondary
                       UNDEFINED X szUOMToPurchasing
                       UNDEFINED X szUOMToPricing
                       UNDEFINED X szUOMToWeight
                       UNDEFINED X szUOMToVolume
                       UNDEFINED X szUOMToShipping
                       VA evt_StandardUOMConversion -> szStandardUOMConversion
                       UNDEFINED X mnQuantityConvertedFromtoTo
                       UNDEFINED X cExcludeFlag
0127             End If
0128             Compute Dual Unit of Measure Converion Factors
                    GC Unit of Measure -> szTransactionUnitOfMeasure
                    VA evt_TransactionPrimaryUOM -> szTransactionUOMPrimary
                    GC Secondary UoM -> szSecondaryUnitOfMeasure
                    VA evt_SecondaryPrimaryUOM -> szSecondaryUOMPrimary
                    VA evt_ConvFactorTranstoPrimary -> mnInputConvFactorTranstoPrim
                    VA evt_ConvFactorSecondarytoTrans <- mnConvFactorSecondarytoTrans
                    VA evt_ConvFactorTranstoSecondary <- mnConvFactorTranstoSecondary
                    UNDEFINED X mnConvFactorSecndtoScndPrime
                    GC Secondary Qty Shipped -> mnSecondaryShipQuantity
                    GC Branch/ Plant -> szBranchPlant
                    VA evt_ItemMasterExists -> cItemMasterExists
                    GC Short Item No -> mnIdentifierShortItem
                    VA evt_StandardUOMConversion -> szStandardUOMConversion
                    UNDEFINED X mnScndryPrimaryShipQuantity
                    VA evt_SecondaryQtyinTransUOM <- mnScndryShipQuantityinTransUOM
                    "1" -> cSuppressErrorMessage
                    UNDEFINED X szErrorMessageID
                    VA evt_DualPickingProcessOption -> cDualPickingProcessOption
                    VA evt_DecimalsforRounding_SQOR <- mnDecimalsforRounding_SQOR
                    UNDEFINED X mnDecimalsforRounding_SOQS
0129             // SAR 6482717 - Modify calculation to produce the secondary over-under
0130             // quantity in Secondary UOM.
0131             GC Secondary Quantity -Over Under = ([GC SecondaryQty Shipped]-[GC OriginalSecondary Quantity])+(((([GC QuantityBackordered]+[GC QuantityCanceled])-[GC QuantityBackordered - Orig])-[GC QuantityCanceled - Orig])*[VA evt_ConvFactorTranstoSecondary])
0132             // end SAR 6482717
0133             GC Secondary Quantity -Over Under = round([GC Secondary Quantity -Over Under],[VA evt_DecimalsforRounding_SQOR])
0134          End If
0135       End If
0136       // end SAR 5028512
0137       //
0138       // Form interconnect value PreventNegativeOnHand has been combined
0139       // with AllowPartialShipment and BackCancelRemainingQuantities to form a
0140       // combined value. AllowPartial and BackCancel are considered one option.
0141       // If both options are off, the cobined value is '0'. If both options are on, th
0142       // combined values are '1'. If only PreventNegOnHand is on, the value of the
0143       // passed parm is set to '2'. And if only AllowPartial is on, the passed parm is
0144       // set to '3'. The combining of parameters was performed to prevent the need
0145       // of an additional form interconnect variable that is specific to Sales.
0146       //
0147       If VA frm_PO_AutoBackCancel is not equal to "1"
           And GC Partial ShipmentAllowed is equal to "N"
0148          VA evt_PreventNegOnHand_wf = "0"
0149       Else
0150          VA evt_PreventNegOnHand_wf = "3"
0151       End If
0152       //
0153       If VA frm_PO_PreventNegOnHand is equal to "1"
0154          If VA evt_PreventNegOnHand_wf is equal to "3"
0155             VA evt_PreventNegOnHand_wf = "1"
0156          Else
0157             VA evt_PreventNegOnHand_wf = "2"
0158          End If
0159       End If
0160       //
0161       If GC Orig Quantity Shipped - Static is less than <Zero>
           And GC QuantityShipped is less than <Zero>
0162          VA evt_IsRegCreditOrderFlag_EV01 = "1"
0163       Else
0164          VA evt_IsRegCreditOrderFlag_EV01 = "0"
0165       End If
0166       //  Multiple Location Window (P42053).
0167       Call( App:P42053 , Form: W42053B )
              GC Short Item No -> IdentifierShortItem
              GC Branch/ Plant -> CostCenter
              GC Location -> Location
              GC Lot/Serial -> Lot
              UNDEFINED X Jobnumber
              GC Order Number -> Documentorderinvoicee
              GC Or Ty -> Ordertype
              GC Order Co -> Companykeyorderno
              GC LNID-F42UI05LineNumber [HIDDEN] -> Linenumber
              "000" -> Ordersuffix
              GC Quantity Shipped -> Unitsquantityshipped
              UNDEFINED X Fromgrade
              UNDEFINED X Thrugrade
              UNDEFINED X Frompotency
              UNDEFINED X Thrupotency
              GC Actual Ship Date -> Datetransactionjulian
              UNDEFINED X Promiseddeliverydate
              VA evt_SOQS_MultiLocOverUnderQty <- Quantityreworked
              "S" -> CallingApplication
              VA frm_PO_CheckAvailability -> AvailabilityCheckFlag
              VA frm_PO_PreventOverShip -> PreventOverShipment
              UNDEFINED X szMemoLotField1
              UNDEFINED X szMemoLotField2
              UNDEFINED X szMemoLotField3
              UNDEFINED X szVendorLotNumber
              VA evt_PreventNegOnHand_wf -> cPreventNegOnHand
              GC Unit of Measure -> szUnitOfMeasureAsInput
              UNDEFINED X cLotHoldCode1
              UNDEFINED X cLotHoldCode2
              UNDEFINED X cLotHoldCode3
              UNDEFINED X cLotHoldCode4
              UNDEFINED X cLotHoldCode5
              GC Secondary Qty Shipped -> mnUnitsSecondaryQtyOr
              GC Secondary UoM -> szUnitOfMeasureSecondary
              VA evt_SQOR_MultiLocDualOvrUndQty <- mnSecondaryQtyOverUnder
              GC Based On Date [HIDDEN] <> jdBasedOnDate
              GC Lot Effectivity Date <> jdLotEffectivityDate
              GC Lot Expiration Date <> jdDate - Lot Expiration
              VA frm_ShipAscendingDateActive -> cShipAscendingDateFlag
              PO cSADWarningError -> cPOErrorOrWarning
              GC Check Exp. Date [HIDDEN] <> cCheckExpirationDate
              GC Check Sell By Date [HIDDEN] <> cCheckSellByDate
              GC Check Best Before Date [HIDDEN] <> cCheckBestBeforeDate
              GC Ship To Number -> mnAddressNumberShipTo
              GC Sell By Date [HIDDEN] <> jdSellByDate
              GC Best Before Date [HIDDEN] <> jdBestBeforeDate
              GC User Lot Date 1 [HIDDEN] <> jdUserLotDate1
              GC User Lot Date 2 [HIDDEN] <> jdUserLotDate2
              GC User Lot Date 3 [HIDDEN] <> jdUserLotDate3
              GC User Lot Date 4 [HIDDEN] <> jdUserLotDate4
              GC User Lot Date 5 [HIDDEN] <> jdUserLotDate5
              UNDEFINED X cLotExpirationDateCalculat
              GC Inventory Transaction Type [HIDDEN] -> mnTransactionType
              PO cNewLotsForCO -> cAllowNewLotForCO
              VA evt_IsRegCreditOrderFlag_EV01 -> cIsThisCreditOrderY_N
0168       //
0169       // calculate value of Under/Over shipped
0170       //
0171       // add Over/Under Quantity from call to Select Multi-Location to existing amount
0172       //
0173       GC Quantity Shipped - Ovr_Undr = [GC Quantity Shipped - Ovr_Undr]+[VA evt_SOQS_MultiLocOverUnderQty]
0174       //
0175       // SAR 5028512 - if dual item, compute value of scondary over under
0176       // SAR 6482717 - Modify calculation to produce the secondary over-under
0177       // quantity in Secondary UOM.
0178       GC Secondary Quantity -Over Under = [GC Secondary Quantity -Over Under]+[VA evt_SQOR_MultiLocDualOvrUndQty]
0179       // end SAR 6482717
0180       // end SAR 5028512
0181       //
0182       VA frm_ERRC_GenericErrorCode = "0"
0183       Cache, Get Memory
              UNDEFINED X szItemNumber
              VA frm_MCU_szCacheBranch <- szBranchPlant
              VA frm_LOCN_szCacheLocation <- szLocation
              VA frm_LOTN_szCacheLotNumber <- szLotNumber
              UNDEFINED X szCatalogNumber
              UNDEFINED X mnSupplierNumber
              UNDEFINED X mnOrderNumber
              UNDEFINED X szKeyCompany
              UNDEFINED X szSuffixNumber
              UNDEFINED X mnOrderLineNumber
              VA frm_ERRC_GenericErrorCode <> cLastRecordReadFlag
              UNDEFINED X szDocumentType
              VA frm_UORG_mnTotalQty_Wrkfld <- mnQuantity
              UNDEFINED X szUnitOfMeasure
              <Blank> -> cSuppressTerminateCache
              UNDEFINED X mnUnitCost
              UNDEFINED X nSequenceNumber
              GC Memo Lot 1 <- szMemoLot1
              GC Memo Lot 2 <- szMemoLot2
              UNDEFINED X szMemoLot3
              VA frm_idCacheCursor_GENLNG <> idCacheCursor
              GC Supplier Lot Number <- szVendorLotNumber
              VA frm_MMEJ_jdLotExpiration <- jdDateLayerExpiration
              UNDEFINED X cLotStatusCode
              UNDEFINED X mnIdentifierShortItem
              UNDEFINED X mnQtyOnHandPrimaryUn
              UNDEFINED X mnLotPotency
              UNDEFINED X szLotGrade
              UNDEFINED X szDescriptionLine1
              UNDEFINED X cStockingType
              UNDEFINED X mnQuantityAvailable
              VA frm_SQOR_TotalQty_Wrkfld <- mnDualQuantity
              UNDEFINED X szUnitOfMeasureSecondary
              UNDEFINED X jdBasedOnDate
              UNDEFINED X jdLotEffectivityDate
              UNDEFINED X jdOnHandDate
              UNDEFINED X jdSellByDate
              UNDEFINED X jdBestBeforeDate
              UNDEFINED X jdUserLotDate1
              UNDEFINED X jdUserLotDate2
              UNDEFINED X jdUserLotDate3
              UNDEFINED X jdUserLotDate4
              UNDEFINED X jdUserLotDate5
              UNDEFINED X cBasePriceIndicator
              UNDEFINED X cAdjustmentIndicator
              UNDEFINED X mnAdjustmentRevisionLevel
              UNDEFINED X cPriceOverrideCode
0184       //
0185       // if returned Quantity is equal to zero, continue to read the cache until a
0186       // non-zero value is returned.
0187       //
0188       While VA frm_ERRC_GenericErrorCode is not equal to "1"
           And VA frm_UORG_mnTotalQty_Wrkfld is equal to <Zero>
0189          Cache, Get Memory
                 UNDEFINED X szItemNumber
                 VA frm_MCU_szCacheBranch <- szBranchPlant
                 VA frm_LOCN_szCacheLocation <- szLocation
                 VA frm_LOTN_szCacheLotNumber <- szLotNumber
                 UNDEFINED X szCatalogNumber
                 UNDEFINED X mnSupplierNumber
                 UNDEFINED X mnOrderNumber
                 UNDEFINED X szKeyCompany
                 UNDEFINED X szSuffixNumber
                 UNDEFINED X mnOrderLineNumber
                 VA frm_ERRC_GenericErrorCode <> cLastRecordReadFlag
                 UNDEFINED X szDocumentType
                 VA frm_UORG_mnTotalQty_Wrkfld <- mnQuantity
                 UNDEFINED X szUnitOfMeasure
                 <Blank> -> cSuppressTerminateCache
                 UNDEFINED X mnUnitCost
                 UNDEFINED X nSequenceNumber
                 GC Memo Lot 1 <- szMemoLot1
                 GC Memo Lot 2 <- szMemoLot2
                 UNDEFINED X szMemoLot3
                 VA frm_idCacheCursor_GENLNG <> idCacheCursor
                 GC Supplier Lot Number <- szVendorLotNumber
                 VA frm_MMEJ_jdLotExpiration <- jdDateLayerExpiration
                 UNDEFINED X cLotStatusCode
                 UNDEFINED X mnIdentifierShortItem
                 UNDEFINED X mnQtyOnHandPrimaryUn
                 UNDEFINED X mnLotPotency
                 UNDEFINED X szLotGrade
                 UNDEFINED X szDescriptionLine1
                 UNDEFINED X cStockingType
                 UNDEFINED X mnQuantityAvailable
                 VA frm_SQOR_TotalQty_Wrkfld <- mnDualQuantity
                 UNDEFINED X szUnitOfMeasureSecondary
                 UNDEFINED X jdBasedOnDate
                 UNDEFINED X jdLotEffectivityDate
                 UNDEFINED X jdOnHandDate
                 UNDEFINED X jdSellByDate
                 UNDEFINED X jdBestBeforeDate
                 UNDEFINED X jdUserLotDate1
                 UNDEFINED X jdUserLotDate2
                 UNDEFINED X jdUserLotDate3
                 UNDEFINED X jdUserLotDate4
                 UNDEFINED X jdUserLotDate5
                 UNDEFINED X cBasePriceIndicator
                 UNDEFINED X cAdjustmentIndicator
                 UNDEFINED X mnAdjustmentRevisionLevel
                 UNDEFINED X cPriceOverrideCode
0190       End While
0191       //
0192       If VA frm_ERRC_GenericErrorCode is not equal to "1"
0193          GC Sel = 1 = "1"
0194          GC AC = "P"
0195          GC RowChanged = "Y"
0196          GC EV04MultiLocation = "1"
0197          GC Branch/Plant = VA frm_MCU_szCacheBranch
0198          GC Location(DB Format) = VA frm_LOCN_szCacheLocation
0199          VA frm_SaveCurrentLineNumber = GC LineNumber
0200          //
0201          // if record is related to Advanced Serial Number processing, lock down the grid
0202          // columns related to Adnaced Serial Number processing.
0203          //
0204          If VA frm_UORG_mnTotalQty_Wrkfld is equal to "1"
0205             F4102.Fetch Single
                    GC Short Item No =  TK Item Number - Short
                    GC Branch/ Plant =  TK Business Unit
                    VA evt_LotProcessType <- TK Layer Code - Source
0206          Else
0207             VA evt_LotProcessType = "0"
0208          End If
0209          //
0210          If VA evt_LotProcessType is equal to "4,5,6,7"
              And VA frm_UORG_mnTotalQty_Wrkfld is equal to "1"
0211             Disable Grid(FC Grid, <Currently Selected Row>, GC QuantityShipped)
0212             Disable Grid(FC Grid, <Currently Selected Row>, GC Unit ofMeasure)
0213             Disable Grid(FC Grid, <Currently Selected Row>, GC SecondaryQty Shipped)
0214             Disable Grid(FC Grid, <Currently Selected Row>, GC SecondaryUoM)
0215             Disable Grid(FC Grid, <Currently Selected Row>, GC Branch/Plant)
0216             Disable Grid(FC Grid, <Currently Selected Row>, GC Location)
0217             Disable Grid(FC Grid, <Currently Selected Row>, GC Lot/Serial)
0218             Disable Grid(FC Grid, <Currently Selected Row>, GC QuantityBackordered)
0219             Disable Grid(FC Grid, <Currently Selected Row>, GC QuantityCanceled)
0220          Else
0221             // If Multi Loc Over Under Qty equals zero and GC Quantity equals GC Quantiy
0222             // Shipped DB, reset grid fields related to Multi Location processing.
0223             //
0224             // SAR 508512 - setup variable based upon Dual processing
0225             If VA evt_DualPickingProcessOption is equal to "1"
0226                If VA evt_SQOR_MultiLocDualOvrUndQty is equal to <Zero>
                    And VA frm_SQOR_TotalQty_Wrkfld is equal to GC SecondaryQtyShippedDB
0227                   GC AC = " "
0228                   GC EV04MultiLocation = " "
0229                End If
0230             Else
0231                If VA evt_SOQS_MultiLocOverUnderQty is equal to <Zero>
                    And VA frm_UORG_mnTotalQty_Wrkfld is equal to GC QuantityShippedDB
0232                   GC AC = " "
0233                   GC EV04MultiLocation = " "
0234                End If
0235             End If
0236          End If
0237          // end SAR 5028512
0238          //
0239          //
0240          F4100 Format Location
                 GC Branch/ Plant -> szCostCenter
                 GC Location <- szDisplayFormatLocation
                 VA frm_LOCN_szCacheLocation -> szFileFormatLocation
                 "4" -> cValidate
                 UNDEFINED X szAisle
                 UNDEFINED X szBin
                 UNDEFINED X szLocation3
                 UNDEFINED X szLocation4
                 UNDEFINED X szLocation5
                 UNDEFINED X szLocation6
                 UNDEFINED X szLocation7
                 UNDEFINED X szLocation8
                 UNDEFINED X szLocation9
                 UNDEFINED X szLocation10
                 "1" -> cMode
                 UNDEFINED X idBranchConstantRecord
0241          GC Lot/Serial = VA frm_LOTN_szCacheLotNumber
0242          GC Lot ExpirationDate = VA frm_MMEJ_jdLotExpiration
0243          GC QuantityShipped = VA frm_UORG_mnTotalQty_Wrkfld
0244          GC QuantityShippedDB = VA frm_UORG_mnTotalQty_Wrkfld
0245          GC SecondaryQty Shipped = VA frm_SQOR_TotalQty_Wrkfld
0246          GC SecondaryQtyShippedDB = VA frm_SQOR_TotalQty_Wrkfld
0247          //
0248          // calculate new Order Quantity (UORG) for parent line:
0249          //       Parent Order Quantity = Quantity Shipped + Back Order Quantity +
0250          //                                            Cancelled Quantity - Over/Under
0251          //
0252          GC UORG - QtyOrdered-Parent = [GC QuantityShipped]+[GC QuantityBackordered]+[GC QuantityCanceled]-[GC Quantity Shipped - Ovr_Undr]
0253          //
0254          // SAR 5028512 - if dual item, compute value of scondary over under
0255          If VA evt_DualPickingProcessOption is equal to "1"
0256             // SAR 6482717 - Modify calculation to produce the secondary order quantity in
0257             // Secondary UOM.
0258             GC UORG - Qty Ordered - Dual = [GC SecondaryQty Shipped]+(([GC QuantityBackordered]+[GC QuantityCanceled])*[VA evt_ConvFactorTranstoSecondary])-[GC Secondary Quantity -Over Under]
0259             // end SAR 6482717
0260          End If
0261          // end SAR 5028512
0262          //
0263          // SAR 5341912 - clear and calculate Bulk values
0264          //
0265          //     BULK
0266          //
0267          If VA frm_UseBulkManagement is equal to "1"
              And GC ItemNumber is greater than <Blank>
0268             //
0269             If VA frm_BulkPackedFlag_Save is equal to "B"
0270                //
0271                //
0272                GC AmbientVolume = "0"
0273                GC Ambient Volume UOM = " "
0274                GC StandardVolume = "0"
0275                GC StandardVolume UOM = " "
0276                GC WeightQuantity = "0"
0277                GC Weight Qty UOM = " "
0278                GC Temperature = "0"
0279                GC TempType = " "
0280                GC DisplayDensity = "0"
0281                GC DensityType = " "
0282                GC DensityTemp = "0"
0283                GC Density Temp Type = " "
0284                GC Vol CorFactor = "0"
0285                GC TemperatureSave = "0"
0286                GC TemperatureType_Save = " "
0287                GC DisplayDensity_Save = "0"
0288                GC DensityType_Save = " "
0289                GC DensityTemp_Save = "0"
0290                GC Density_TempType_Save = " "
0291                GC Vol CorFactor_Save = "0"
0292                GC TransavctionTime_Save = "0"
0293                //
0294                Determine Which Bulk Quantity to Load From Trans Qty
                       GC Quantity ShippedDB [HIDDEN] <> mnQuantityTransaction
                       GC Unit of Measure <> szUnitOfMeasureAsInput
                       GC Ambient Volume <> mnAmbientResult
                       GC Ambient  Volume UOM <> szUnitofMeasure3
                       GC Standard Volume <> mnStockTotalVolume
                       GC Standard Volume UOM <> szUnitofMeasure4
                       GC Weight Quantity <> mnWeightResult
                       GC Weight  Qty UOM <> szUnitofMeasure5
                       PO cBulkTransactionVolFlag -> cAmbientOrStandard
0295                //
0296                GC AmbientVolume_Save = GC AmbientVolume
0297                GC Ambient_Vol_UOM_Save = GC Ambient Volume UOM
0298                GC StandardVolume_Save = GC StandardVolume
0299                GC Standard_VolumeUOM_Save = GC StandardVolume UOM
0300                GC WeightResult_Save = GC WeightQuantity
0301                GC Weight_QtyUOM_Save = GC Weight Qty UOM
0302             End If
0303          End If
0304          //
0305          // end SAR 5341912
0306          //
0307          Disable Grid(FC Grid,  <Current Row>, GC Sel = 1)
0308          Get Selected Grid Row Number(FC Grid, VA frm_INT01_RowNumber)
0309          //
0310          GB OriginalOrderCo = GC OrderCo
0311          GB OriginalOrderType = GC OrTy
0312          GB OriginalOrderNum = GC OrderNumber
0313          GB OriginalLineNum = GC LineNumber
0314          //
0315       Else
0316          //
0317          // No records were read in from the Multilocations Screen. Set grid column value
0318          // to indicate this.
0319          GC PreviousSelect Value = " "
0320       End If
0321    End If
0322 End If

-----------------------------------------------------------------------
     EVENT:  Post Button Clicked
-----------------------------------------------------------------------
     evt_UniqueLineNumberFound
     evt_LineNumberRounded
     evt_LineNumberDecimal
     evt_MultiLocationCacheError
0001 //
0002 //  If this line is not a Kit Item, and has not already been split.....
0003 // SAR 3069003 - RB5679171 06/14/99
0004 // Change if test to allow for Configured Items to be processed
0005 //
0006 If VA frm_KitParentFlag is not equal to "1"
     And GC EV04MultiLocation is not equal to "2"
0007    //
0008    // Perform this processing if Selected Line Passed MBF Edits.
0009    If GC ErrorCode is not equal to "2"
0010       //
0011       //     If already reached the end of the cache, bypass the rest of the logic.
0012       If VA frm_ERRC_GenericErrorCode is equal to "1"
0013          Stop Processing
0014       End If
0015       //
0016 !       Get Selected Grid Row Number(FC Grid, VA frm_GridRowNumber)
0017       //
0018       //     Read thru the cache and insert a record to the grid for each cache row
0019       //      retrieved.  Most of the information in the new grid row will be copied
0020       //     from  the original line with the exception to a few columns.
0021       //
0022       While VA frm_ERRC_GenericErrorCode is equal to "2"
0023          Copy Grid Row To Grid Buffer(FC Grid, <Current Row>)
0024          Cache, Get Memory
                 UNDEFINED X szItemNumber
                 GB Branch/ Plant <- szBranchPlant
                 GB Location (DB Format) [HIDDEN] <- szLocation
                 GB Lot/Serial <- szLotNumber
                 UNDEFINED X szCatalogNumber
                 UNDEFINED X mnSupplierNumber
                 UNDEFINED X mnOrderNumber
                 UNDEFINED X szKeyCompany
                 UNDEFINED X szSuffixNumber
                 UNDEFINED X mnOrderLineNumber
                 VA frm_ERRC_GenericErrorCode <> cLastRecordReadFlag
                 UNDEFINED X szDocumentType
                 VA frm_UORG_mnTotalQty_Wrkfld <- mnQuantity
                 UNDEFINED X szUnitOfMeasure
                 <Blank> -> cSuppressTerminateCache
                 UNDEFINED X mnUnitCost
                 UNDEFINED X nSequenceNumber
                 GB Memo Lot 1 <- szMemoLot1
                 GB Memo Lot 2 <- szMemoLot2
                 UNDEFINED X szMemoLot3
                 VA frm_idCacheCursor_GENLNG <> idCacheCursor
                 GB Supplier Lot Number <- szVendorLotNumber
                 GB Lot Expiration Date <- jdDateLayerExpiration
                 UNDEFINED X cLotStatusCode
                 UNDEFINED X mnIdentifierShortItem
                 UNDEFINED X mnQtyOnHandPrimaryUn
                 UNDEFINED X mnLotPotency
                 UNDEFINED X szLotGrade
                 UNDEFINED X szDescriptionLine1
                 UNDEFINED X cStockingType
                 UNDEFINED X mnQuantityAvailable
                 VA frm_SQOR_TotalQty_Wrkfld <- mnDualQuantity
                 UNDEFINED X szUnitOfMeasureSecondary
                 UNDEFINED X jdBasedOnDate
                 UNDEFINED X jdLotEffectivityDate
                 UNDEFINED X jdOnHandDate
                 UNDEFINED X jdSellByDate
                 UNDEFINED X jdBestBeforeDate
                 UNDEFINED X jdUserLotDate1
                 UNDEFINED X jdUserLotDate2
                 UNDEFINED X jdUserLotDate3
                 UNDEFINED X jdUserLotDate4
                 UNDEFINED X jdUserLotDate5
                 UNDEFINED X cBasePriceIndicator
                 UNDEFINED X cAdjustmentIndicator
                 UNDEFINED X mnAdjustmentRevisionLevel
                 UNDEFINED X cPriceOverrideCode
0025          If VA frm_ERRC_GenericErrorCode is not equal to "1"
              And VA frm_UORG_mnTotalQty_Wrkfld is not equal to <Zero>
              And VA frm_UORG_mnTotalQty_Wrkfld is not equal to <Null>
0026             //
0027             F4100 Format Location
                    GB Branch/ Plant -> szCostCenter
                    GB Location <- szDisplayFormatLocation
                    GB Location (DB Format) [HIDDEN] -> szFileFormatLocation
                    "4" -> cValidate
                    UNDEFINED X szAisle
                    UNDEFINED X szBin
                    UNDEFINED X szLocation3
                    UNDEFINED X szLocation4
                    UNDEFINED X szLocation5
                    UNDEFINED X szLocation6
                    UNDEFINED X szLocation7
                    UNDEFINED X szLocation8
                    UNDEFINED X szLocation9
                    UNDEFINED X szLocation10
                    "1" -> cMode
                    UNDEFINED X idBranchConstantRecord
0028             //
0029             GB Sel = 1 = "1"
0030             GB RowChanged = "Y"
0031             GB EV04MultiLocation = "2"
0032             GB LocationSAVE = GB Location
0033             GB QuantityShipped = VA frm_UORG_mnTotalQty_Wrkfld
0034             GB QuantityShippedDB = VA frm_UORG_mnTotalQty_Wrkfld
0035             GB QuantityShipped_SAVE = VA frm_UORG_mnTotalQty_Wrkfld
0036             GB SecondaryQty Shipped = VA frm_SQOR_TotalQty_Wrkfld
0037             GB SecondaryQtyShippedDB = VA frm_SQOR_TotalQty_Wrkfld
0038             GB Secondary Quantity_SAVE = VA frm_SQOR_TotalQty_Wrkfld
0039             GB Quantity Backordered = "0"
0040             GB QuantityBackordered_SAVE = "0"
0041             GB QuantityCanceled = "0"
0042             GB QuantityCanceled_SAVE = "0"
0043             GB AC = "S"
0044             GB RecordWritten = "0"
0045             GB XT4111Line Number = 0
0046             GB B4200310Line Number = 0
0047             GB LNIX-LastAssignedNumber = "0"
0048             // SAR 3312114 RB5679171 08/26/99
0049             // Change line increment from .010 to .001
0050             VA frm_LNIX_RowNumberCounter = [VA frm_LNIX_RowNumberCounter]+.001
0051             // end SAR 3312114
0052             GB Quantity Shipped - Ovr_Undr = 0
0053             GB Secondary Quantity -Over Under = 0
0054             GB UORG - QtyOrdered-Parent = 0
0055             GB UORG - Qty Ordered - Dual = 0
0056             GB Orig Quantity Shipped - Static = VA frm_UORG_mnTotalQty_Wrkfld
0057             GB OriginalSecondary Quantity = VA frm_SQOR_TotalQty_Wrkfld
0058             VA frm_INT01_RowNumber = [VA frm_INT01_RowNumber]+1
0059             //
0060             // format Line Number and verify it is unique
0061             //       Once a unique line number is found in F4211, a test is performed to
0062             //       verify the line does not exist in F42119. The search will stop when a
0063             //       line number is found that is unique to both tables.
0064             //
0065             VA evt_UniqueLineNumberFound = "0"
0066             //
0067             // SAR 3069003 RB5679171 06/15/99
0068             // Add processing to assign new line numbers differently when
0069             //  processing a line for a Configured Item
0070             //
0071             If VA frm_ConfiguredItemFlag is equal to "1"
0072 !                F4211 Calculate Configured Line Number
     !                   GB Order Number -> mnDocumentOrderInvoiceE
     !                   GB Or Ty -> szOrderType
     !                   GB Order Co -> szCompanyKeyOrderNo
     !                   VA frm_SaveCurrentLineNumber -> mnOriginalLineNumber
     !                   GB Line Number <- mnNewLineNumber
     !                   UNDEFINED X mnOverrideIncrementValue
     !                   UNDEFINED X cSuppressErrorMessage
     !                   UNDEFINED X szErrorMessageID
     !                   VA frm_Job_Number -> mnConfigParentJobNumber
     !                   VA frm_ComputerID -> szComputerID
     !                   UNDEFINED X cProcessingMode
     !                   UNDEFINED X mnLineNumberKitMaster
     !                   UNDEFINED X mnRelatedKitComponent
0073             Else
0074                // end SAR 3069003 changes
0075                //
0076                // SAR 3312114 RB5679171 08/26/99
0077                // Change line increment from .010 to .001
0078                GB LineNumber = [VA frm_SaveCurrentLineNumber]+.001
0079                // end SAR 3312114
0080                //
0081                While VA evt_UniqueLineNumberFound is not equal to "1"
0082                   F4211.Fetch Single
                          GB Order Co =  TK Order Company (Order Number)
                          GB Order Number =  TK Document (Order No, Invoice, etc.)
                          GB Or Ty =  TK Order Type
                          GB Line Number =  TK Line Number
0083                   While SV File_IO_Status is equal to CO SUCCESS
0084                      // SAR 3312114 RB5679171 08/26/99
0085                      // Change line increment from .010 to .001
0086                      GB LineNumber = [GB LineNumber]+.001
0087                      // end SAR 3312114
0088                      F4211.Fetch Single
                             GB Order Co =  TK Order Company (Order Number)
                             GB Order Number =  TK Document (Order No, Invoice, etc.)
                             GB Or Ty =  TK Order Type
                             GB Line Number =  TK Line Number
0089                   End While
0090                   F42119.Fetch Single
                          GB Order Co =  TK Order Company (Order Number)
                          GB Order Number =  TK Document (Order No, Invoice, etc.)
                          GB Or Ty =  TK Order Type
                          GB Line Number =  TK Line Number
0091                   If SV File_IO_Status is equal to CO SUCCESS
0092                      // SAR 3312114 RB5679171 08/26/99
0093                      // Change line increment from .010 to .001
0094                      GB LineNumber = [GB LineNumber]+.001
0095                      // end SAR 3312114
0096                   Else
0097                      // SAR 3312114 RB5679171 08/26/99
0098                      // add check for records previously processed - use Kit Parent Line cache to
0099                      // store and retrieve the line numbers assigned by Multi Location processing
0100                      Process Kit Parent Line Cache
                             VA frm_MultiLocationJobnumber -> mnKitParentJobNumber
                             VA frm_ComputerID -> szComputerID
                             GB Order Number -> mnDocumentOrderInvoiceE
                             GB Or Ty -> szOrderType
                             GB Order Co -> szCompanyKeyOrderNo
                             GB Line Number -> mnLineNumber
                             "1" -> szCacheActionCode
                             UNDEFINED X idCacheCursor
                             "6" -> mnNumberKeys
                             "1" -> cSuppressErrorMessage
                             VA evt_MultiLocationCacheError <- szErrorMessageID
                             UNDEFINED X cSDAllowBackorders
                             UNDEFINED X cIBBackordersFlag
                             UNDEFINED X cIMBackordersFlag
0101                      If VA evt_MultiLocationCacheError is less than or equal to <Blank>
0102                         While VA evt_MultiLocationCacheError is less than or equal to <Blank>
0103                            GB LineNumber = [GB LineNumber]+.001
0104                            Process Kit Parent Line Cache
                                   VA frm_MultiLocationJobnumber -> mnKitParentJobNumber
                                   VA frm_ComputerID -> szComputerID
                                   GB Order Number -> mnDocumentOrderInvoiceE
                                   GB Or Ty -> szOrderType
                                   GB Order Co -> szCompanyKeyOrderNo
                                   GB Line Number -> mnLineNumber
                                   "1" -> szCacheActionCode
                                   UNDEFINED X idCacheCursor
                                   "6" -> mnNumberKeys
                                   "1" -> cSuppressErrorMessage
                                   VA evt_MultiLocationCacheError <- szErrorMessageID
                                   UNDEFINED X cSDAllowBackorders
                                   UNDEFINED X cIBBackordersFlag
                                   UNDEFINED X cIMBackordersFlag
0105                         End While
0106                      Else
0107                         Process Kit Parent Line Cache
                                VA frm_MultiLocationJobnumber -> mnKitParentJobNumber
                                VA frm_ComputerID -> szComputerID
                                GB Order Number -> mnDocumentOrderInvoiceE
                                GB Or Ty -> szOrderType
                                GB Order Co -> szCompanyKeyOrderNo
                                GB Line Number -> mnLineNumber
                                "2" -> szCacheActionCode
                                UNDEFINED X idCacheCursor
                                "6" -> mnNumberKeys
                                <Blank> -> cSuppressErrorMessage
                                VA evt_MultiLocationCacheError <- szErrorMessageID
                                UNDEFINED X cSDAllowBackorders
                                UNDEFINED X cIBBackordersFlag
                                UNDEFINED X cIMBackordersFlag
0108                         VA evt_UniqueLineNumberFound = "1"
0109                      End If
0110                      // end SAR 3312114
0111                   End If
0112                End While
0113             End If
0114             VA frm_SaveCurrentLineNumber = GB LineNumber
0115             GB LNID-F42UI05LineNumber = GB LineNumber
0116             //
0117             // SAR 5341912 - clear and calculate Bulk values
0118             //
0119             //     BULK
0120             //
0121             If VA frm_UseBulkManagement is equal to "1"
                 And GB ItemNumber is greater than <Blank>
0122                //
0123                If VA frm_BulkPackedFlag_Save is equal to "B"
0124                   //
0125                   GB AmbientVolume = "0"
0126                   GB Ambient Volume UOM = " "
0127                   GB StandardVolume = "0"
0128                   GB StandardVolume UOM = " "
0129                   GB WeightQuantity = "0"
0130                   GB Weight Qty UOM = " "
0131                   GB Temperature = "0"
0132                   GB TempType = " "
0133                   GB DisplayDensity = "0"
0134                   GB DensityType = " "
0135                   GB DensityTemp = "0"
0136                   GB Density Temp Type = " "
0137                   GB Vol CorFactor = "0"
0138                   GB TemperatureSave = "0"
0139                   GB TemperatureType_Save = " "
0140                   GB DisplayDensity_Save = "0"
0141                   GB DensityType_Save = " "
0142                   GB DensityTemp_Save = "0"
0143                   GB Density_TempType_Save = " "
0144                   GB Vol CorFactor_Save = "0"
0145                   GB TransavctionTime_Save = "0"
0146                   //
0147                   Determine Which Bulk Quantity to Load From Trans Qty
                          GB Quantity ShippedDB [HIDDEN] <> mnQuantityTransaction
                          GB Unit of Measure <> szUnitOfMeasureAsInput
                          GB Ambient Volume <> mnAmbientResult
                          GB Ambient  Volume UOM <> szUnitofMeasure3
                          GB Standard Volume <> mnStockTotalVolume
                          GB Standard Volume UOM <> szUnitofMeasure4
                          GB Weight Quantity <> mnWeightResult
                          GB Weight  Qty UOM <> szUnitofMeasure5
                          PO cBulkTransactionVolFlag -> cAmbientOrStandard
0148                   //
0149                   GB AmbientVolume_Save = GB AmbientVolume
0150                   GB Ambient_Vol_UOM_Save = GB Ambient Volume UOM
0151                   GB StandardVolume_Save = GB StandardVolume
0152                   GB Standard_VolumeUOM_Save = GB StandardVolume UOM
0153                   GB WeightResult_Save = GB WeightQuantity
0154                   GB Weight_QtyUOM_Save = GB Weight Qty UOM
0155                End If
0156             End If
0157             //
0158             // end SAR 5341912
0159             //
0160             Insert Grid Buffer Row(FC Grid, VA frm_INT01_RowNumber, <Yes>,  <No>, <Yes>, <No>, <Yes>)
0161             Disable Grid(FC Grid, VA frm_INT01_RowNumber,  <All Columns>)
0162             Enable Grid(FC Grid, VA frm_INT01_RowNumber, GC CarrierNumber)
0163             Enable Grid(FC Grid, VA frm_INT01_RowNumber, GC Ship ToNumber)
0164             Enable Grid(FC Grid, VA frm_INT01_RowNumber, GC ContainerI.D.)
0165          End If
0166       End While
0167       //
0168    End If
0169    //   End MBF Edit Check
0170 End If
0171 //   End Kit and Split Line Check
0172 //
0173 //
0174 //     Store the last assigned line number to parent (original) row.  In
0175 //     B732, the GC values of the original line is still available at this
0176 //     moment.
0177 //
0178 GC LNIX-LastAssignedNumber = VA frm_LNIX_RowNumberCounter

=======================================================================
     CONTROL:  HYPITEM Lot Date Override
     EVENT:  Button Clicked
-----------------------------------------------------------------------
     evt_cDuplicateLotExist_EV01
     evt_BestBeforeDateSave_BBDJ
     evt_SellByDateSave_SBDJ
     evt_UserLotDate1Save_U1DJ
     evt_UserLotDate2Save_U2DJ
     evt_UserLotDate3Save_U3DJ
     evt_UserLotDate4Save_U4DJ
     evt_UserLotDate5Save_U5DJ
0001 // =====================================
0002 // Pinnacle - Multiple Lot Dates
0003 // =====================================
0004 If GC Branch/Plant is not equal to <Blank>
     And GC Lot/Serial is not equal to <Blank>
     And GC ShortItem No is not equal to <Blank>
0005    F4108 Verify Lot Not Duplicate
           GC Short Item No -> mnShortItemNumber
           GC Branch/ Plant -> szBranchPlant
           GC Lot/Serial -> szLotNumber
           VA evt_cDuplicateLotExist_EV01 <- cErrorCode
0006    If VA evt_cDuplicateLotExist_EV01 is equal to "1"
0007       Set Grid Cell Error(FC Grid,  <Currently Selected Row>, GC Lot/Serial, "4077")
0008    Else
0009       If GC Based OnDate is equal to <Null Date>
           Or GC Best BeforeDate is equal to <Null Date>
           Or GC Lot ExpirationDate is equal to <Null Date>
           Or GC Lot EffectivityDate is equal to <Null Date>
           Or GC Sell ByDate is equal to <Null Date>
           Or GC User LotDate 1 is equal to <Null Date>
           Or GC User LotDate 2 is equal to <Null Date>
           Or GC User LotDate 3 is equal to <Null Date>
           Or GC User LotDate 4 is equal to <Null Date>
           Or GC User LotDate 5 is equal to <Null Date>
           Or GC Actual ShipDate is equal to <Null Date>
0010          F4108 Get Lot Expiration Date
                 GC Short Item No -> mnShortItemNumber
                 GC Branch/ Plant -> szBranchPlant
                 GC Lot/Serial -> szLotNumber
                 UNDEFINED X szLotGrade
                 UNDEFINED X mnLotPotency
                 UNDEFINED X szLotDescription
                 UNDEFINED X cLotStatusCode
                 GC Lot Expiration Date <> jdExpirationDate
                 UNDEFINED X szSupplierLotNumber
                 UNDEFINED X mnShelfLifeDays
                 UNDEFINED X cFromSideOfTransfer
                 GC Actual Ship Date <> jdTransactionDate
                 UNDEFINED X cDefaultFromLotMaster
                 UNDEFINED X cSuppressErrorMsg
                 UNDEFINED X cLotProcessType
                 UNDEFINED X cSerialNumberRequired
                 UNDEFINED X szMemoLot1
                 UNDEFINED X szMemoLot2
                 UNDEFINED X szMemoLot3
                 "1" -> cExpirationDateEditMode
                 UNDEFINED X cMemoLotEditMode
                 UNDEFINED X szPrimaryLocationLot
                 UNDEFINED X cInventoryLotCreation
                 UNDEFINED X cErrorCode
                 UNDEFINED X idF4102ItemBranchPtr
                 GC Inventory Transaction Type [HIDDEN] -> mnTransactionType
                 GC Based On Date [HIDDEN] <> jdBasedOnDate
                 GC Actual Ship Date <> jdOnHandDate
                 GC Lot Effectivity Date <> jdLotEffectivityDate
                 GC Sell By Date [HIDDEN] <> jdSellByDate
                 GC Best Before Date [HIDDEN] <> jdBestBeforeDate
                 GC User Lot Date 1 [HIDDEN] <> jdUserLotDate1
                 GC User Lot Date 2 [HIDDEN] <> jdUserLotDate2
                 GC User Lot Date 3 [HIDDEN] <> jdUserLotDate3
                 GC User Lot Date 4 [HIDDEN] <> jdUserLotDate4
                 GC User Lot Date 5 [HIDDEN] <> jdUserLotDate5
                 UNDEFINED X cStockingType
0011       End If
0012       VA evt_BestBeforeDateSave_BBDJ = GC Best BeforeDate
0013       VA evt_SellByDateSave_SBDJ = GC Sell ByDate
0014       VA evt_UserLotDate1Save_U1DJ = GC User LotDate 1
0015       VA evt_UserLotDate2Save_U2DJ = GC User LotDate 2
0016       VA evt_UserLotDate3Save_U3DJ = GC User LotDate 3
0017       VA evt_UserLotDate4Save_U4DJ = GC User LotDate 4
0018       VA evt_UserLotDate5Save_U5DJ = GC User LotDate 5
0019       Call( App:P4108 , Form: W4108G )
              GC Lot/Serial -> szLot
              GC Short Item No -> mnIdentifierShortItem
              GC Branch/ Plant -> szCostCenter
              GC Based On Date [HIDDEN] <> jdBasedOnDate
              GC Actual Ship Date <> jdOnHandDate
              GC Lot Effectivity Date <> jdLotEffectivityDate
              GC Sell By Date [HIDDEN] <> jdSellByDate
              GC Best Before Date [HIDDEN] <> jdBestBeforeDate
              GC User Lot Date 1 [HIDDEN] <> jdUserLotDate1
              GC User Lot Date 2 [HIDDEN] <> jdUserLotDate2
              GC User Lot Date 3 [HIDDEN] <> jdUserLotDate3
              GC User Lot Date 4 [HIDDEN] <> jdUserLotDate4
              GC User Lot Date 5 [HIDDEN] <> jdUserLotDate5
              GC Lot Expiration Date <> jdDate - Lot Expiration
              UNDEFINED X cOKPressed
0020       If GC Lot ExpirationDate_Save is not equal to GC Lot ExpirationDate
0021          GC Lot ExpirationDate_Save = GC Lot ExpirationDate
0022          GC RowChanged = "Y"
0023       End If
0024       If GC Lot EffectivityDate_Save is not equal to GC Lot EffectivityDate
0025          GC Lot EffectivityDate_Save = GC Lot EffectivityDate
0026          GC RowChanged = "Y"
0027       End If
0028       If GC RowChanged is not equal to "Y"
0029          If VA evt_BestBeforeDateSave_BBDJ is not equal to GC Best BeforeDate
              Or VA evt_SellByDateSave_SBDJ is not equal to GC Sell ByDate
              Or VA evt_UserLotDate1Save_U1DJ is not equal to GC User LotDate 1
              Or VA evt_UserLotDate2Save_U2DJ is not equal to GC User LotDate 2
              Or VA evt_UserLotDate3Save_U3DJ is not equal to GC User LotDate 3
              Or VA evt_UserLotDate4Save_U4DJ is not equal to GC User LotDate 4
              Or VA evt_UserLotDate5Save_U5DJ is not equal to GC User LotDate 5
0030             GC RowChanged = "Y"
0031          End If
0032       End If
0033    End If
0034 Else
0035    Stop Processing
0036 End If
0037 // =====================================
0038 // End Pinnacle - Multiple Lot Dates
0039 // =====================================

=======================================================================
     CONTROL:  HYPITEM Carton Reorg
     EVENT:  Button Clicked
-----------------------------------------------------------------------
0001 //
0002 // ======================================================
0003 // Carton detail can only exist for shipments.  If there is not a shipment, do
0004 // not display Carton Reorganization (P4620).
0005 // ======================================================
0006 If GC ShipmentNumber is greater than <Zero>
0007    If PO szP4620Version is equal to or empty <Blank>
0008       PO szP4620Version = "ZJDE0001"
0009    End If
0010    Call( App:P4620 , Form: W4620C )
           GC Shipment Number [HIDDEN] -> mnShipmentNumber
0011 Else
0012    Set Control Error(HC Carton Reorg, "181D")
0013 End If

=======================================================================
     CONTROL:  GRID Grid
     EVENT:  Double Click on Row Header
-----------------------------------------------------------------------
0001 //
0002 //     When the confirm button is pressed, load '1'  to grid line.  Only the
0003 //     grid lines that have a '*' on the option field (EV01) will be processed
0004 //     for shipment confirmation
0005 //
0006 // SAR 5056724 - Only toggle GL Sel if this is not a multi-location line.
0007 If GC EV04MultiLocation is less than or equal to <Zero>
     And GC RowChanged is not equal to "Y"
0008    If GC Sel = 1 is equal to "1"
0009       GC Sel = 1 = ""
0010    Else
0011       GC Sel = 1 = "1"
0012    End If
0013 End If

-----------------------------------------------------------------------
     EVENT:  Row Exit & Changed - Asynch
-----------------------------------------------------------------------
     evt_StockingType
0001 // ****************************************************************
0002 // Modifications:
0003 //
0004 // 08/26/2004  JS6787836  7189942 - Clear memo lot fields
0005 // ****************************************************************
0006 //
0007 //
0008 // ********************************************
0009 // CALL SHIP CONFIRM MBF TO PERFORM EDITS.
0010 //
0011 // LINE WAS DESELECTED.  DO NOT SHIP CONFIRM.
0012 //
0013 // ********************************************
0014 // CALL SHIP CONFIRM MBF TO PERFORM EDITS.
0015 //
0016 // LINE WAS DESELECTED.  DO NOT SHIP CONFIRM.
0017 If VA frm_CancelForm is not equal to "Y"
0018    If GC Sel = 1 is not equal to "1"
        And GC RecordWritten is greater than <Zero>
0019       //   REMOVE RECORD FROM SHIP CONFIRM CACHE
0020       GC AC = "D"
0021       F42UI05 Edit Line
              GC Error Code [HIDDEN] <- cErrorConditions
              GC Record Written [HIDDEN] <> cRecordWritten
              GC Order Number -> mnOrderNumber
              GC Or Ty -> szOrderType
              GC Order Co -> szOrderCompany
              GC Line Number -> mnLineNumber
              GC Branch/ Plant -> szBranchPlant
              GC Location -> szLocation
              GC Lot/Serial -> szLot
              GC Quantity Shipped <> mnEnteredShipQuantity
              GC Quantity Backordered -> mnEnteredBackorderQuantity
              GC Quantity Canceled -> mnEnteredCancelQuantity
              GC Ln Ty -> szEnteredLineType
              GC Container I.D. -> szContainerID
              GC Carrier Number -> mnCarrier
              "EP4205" -> szProgramID
              "1" -> cWriteIfWarning
              GC Description -> szDescription
              VA frm_Job_Number <> mnJobnumberA
              VA frm_UserID -> szUserId
              VA frm_VersionName -> szVersion
              GC A C [HIDDEN] -> cActionCode
              <Zero> -> cModeProcessing
              GC Ambient Volume -> mnBULK_AmbientQtyEntered
              GC Ambient  Volume UOM -> szBULK_AmbientQtyEnteredUOM
              GC Standard Volume -> mnBULK_StandardQtyEntered
              GC Standard Volume UOM -> szBULK_StandardQtyEnteredUOM
              GC Weight Quantity -> mnBULK_WeightQtyEntered
              GC Temperature -> mnBULK_Temperature
              GC Temp Type -> cBULK_ProductTemperatureType
              GC Display Density -> mnBULK_ProductDensity
              GC Density Temp -> mnBULK_DensityTemperature
              GC Density  Temp Type -> cBULK_DensityTemperatureType
              GC Transaction Time - Bulk -> mnBULK_TransactionTime
              GC Weight  Qty UOM -> szBULK_WeightQtyEnteredUOM
              GC Density Type -> cBULK_ProductDensityType
              GB Vol Cor Factor -> mnBulk_VolumeCorrectionFactors
              GC Original OrderCo [HIDDEN] -> szOriginal_CompanyKeyOrderNo
              GC Original OrderType [HIDDEN] -> szOriginal_OrderType2
              GC Original OrderNum [HIDDEN] -> mnOriginal_OrderNumber
              GC Original LineNum [HIDDEN] -> mnOriginal_LineNumber_3
              GC XT4111 Line Number [HIDDEN] <> mnXT4111LineNumber
              GC B4200310 Line Number [HIDDEN] <> mnB4200310LineNumber
              GC Unit of Measure -> szUnitOfMeasureAsInput
              GC Quantity Shipped - Ovr_Undr [HIDDEN] -> mnMultiLocQtyShipVariance
              GC UORG - QtyOrdered-Parent [HIDDEN] -> mnMultiLocParentOrderQuantity
              GC Ship To Number -> mnAddressNumberShipTo
              GC Ln Ty -> szLineType_2
              GC Supp No -> mnContractSupplementDistri
              GC Agreement Number -> szContractNumberDistributi
              FI szTRAN_PrimaryVehicleId -> szTRAN_PrimaryVehicleId
              FI szTRAN_RegistrationLicNumber -> szTRAN_RegistrationLicenseNum
              VA frm_ComputerID -> szComputerID
              GC Secondary Qty Shipped -> mnUnitsSecondaryQtyOr
              GC Secondary UoM -> szUnitOfMeasureSecondary
              GC Secondary Quantity - Over Under [HIDDEN] -> mnMultiLocSecondaryQtyShipVar
              GC UORG - Qty Ordered - Dual [HIDDEN] -> mnMultiLocSecondaryOrderQty
0022       GC AC = "C"
0023       GC XT4111Line Number = ""
0024       GC PreviousSelect Value = ""
0025    Else
0026       //      ROW HAS CHANGED OR HAS BEEN SELECTED FOR SHIP CONFIRM
0027       If GC RowChanged is equal to "Y"
           Or GC Sel = 1 is equal to "1"
           And GC PreviousSelect Value is not equal to "1"
0028          //
0029          //  Default Ship Information
0030          //
0031          //     SET DEFAULT VALUES FROM SHIP CONFIRM DEFAULT SCREEN.
0032          //
0033          If FI mnTRAN_TransportationJobNumber is not equal to <Zero>
0034             //  P4205 was called by Transportation.  Use Passed in ShipDate.
0035             //   (Do not allow overwrite of Carrier Number in F4211.)
0036             GC Actual ShipDate = VA frm_Default_ShipDate
0037             GC TransactionTime - Bulk = VA frm_DefaultLoadTime
0038             //
0039             // =======================================================================
0040             // Demand Scheduling - Times- Shipment Confirmation
0041             // =======================================================================
0042             If VA frm_cDemandSchedReleased_DSRFU is equal to "1"
0043                // =============================================================
0044                // SAR 6621220 - Kits & Times
0045                // Do not update Actual Shipment Time for a Kit/Configured Item Parent or
0046                // Component Order Line
0047                // =============================================================
0048                If GC Committed is equal to "K" Or GC Kit lnNumber is greater than <Zero>
0049                   // Do not update Actual Shipment Time, this is a Kit/Configured Item Parent or
0050                   // Component.
0051                Else
0052                   GC ActualShip Time = VA frm_mnDefaultShipTime_TME0
0053                End If
0054             End If
0055          Else
0056             //   Proceed with normal processing.
0057             If GC Actual ShipDate is less than or equal to <Blank>
0058                GC Actual ShipDate = VA frm_Default_ShipDate
0059             End If
0060             //
0061             // =======================================================================
0062             // Demand Scheduling - Times- Shipment Confirmation
0063             // =======================================================================
0064             If VA frm_cDemandSchedReleased_DSRFU is equal to "1"
0065                If GC ActualShip Time is equal to <Zero>
0066                   // =============================================================
0067                   // SAR 6621220 - Kits & Times
0068                   // Do not update Actual Shipment Time for a Kit/Configured Item Parent or
0069                   // Component Order Line
0070                   // =============================================================
0071                   If GC Committed is equal to "K" Or GC Kit lnNumber is greater than <Zero>
0072                      // Do not update Actual Shipment Time, this is a Kit/Configured Item Parent or
0073                      // Component.
0074                   Else
0075                      GC ActualShip Time = VA frm_mnDefaultShipTime_TME0
0076                   End If
0077                End If
0078             End If
0079             //
0080             If GC TransactionTime - Bulk is equal to <Zero>
0081                GC TransactionTime - Bulk = VA frm_DefaultLoadTime
0082             End If
0083             If GC CarrierNumber is less than or equal to <Zero>
0084                GC CarrierNumber = VA frm_Default_CarrierNumber
0085                GC CarrierNumberSAVE = VA frm_Default_CarrierNumber
0086             End If
0087          End If
0088          //
0089          If GC ContainerI.D. is less than or equal to <Blank>
0090             GC ContainerI.D. = VA frm_Default_ContainerID
0091             GC ContainerI.D._SAVE = VA frm_Default_ContainerID
0092          End If
0093          //
0094          // SAR 7189942 - If the Lot or Location changes, clear the memo fields.  Edit
0095          If VA frm_cClearMemo_CHAR is equal to "1"
0096             GC Memo Lot 1 = ""
0097             GC Memo Lot 2 = ""
0098          End If
0099          // end SAR 7189942
0100          //
0101          // Line will return these values if they are blank.
0102          //
0103          // CALL SHIP CONFIRM EDITLINE
0104          //
0105          F42UI05 Edit Line
                 GC Error Code [HIDDEN] <- cErrorConditions
                 GC Record Written [HIDDEN] <> cRecordWritten
                 GC Order Number -> mnOrderNumber
                 GC Or Ty -> szOrderType
                 GC Order Co -> szOrderCompany
                 GC Line Number -> mnLineNumber
                 GC Branch/ Plant -> szBranchPlant
                 GC Location <> szLocation
                 GC Lot/Serial -> szLot
                 GC Quantity Shipped <> mnEnteredShipQuantity
                 GC Quantity Backordered -> mnEnteredBackorderQuantity
                 GC Quantity Canceled -> mnEnteredCancelQuantity
                 GC Ln Ty -> szEnteredLineType
                 GC Container I.D. -> szContainerID
                 GC Carrier Number -> mnCarrier
                 GC Actual Ship Date -> jdActualDeliveryDate
                 "EP4205" -> szProgramID
                 "1" -> cWriteIfWarning
                 GC Description -> szDescription
                 VA frm_Job_Number <> mnJobnumberA
                 VA frm_UserID -> szUserId
                 VA frm_VersionName -> szVersion
                 GC A C [HIDDEN] -> cActionCode
                 GC Edit Mode [HIDDEN] -> cModeProcessing
                 GC Shipment Number [HIDDEN] -> mnTRAN_ShipmentNumber
                 FI jdTRAN_DELIVERY_DATE -> jdTRAN_DeliveryDate
                 FI cTRAN_InventoryAffectFlag -> cTRAN_InventoryAffectFlag
                 FI szTRAN_OverrideDocType -> szTRAN_OverrideDocumentType
                 FI mnTRAN_OverrideDocNumber -> mnTRAN_OverrideInventoryDocNum
                 FI szTRAN_OverrideNextStatusCode -> szTRAN_OverrideNextStatus
                 FI cTRAN_OverrideLeaveShippable -> cTRAN_OverrideLeaveShippable
                 GC Ambient Volume <> mnBULK_AmbientQtyEntered
                 GC Ambient  Volume UOM <> szBULK_AmbientQtyEnteredUOM
                 GC Standard Volume <> mnBULK_StandardQtyEntered
                 GC Standard Volume UOM <> szBULK_StandardQtyEnteredUOM
                 GC Weight Quantity <> mnBULK_WeightQtyEntered
                 GC Temperature <> mnBULK_Temperature
                 GC Temp Type <> cBULK_ProductTemperatureType
                 GC Display Density <> mnBULK_ProductDensity
                 GC Density Temp <> mnBULK_DensityTemperature
                 GC Density  Temp Type <> cBULK_DensityTemperatureType
                 GC Transaction Time - Bulk <> mnBULK_TransactionTime
                 GC Weight  Qty UOM <> szBULK_WeightQtyEnteredUOM
                 GC Density Type <> cBULK_ProductDensityType
                 GC Vol Cor Factor <> mnBulk_VolumeCorrectionFactors
                 GC Original OrderCo [HIDDEN] -> szOriginal_CompanyKeyOrderNo
                 GC Original OrderType [HIDDEN] -> szOriginal_OrderType2
                 GC Original OrderNum [HIDDEN] -> mnOriginal_OrderNumber
                 GC Original LineNum [HIDDEN] -> mnOriginal_LineNumber_3
                 GC Memo Lot 1 <> szMemoLotField1
                 GC Memo Lot 2 <> szMemoLotField2
                 GC Supplier Lot Number <> szVendorLotNumber
                 GC XT4111 Line Number [HIDDEN] <> mnXT4111LineNumber
                 GC B4200310 Line Number [HIDDEN] <> mnB4200310LineNumber
                 GC Unit of Measure -> szUnitOfMeasureAsInput
                 GC Quantity Shipped - Ovr_Undr [HIDDEN] -> mnMultiLocQtyShipVariance
                 GC UORG - QtyOrdered-Parent [HIDDEN] -> mnMultiLocParentOrderQuantity
                 GC Ship To Number -> mnAddressNumberShipTo
                 GC Ln Ty -> szLineType_2
                 GC Supp No -> mnContractSupplementDistri
                 GC Agreement Number -> szContractNumberDistributi
                 FI szTRAN_PrimaryVehicleId -> szTRAN_PrimaryVehicleId
                 FI szTRAN_RegistrationLicNumber -> szTRAN_RegistrationLicenseNum
                 FI szTRAN_OverrideCompanyKey -> szTRAN_DocumentCompany
                 FI jdTRAN_LoadConfirmDate_2 -> jdTRAN_LoadConfirmDate
                 FI mnTRAN_TimeLoad_2 -> mnTRAN_TimeLoad
                 VA frm_ComputerID -> szComputerID
                 GC Secondary Qty Shipped -> mnUnitsSecondaryQtyOr
                 GC Secondary UoM -> szUnitOfMeasureSecondary
                 GC Secondary Quantity - Over Under [HIDDEN] -> mnMultiLocSecondaryQtyShipVar
                 GC UORG - Qty Ordered - Dual [HIDDEN] -> mnMultiLocSecondaryOrderQty
                 GC Check Exp. Date [HIDDEN] <> cCheckExpirationDate
                 GC Check Sell By Date [HIDDEN] <> cCheckSellByDate
                 GC Check Best Before Date [HIDDEN] <> cCheckBestBeforeDate
                 GC Based On Date [HIDDEN] <> jdBasedOnDate
                 GC Lot Effectivity Date <> jdLotEffectivityDate
                 VA frm_ShipAscendingDateActive <> cShipAscendingDateFlag
                 GC Sell By Date [HIDDEN] <> jdSellByDate
                 GC Best Before Date [HIDDEN] <> jdBestBeforeDate
                 GC User Lot Date 1 [HIDDEN] <> jdUserLotDate1
                 GC User Lot Date 2 [HIDDEN] <> jdUserLotDate2
                 GC User Lot Date 3 [HIDDEN] <> jdUserLotDate3
                 GC User Lot Date 4 [HIDDEN] <> jdUserLotDate4
                 GC User Lot Date 5 [HIDDEN] <> jdUserLotDate5
                 GC Inventory Transaction Type [HIDDEN] <> mnInvTransactionType
                 GC Exit/ Entry -> szPortOfEntryExit
                 GC Actual Ship Time -> mnActualShipmentTime
                 FI cCalledByTransportation -> cCalledByTransportation
                 GC Lot Expiration Date <> jdDateLotExpiration
0106          VA frm_RecordsInCache = "Y"
0107          //
0108          If GC Sel = 1 is not equal to "1"
0109             GC Sel = 1 = "1"
0110          End If
0111          If GC ErrorCode is equal to <Blank>
              Or GC ErrorCode is equal to <Null>
0112             GC PreviousSelect Value = "1"
0113          Else
0114             GC PreviousSelect Value = "0"
0115          End If
0116          GC RowChanged = "N"
0117          // =====================================
0118          // Pinnacle - Multiple Lot Dates
0119          // =====================================
0120          If GC Lot EffectivityDate_Save is not equal to GC Lot EffectivityDate
0121             GC Lot EffectivityDate_Save = GC Lot EffectivityDate
0122          End If
0123          If GC Lot ExpirationDate_Save is not equal to GC Lot ExpirationDate
0124             GC Lot ExpirationDate_Save = GC Lot ExpirationDate
0125          End If
0126          // =====================================
0127          // End Pinnacle - Multiple Lot Dates
0128          // =====================================
0129          //
0130          // SAR 3242179 - 07/20/99 RB5679171
0131          // perform Update Configuration if no errors and Comitted is H or K.
0132          //
0133          If GC Committed is equal to "H,K"
              And GC ErrorCode is not equal to "2"
0134             Press Button(FC Configuration)
0135          End If
0136          //  end SAR 3242179
0137       End If
0138    End If
0139 End If

=======================================================================
     CONTROL:  GRIDCOL Quantity Shipped
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC QuantityShipped_SAVE is not equal to GC QuantityShipped
0002    GC QuantityShipped_SAVE = GC QuantityShipped
0003    GC RowChanged = "Y"
0004    If GC BulkFlag is equal to "B"
0005       // SAR 5307909 - modify function call to use correct Transaction UoM field
0006       Determine Which Bulk Quantity to Load From Trans Qty
              GC Quantity Shipped <> mnQuantityTransaction
              GC Unit of Measure <> szUnitOfMeasureAsInput
              GC Ambient Volume <> mnAmbientResult
              GC Ambient  Volume UOM <> szUnitofMeasure3
              GC Standard Volume <> mnStockTotalVolume
              GC Standard Volume UOM <> szUnitofMeasure4
              GC Weight Quantity <> mnWeightResult
              GC Weight  Qty UOM <> szUnitofMeasure5
              PO cBulkTransactionVolFlag -> cAmbientOrStandard
0007       // end SAR 5307909
0008       GC Bulk RowChanged = "Y"
0009    End If
0010 End If

=======================================================================
     CONTROL:  GRIDCOL Secondary Qty Shipped
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC Secondary Quantity_SAVE is not equal to GC SecondaryQty Shipped
0002    GC Secondary Quantity_SAVE = GC SecondaryQty Shipped
0003    GC RowChanged = "Y"
0004 End If

=======================================================================
     CONTROL:  GRIDCOL Location
     EVENT:  Visual Assist Button Clicked
-----------------------------------------------------------------------
0001 //  SAR 3231832   07/13/99
0002 Suppress Default Visual Assist Form
0003 //
0004 Call( App:P41LOCN , Form: W41LOCNB )
        GC Location <> Location
        GC Short Item No -> mnIdentifierShortItem
        GC Branch/ Plant -> szCostCenter
        GC Lot/Serial <> szLot
        PO szLotGroup -> szLotGroup
        FC Order Type -> szOrderType
0005 //  SAR 3231832   End

-----------------------------------------------------------------------
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 // *************************************************************
0002 // Modifications:
0003 //
0004 // 08/26/2004  JS6787836  7189942 - If location changes, clear memo lot
0005 // *************************************************************
0006 If GC LocationSAVE is not equal to GC Location
0007    F4100 Format Location
           GC Branch/ Plant -> szCostCenter
           GC Location -> szDisplayFormatLocation
           GC Location (DB Format) [HIDDEN] <- szFileFormatLocation
           "4" -> cValidate
           UNDEFINED X szAisle
           UNDEFINED X szBin
           UNDEFINED X szLocation3
           UNDEFINED X szLocation4
           UNDEFINED X szLocation5
           UNDEFINED X szLocation6
           UNDEFINED X szLocation7
           UNDEFINED X szLocation8
           UNDEFINED X szLocation9
           UNDEFINED X szLocation10
           "2" -> cMode
           UNDEFINED X idBranchConstantRecord
0008    GC LocationSAVE = GC Location
0009    GC RowChanged = "Y"
0010    //
0011    // SAR 7189942 - If the Location changes, clear the memo lot fields.  Edit
0012    // Line will return the memo lot fields if they are blank.
0013    VA frm_cClearMemo_CHAR = "1"
0014    // end SAR 7189942
0015    //
0016 End If

=======================================================================
     CONTROL:  GRIDCOL Lot/Serial
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 // *************************************************************
0002 // Modifications:
0003 //
0004 // 08/26/2004  JS6787836  7189942 - If location changes, clear memo lot
0005 // *************************************************************
0006 If GC Lot SerialNumber_SAVE is not equal to GC Lot/Serial
0007    GC Lot SerialNumber_SAVE = GC Lot/Serial
0008    GC RowChanged = "Y"
0009    //
0010    // SAR 7189942 - If the Lot changes, clear the memo lot fields.  Edit
0011    // Line will return the memo lot fields if they are blank.
0012    VA frm_cClearMemo_CHAR = "1"
0013    // end SAR 7189942
0014    //
0015 End If

=======================================================================
     CONTROL:  GRIDCOL Branch/ Plant
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC Branch/Plant is not equal to GC BusinessUnit_SAVE
0002    GC BusinessUnit_SAVE = GC Branch/Plant
0003    GC RowChanged = "Y"
0004 End If

=======================================================================
     CONTROL:  GRIDCOL Quantity Backordered
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC QuantityBackordered_SAVE is not equal to GC QuantityBackordered
0002    GC QuantityBackordered_SAVE = GC QuantityBackordered
0003    GC RowChanged = "Y"
0004 End If

=======================================================================
     CONTROL:  GRIDCOL Quantity Canceled
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC QuantityCanceled_SAVE is not equal to GC QuantityCanceled
0002    GC QuantityCanceled_SAVE = GC QuantityCanceled
0003    GC RowChanged = "Y"
0004 End If

=======================================================================
     CONTROL:  GRIDCOL Ln Ty
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC LnTy_SAVE is not equal to GC LnTy
0002    GC LnTy_SAVE = GC LnTy
0003    GC RowChanged = "Y"
0004 End If

=======================================================================
     CONTROL:  GRIDCOL Container I.D.
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC ContainerI.D._SAVE is not equal to GC ContainerI.D.
0002    GC ContainerI.D._SAVE = GC ContainerI.D.
0003    GC RowChanged = "Y"
0004 End If

=======================================================================
     CONTROL:  GRIDCOL Ship To Number
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC Ship ToNumber_SAVE is not equal to GC Ship ToNumber
0002    GC Ship ToNumber_SAVE = GC Ship ToNumber
0003    GC RowChanged = "Y"
0004 End If

=======================================================================
     CONTROL:  GRIDCOL Carrier Number
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC CarrierNumberSAVE is not equal to GC CarrierNumber
0002    GC CarrierNumberSAVE = GC CarrierNumber
0003    GC RowChanged = "Y"
0004 End If

=======================================================================
     CONTROL:  GRIDCOL Actual Ship Date
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC Actual ShipDate_SAVE is not equal to GC Actual ShipDate
0002    GC Actual ShipDate_SAVE = GC Actual ShipDate
0003    GC RowChanged = "Y"
0004 End If

=======================================================================
     CONTROL:  GRIDCOL Actual Ship Time
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
     evt_szTimeEditErrorMsgID_DTAI
0001 //
0002 If GC ActualShip Time - Save is not equal to GC ActualShip Time
0003    // =========================================================
0004    // Edit the entered time
0005    // =========================================================
0006    Edit Numeric Time Entry
           GC Actual Ship Time <> mnTimeEntered
           <Blank> -> cSuppressErrorMessages
           VA evt_szTimeEditErrorMsgID_DTAI <- szErrorMessageID
0007    //
0008    // =========================================================
0009    // If no errors copy to save grid column
0010    // =========================================================
0011    If VA evt_szTimeEditErrorMsgID_DTAI is equal to <Blank> Or VA evt_szTimeEditErrorMsgID_DTAI is equal to <Null>
0012       GC ActualShip Time - Save = GC ActualShip Time
0013       GC RowChanged = "Y"
0014    End If
0015 End If

=======================================================================
     CONTROL:  GRIDCOL Ambient Volume
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC AmbientVolume_Save is not equal to GC AmbientVolume
0002    GC AmbientVolume_Save = GC AmbientVolume
0003    GC RowChanged = "Y"
0004    GC Bulk RowChanged = "Y"
0005 End If

=======================================================================
     CONTROL:  GRIDCOL Ambient  Volume UOM
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC Ambient_Vol_UOM_Save is not equal to GC Ambient Volume UOM
0002    GC Ambient_Vol_UOM_Save = GC Ambient Volume UOM
0003    GC RowChanged = "Y"
0004    GC Bulk RowChanged = "Y"
0005 End If

=======================================================================
     CONTROL:  GRIDCOL Standard Volume
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC StandardVolume is not equal to GC StandardVolume_Save
0002    GC StandardVolume_Save = GC StandardVolume
0003    GC RowChanged = "Y"
0004    GC Bulk RowChanged = "Y"
0005 End If

=======================================================================
     CONTROL:  GRIDCOL Standard Volume UOM
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC Standard_VolumeUOM_Save is not equal to GC StandardVolume UOM
0002    GC Standard_VolumeUOM_Save = GC StandardVolume UOM
0003    GC RowChanged = "Y"
0004    GC Bulk RowChanged = "Y"
0005 End If

=======================================================================
     CONTROL:  GRIDCOL Weight Quantity
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC WeightResult_Save is not equal to GC WeightQuantity
0002    GC WeightResult_Save = GC WeightQuantity
0003    GC RowChanged = "Y"
0004    GC Bulk RowChanged = "Y"
0005 End If

=======================================================================
     CONTROL:  GRIDCOL Weight  Qty UOM
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC Weight_QtyUOM_Save is not equal to GC Weight Qty UOM
0002    GC Weight_QtyUOM_Save = GC Weight Qty UOM
0003    GC RowChanged = "Y"
0004    GC Bulk RowChanged = "Y"
0005 End If

=======================================================================
     CONTROL:  GRIDCOL Temperature
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC TemperatureSave is not equal to GC Temperature
0002    GC TemperatureSave = GC Temperature
0003    GC RowChanged = "Y"
0004    GC Bulk RowChanged = "Y"
0005 End If

=======================================================================
     CONTROL:  GRIDCOL Temp Type
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC TemperatureType_Save is not equal to GC TempType
0002    GC TemperatureType_Save = GC TempType
0003    GC RowChanged = "Y"
0004    GC Bulk RowChanged = "Y"
0005 End If

=======================================================================
     CONTROL:  GRIDCOL Display Density
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC DisplayDensity_Save is not equal to GC DisplayDensity
0002    GC DisplayDensity_Save = GC DisplayDensity
0003    GC RowChanged = "Y"
0004    GC Bulk RowChanged = "Y"
0005 End If

=======================================================================
     CONTROL:  GRIDCOL Density Type
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC DensityType_Save is not equal to GC DensityType
0002    GC DensityType_Save = GC DensityType
0003    GC RowChanged = "Y"
0004    GC Bulk RowChanged = "Y"
0005 End If

=======================================================================
     CONTROL:  GRIDCOL Density Temp
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC DensityType_Save is not equal to GC DensityType
0002    GC DensityType_Save = GC DensityType
0003    GC RowChanged = "Y"
0004    GC Bulk RowChanged = "Y"
0005 End If

=======================================================================
     CONTROL:  GRIDCOL Density  Temp Type
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC Density_TempType_Save is not equal to GC Density Temp Type
0002    GC Density_TempType_Save = GC Density Temp Type
0003    GC RowChanged = "Y"
0004    GC Bulk RowChanged = "Y"
0005 End If

=======================================================================
     CONTROL:  GRIDCOL Vol Cor Factor
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC Vol CorFactor_Save is not equal to GC Vol CorFactor
0002    GC Vol CorFactor_Save = GC Vol CorFactor
0003    GC RowChanged = "Y"
0004    GC Bulk RowChanged = "Y"
0005 End If

=======================================================================
     CONTROL:  GRIDCOL Transaction Time - Bulk
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 If GC TransavctionTime_Save is not equal to GC TransactionTime - Bulk
0002    GC TransavctionTime_Save = GC TransactionTime - Bulk
0003    GC RowChanged = "Y"
0004 End If

=======================================================================
     CONTROL:  GRIDCOL Lot Expiration Date
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 // =====================================
0002 // Pinnacle - Multiple Lot Dates
0003 // =====================================
0004 If GC Lot ExpirationDate_Save is not equal to GC Lot ExpirationDate
0005    GC Lot ExpirationDate_Save = GC Lot ExpirationDate
0006    GC RowChanged = "Y"
0007 End If
0008 // =====================================
0009 // End Pinnacle - Multiple Lot Dates
0010 // =====================================

=======================================================================
     CONTROL:  GRIDCOL Lot Effectivity Date
     EVENT:  Col Exited & Changed - Inline
-----------------------------------------------------------------------
0001 // =====================================
0002 // Pinnacle - Multiple Lot Dates
0003 // =====================================
0004 If GC Lot EffectivityDate_Save is not equal to GC Lot EffectivityDate
0005    GC Lot EffectivityDate_Save = GC Lot EffectivityDate
0006    GC RowChanged = "Y"
0007 End If
0008 // =====================================
0009 // End Pinnacle - Multiple Lot Dates
0010 // =====================================

=======================================================================
     CONTROL:  BUTTON EditLine [HIDDEN]
     EVENT:  Button Clicked
-----------------------------------------------------------------------
0001 //
0002 // ********************************************
0003 // CALL SHIP CONFIRM MBF TO PERFORM EDITS.
0004 //
0005 // LINE WAS DESELECTED.  DO NOT SHIP CONFIRM.
0006 If VA frm_CancelForm is not equal to "Y"
0007    If GC Sel = 1 is not equal to "1"
        And GC RecordWritten is greater than <Zero>
0008       //   REMOVE RECORD FROM SHIP CONFIRM CACHE
0009       GC AC = "D"
0010 !       F42UI05 Edit Line
     !          GRIDCOLUMN X mnWorkFileLineNumber
     !          UNDEFINED X cProcessEdits
     !          GC Error Code [HIDDEN] <- cErrorConditions
     !          UNDEFINED X cUpdateWrite
     !          GC Record Written [HIDDEN] <> cRecordWritten
     !          GC Order Number -> mnOrderNumber
     !          GC Or Ty -> szOrderType
     !          GC Order Co -> szOrderCompany
     !          GC Line Number -> mnLineNumber
     !          GC Branch/ Plant -> szBranchPlant
     !          GC Location -> szLocation
     !          GC Lot/Serial -> szLot
     !          GC Quantity Shipped <> mnEnteredShipQuantity
     !          GC Quantity Backordered -> mnEnteredBackorderQuantity
     !          GC Quantity Canceled -> mnEnteredCancelQuantity
     !          GC Ln Ty -> szEnteredLineType
     !          GC Container I.D. -> szContainerID
     !          GC Carrier Number -> mnCarrier
     !          UNDEFINED X mnUnitPrice
     !          UNDEFINED X mnUnitCost
     !          UNDEFINED X mnExtendedCost
     !          UNDEFINED X mnExtendedPrice
     !          UNDEFINED X jdActualDeliveryDate
     !          "EP4205" -> szProgramID
     !          UNDEFINED X mnLastLineNumber
     !          "1" -> cWriteIfWarning
     !          GRIDCOLUMN X mnReferenceLinenumber
     !          GC Description -> szDescription
     !          VA frm_Job_Number <> mnJobnumberA
     !          VA frm_UserID -> szUserId
     !          VA frm_ComputerID -> szWorkStationId
     !          VA frm_VersionName -> szVersion
     !          GC A C [HIDDEN] -> cActionCode
     !          <Zero> -> cModeProcessing
     !          UNDEFINED X mnTRAN_ShipmentNumber
     !          UNDEFINED X jdTRAN_DeliveryDate
     !          UNDEFINED X cTRAN_InventoryAffectFlag
     !          UNDEFINED X szTRAN_OverrideDocumentType
     !          UNDEFINED X mnTRAN_OverrideInventoryDocNum
     !          UNDEFINED X szTRAN_OverrideNextStatus
     !          UNDEFINED X cTRAN_OverrideLeaveShippable
     !          GC Ambient Volume -> mnBULK_AmbientQtyEntered
     !          GC Ambient  Volume UOM -> szBULK_AmbientQtyEnteredUOM
     !          GC Standard Volume -> mnBULK_StandardQtyEntered
     !          GC Standard Volume UOM -> szBULK_StandardQtyEnteredUOM
     !          GC Weight Quantity -> mnBULK_WeightQtyEntered
     !          GC Temperature -> mnBULK_Temperature
     !          GC Temp Type -> cBULK_ProductTemperatureType
     !          GC Display Density -> mnBULK_ProductDensity
     !          GC Density Temp -> mnBULK_DensityTemperature
     !          GC Density  Temp Type -> cBULK_DensityTemperatureType
     !          GC Transaction Time - Bulk -> mnBULK_TransactionTime
     !          GC Weight  Qty UOM -> szBULK_WeightQtyEnteredUOM
     !          GC Density Type -> cBULK_ProductDensityType
     !          GB Vol Cor Factor -> mnBulk_VolumeCorrectionFactors
     !          GC Original OrderCo [HIDDEN] -> szOriginal_CompanyKeyOrderNo
     !          GC Original OrderType [HIDDEN] -> szOriginal_OrderType2
     !          GC Original OrderNum [HIDDEN] -> mnOriginal_OrderNumber
     !          GC Original LineNum [HIDDEN] -> mnOriginal_LineNumber_3
     !          UNDEFINED X szMemoLotField1
     !          UNDEFINED X szMemoLotField2
     !          UNDEFINED X szVendorLotNumber
     !          GC XT4111 Line Number [HIDDEN] <> mnXT4111LineNumber
     !          GC B4200310 Line Number [HIDDEN] <> mnB4200310LineNumber
     !          GC Unit of Measure -> szUnitOfMeasureAsInput
     !          GC Quantity Shipped - Ovr_Undr [HIDDEN] -> mnMultiLocQtyShipVariance
     !          UNDEFINED X mnMultiLocParentOrderQuantity
     !          UNDEFINED X mnAddressNumberShipTo
     !          UNDEFINED X szLineType_2
     !          UNDEFINED X mnAddressNumber
0011       GC AC = "C"
0012       GC XT4111Line Number = ""
0013       GC PreviousSelect Value = ""
0014    Else
0015       //      ROW HAS CHANGED OR HAS BEEN SELECTED FOR SHIP CONFIRM
0016       If GC RowChanged is equal to "Y"
           Or GC Sel = 1 is equal to "1"
           And GC PreviousSelect Value is not equal to "1"
0017          //
0018          //  Default Ship Information
0019          //
0020          //     SET DEFAULT VALUES FROM SHIP CONFIRM DEFAULT SCREEN.
0021          //
0022          If GC Actual ShipDate is less than or equal to <Blank>
              Or GC Actual ShipDate is not equal to GC Actual ShipDate_SAVE
0023             GC Actual ShipDate = VA frm_Default_ShipDate
0024             If VA frm_Default_ShipDate is not equal to VA frm_AuditInfoDate
                 And GC Actual ShipDate_SAVE is less than or equal to <Blank>
0025                GC Actual ShipDate_SAVE = VA frm_Default_ShipDate
0026             End If
0027          End If
0028          //
0029          If GC CarrierNumber is less than or equal to <Zero>
0030             GC CarrierNumber = VA frm_Default_CarrierNumber
0031             GC CarrierNumberSAVE = VA frm_Default_CarrierNumber
0032          End If
0033          //
0034          If GC ContainerI.D. is less than or equal to <Blank>
0035             GC ContainerI.D. = VA frm_Default_ContainerID
0036             GC ContainerI.D._SAVE = VA frm_Default_ContainerID
0037          End If
0038          //
0039          // CALL SHIP CONFIRM EDITLINE
0040 !          F42UI05 Edit Line
     !             GRIDCOLUMN X mnWorkFileLineNumber
     !             UNDEFINED X cProcessEdits
     !             GC Error Code [HIDDEN] <- cErrorConditions
     !             UNDEFINED X cUpdateWrite
     !             GC Record Written [HIDDEN] <> cRecordWritten
     !             GC Order Number -> mnOrderNumber
     !             GC Or Ty -> szOrderType
     !             GC Order Co -> szOrderCompany
     !             GC Line Number -> mnLineNumber
     !             GC Branch/ Plant -> szBranchPlant
     !             GC Location -> szLocation
     !             GC Lot/Serial -> szLot
     !             GC Quantity Shipped -> mnEnteredShipQuantity
     !             GC Quantity Backordered -> mnEnteredBackorderQuantity
     !             GC Quantity Canceled -> mnEnteredCancelQuantity
     !             GC Ln Ty -> szEnteredLineType
     !             GC Container I.D. -> szContainerID
     !             GC Carrier Number -> mnCarrier
     !             UNDEFINED X mnUnitPrice
     !             UNDEFINED X mnUnitCost
     !             UNDEFINED X mnExtendedCost
     !             UNDEFINED X mnExtendedPrice
     !             GC Actual Ship Date -> jdActualDeliveryDate
     !             "EP4205" -> szProgramID
     !             UNDEFINED X mnLastLineNumber
     !             "1" -> cWriteIfWarning
     !             GRIDCOLUMN X mnReferenceLinenumber
     !             GC Description -> szDescription
     !             VA frm_Job_Number <> mnJobnumberA
     !             VA frm_UserID -> szUserId
     !             VA frm_ComputerID -> szWorkStationId
     !             VA frm_VersionName -> szVersion
     !             GC A C [HIDDEN] -> cActionCode
     !             GC Edit Mode [HIDDEN] -> cModeProcessing
     !             UNDEFINED X mnTRAN_ShipmentNumber
     !             FI jdTRAN_DELIVERY_DATE -> jdTRAN_DeliveryDate
     !             FI cTRAN_InventoryAffectFlag -> cTRAN_InventoryAffectFlag
     !             FI szTRAN_OverrideDocType -> szTRAN_OverrideDocumentType
     !             UNDEFINED X mnTRAN_OverrideInventoryDocNum
     !             FI szTRAN_OverrideNextStatusCode -> szTRAN_OverrideNextStatus
     !             FI cTRAN_OverrideLeaveShippable -> cTRAN_OverrideLeaveShippable
     !             GC Ambient Volume -> mnBULK_AmbientQtyEntered
     !             GC Ambient  Volume UOM -> szBULK_AmbientQtyEnteredUOM
     !             GC Standard Volume -> mnBULK_StandardQtyEntered
     !             GC Standard Volume UOM -> szBULK_StandardQtyEnteredUOM
     !             GC Weight Quantity -> mnBULK_WeightQtyEntered
     !             GC Temperature -> mnBULK_Temperature
     !             GC Temp Type -> cBULK_ProductTemperatureType
     !             GC Display Density -> mnBULK_ProductDensity
     !             GC Density Temp -> mnBULK_DensityTemperature
     !             GC Density  Temp Type -> cBULK_DensityTemperatureType
     !             GC Transaction Time - Bulk -> mnBULK_TransactionTime
     !             GC Weight  Qty UOM -> szBULK_WeightQtyEnteredUOM
     !             GC Density Type -> cBULK_ProductDensityType
     !             GC Vol Cor Factor -> mnBulk_VolumeCorrectionFactors
     !             GC Original OrderCo [HIDDEN] -> szOriginal_CompanyKeyOrderNo
     !             GC Original OrderType [HIDDEN] -> szOriginal_OrderType2
     !             GC Original OrderNum [HIDDEN] -> mnOriginal_OrderNumber
     !             GC Original LineNum [HIDDEN] -> mnOriginal_LineNumber_3
     !             GC Memo Lot 1 -> szMemoLotField1
     !             GC Memo Lot 2 -> szMemoLotField2
     !             GC Supplier Lot Number -> szVendorLotNumber
     !             GC XT4111 Line Number [HIDDEN] <> mnXT4111LineNumber
     !             GC B4200310 Line Number [HIDDEN] <> mnB4200310LineNumber
     !             GC Unit of Measure -> szUnitOfMeasureAsInput
     !             GC Quantity Shipped - Ovr_Undr [HIDDEN] -> mnMultiLocQtyShipVariance
     !             GC UORG - QtyOrdered-Parent [HIDDEN] -> mnMultiLocParentOrderQuantity
     !             GC Ship To Number -> mnAddressNumberShipTo
     !             GC Ln Ty -> szLineType_2
     !             UNDEFINED X mnAddressNumber
0041          VA frm_RecordsInCache = "Y"
0042          //
0043          If GC Sel = 1 is not equal to "1"
0044             GC Sel = 1 = "1"
0045          End If
0046          If GC ErrorCode is equal to <Blank>
              Or GC ErrorCode is equal to <Null>
0047             GC PreviousSelect Value = "1"
0048          Else
0049             GC PreviousSelect Value = "0"
0050          End If
0051          GC RowChanged = "N"
0052       End If
0053    End If
0054 End If

=======================================================================
     CONTROL:  BUTTON Configuration [HIDDEN]
     EVENT:  Button Clicked
-----------------------------------------------------------------------
     evt_StockingType
     evt_RatioShipped
     evt_ParentQtyShippedSaved
     evt_ParentQtyOrderedSaved
     evt_ParentOrderType
     evt_ParentOrderInvoiceE
     evt_ParentLineNumber
     evt_BaseLineNumber
     evt_ComparisonLineNumber
     evt_ParentCompanyKey
     evt_NumbOfCpntPerBaseParent
     evt_MaxGridRowNumber
     evt_GenerateWorkorder
     evt_CurrentGridRowNumber
     evt_CacheErrorConfiguredItem
0001 // 3155905 - This Push Buttom was added for the processing of Configured Items.
0002 // Upon exiting a row, if the row relates to a Configured Item, all child rows o
0003 // the Configured Item will also be selected for processing. The Quantity
0004 // Shipped amount will be adjusted for each line to be the ration same ratio of
0005 // Shipped to Origanal Shipped as the parent line.
0006 //
0007 // ****************************************************************
0008 // Determine if the Line is a Configured Item.  If not, stop processing.
0009 // ****************************************************************
0010 //
0011 If GC Committed is equal to "K"
     Or GC Committed is equal to "H"
0012    //
0013    F4102 Get Item Manufacturing Information
           GC Branch/ Plant -> szBranch
           GC Short Item No -> mnShortItemNumber
           VA evt_StockingType <- cStockingType
           UNDEFINED X cIssueTypeCode
           UNDEFINED X cPlanningCode
           UNDEFINED X mnPlanningFence
           UNDEFINED X mnFreezeFence
           UNDEFINED X mnMessageDisplayFence
           UNDEFINED X mnTimeFence
           UNDEFINED X cPlanningFenceRule
           UNDEFINED X cFixedVariableLeadtime
           UNDEFINED X mnLeadtimeLevel
           UNDEFINED X mnLeadtimeMfg
           UNDEFINED X mnLeadtimeCumulative
           UNDEFINED X mnLeadtimePerUnit
           UNDEFINED X mnMFGLeadtimeQty
           UNDEFINED X mnShrinkFactor
           UNDEFINED X cShrinkFactorMethod
           UNDEFINED X cOrderPolicyCode
           UNDEFINED X mnOrderPolicyValue
           UNDEFINED X mnAccountingCostQuantity
           UNDEFINED X cTimeBasisCode
           UNDEFINED X mnMoveHours
           UNDEFINED X mnQueueHours
           UNDEFINED X mnStandardSetupHours
           UNDEFINED X cErrorIndicator
           UNDEFINED X mnPlannerNumber
           UNDEFINED X mnLowLevelCode
           UNDEFINED X cSuppressErrorMessage
           UNDEFINED X szErrorMessageID
           UNDEFINED X cNetChangeFlag
           UNDEFINED X idF4102Pointer
           UNDEFINED X szLineType
           UNDEFINED X mnSafetyStock
           UNDEFINED X cLotStatusCode
           UNDEFINED X cAbcCode
           UNDEFINED X cAllocateByLot
           UNDEFINED X szMasterPlanning
           UNDEFINED X mnBuyer
           UNDEFINED X cPotencyControl
           UNDEFINED X mnStandardPotency
           UNDEFINED X cLotExpDateCalcMeth
           UNDEFINED X cActiveIngredientFlag
           UNDEFINED X cCrossDockFlagYN
0014    //
0015    If VA evt_StockingType is not equal to "C"
0016       //
0017       Stop Processing
0018    End If
0019 Else
0020    Stop Processing
0021 End If
0022 //
0023 // ****************************************************************
0024 // continue processing if Line being processed is a Configured Item
0025 // ****************************************************************
0026 //
0027 // save values for current grids row
0028 //
0029 VA evt_ParentQtyOrderedSaved = GC UORG - QtyOrdered-Parent
0030 VA evt_ParentQtyShippedSaved = GC QuantityShipped
0031 VA evt_ParentOrderInvoiceE = GC OrderNumber
0032 VA evt_ParentOrderType = GC OrTy
0033 VA evt_ParentCompanyKey = GC OrderCo
0034 VA evt_ParentLineNumber = GC LineNumber
0035 VA evt_BaseLineNumber = round([GC LineNumber],0)
0036 GC Sel = 1 = "1"
0037 //
0038 // establish values for grid math
0039 //
0040 Get Max Grid Rows(FC Grid, VA evt_MaxGridRowNumber)
0041 Get Selected Grid Row Number(FC Grid, VA evt_CurrentGridRowNumber)
0042 //
0043 // write base parent record to cache
0044 //
0045 Process Configured Items Cache
        VA frm_Job_Number -> mnConfigItemJobNumber
        VA frm_ComputerID -> szComputerID
        GC Order Number -> mnDocumentOrderInvoiceE
        GC Or Ty -> szOrderType
        GC Order Co -> szCompanyKey
        GC Line Number -> mnLineNumber
        "7" -> szCacheActionCode
        UNDEFINED X idCacheCursor
        "6" -> mnNumberKeys
        <Blank> -> cSuppressErrorMessage
        UNDEFINED X szErrorMessageID
        UNDEFINED X mnNumbOfCpntPerParent
        UNDEFINED X mnNumbOfCpntPerBaseLine
0046 //
0047 // calculate ratio for shipped quantity
0048 //
0049 VA evt_RatioShipped = [GC QuantityShipped]/[GC Orig Quantity Shipped - Static]
0050 //
0051 // ****************************************************************
0052 // Position Grid processing to one row following the requested row
0053 // ****************************************************************
0054 //
0055 VA evt_CurrentGridRowNumber = 1
0056 Get Grid Row(FC Grid, VA evt_CurrentGridRowNumber)
0057 //
0058 While GC LineNumber is not equal to VA evt_ParentLineNumber
0059    VA evt_CurrentGridRowNumber = [VA evt_CurrentGridRowNumber]+1
0060    Get Grid Row(FC Grid, VA evt_CurrentGridRowNumber)
0061 End While
0062 //
0063 VA evt_CurrentGridRowNumber = [VA evt_CurrentGridRowNumber]+1
0064 //
0065 // ****************************************************************
0066 // Process all grid rows, adjusting the amounts in complying
0067 // grid rows and adding Component Items to the cache
0068 // ****************************************************************
0069 //
0070 //
0071 While VA evt_CurrentGridRowNumber is less than or equal to VA evt_MaxGridRowNumber
0072    //
0073    Get Grid Row(FC Grid, VA evt_CurrentGridRowNumber)
0074    //
0075    // Compute Line value to compare against the base Parent Line Number.
0076    // (This prevents cross over from previous splits of a line.)
0077    //
0078    VA evt_ComparisonLineNumber = round([GC LineNumber],0)
0079    //
0080    // only process rows matching Parent row saved values
0081    //
0082    If GC OrderNumber is equal to VA evt_ParentOrderInvoiceE
        And GC OrTy is equal to VA evt_ParentOrderType
        And GC OrderCo is equal to VA evt_ParentCompanyKey
        And GC LineNumber is greater than VA evt_ParentLineNumber
        And VA evt_BaseLineNumber is equal to VA evt_ComparisonLineNumber
0083       //
0084       // determine if the row is related to the base parent - parent in cache
0085       //
0086       Process Configured Items Cache
              VA frm_Job_Number -> mnConfigItemJobNumber
              VA frm_ComputerID -> szComputerID
              GC Order Number -> mnDocumentOrderInvoiceE
              GC Or Ty -> szOrderType
              GC Order Co -> szCompanyKey
              GC Kit ln Number -> mnLineNumber
              "1" -> szCacheActionCode
              UNDEFINED X idCacheCursor
              "6" -> mnNumberKeys
              "1" -> cSuppressErrorMessage
              VA evt_CacheErrorConfiguredItem <- szErrorMessageID
              UNDEFINED X mnNumbOfCpntPerParent
              UNDEFINED X mnNumbOfCpntPerBaseLine
0087       If VA evt_CacheErrorConfiguredItem is less than or equal to <Blank>
0088          //
0089          GC Sel = 1 = "1"
0090          GC QuantityShipped = [GC Orig Quantity Shipped - Static]*[VA evt_RatioShipped]
0091          //
0092          // determine if the row is Non Work Order Component Item
0093          //
0094          If GC Committed is equal to "K"
0095             //
0096             F40205 Get Line Type Constants
                    GC Ln Ty -> szLineType
                    UNDEFINED X szLineTypeDesc
                    UNDEFINED X szLineTypeDesc2
                    UNDEFINED X cGLInterface
                    UNDEFINED X cInventoryInterface
                    UNDEFINED X cARInterface
                    UNDEFINED X cAPInterface
                    UNDEFINED X cReverseSign
                    UNDEFINED X cTextLine
                    UNDEFINED X cIncludeSalesCOGS
                    UNDEFINED X cIncludeCashDiscount
                    UNDEFINED X cIncludeTax1
                    UNDEFINED X cIncludeTax2
                    UNDEFINED X szGLOffset
                    UNDEFINED X cPrintDocument1
                    UNDEFINED X cPrintDocument2
                    UNDEFINED X cPrintDocument3
                    UNDEFINED X cRecordVariance
                    UNDEFINED X cIncludeTotalDocument1
                    UNDEFINED X cIncludeTotalDocument2
                    UNDEFINED X cIncludeTotalDocument3
                    UNDEFINED X cIncludeTotaldocument4
                    UNDEFINED X cIncludeColumnSalesJournal
                    UNDEFINED X szOrderType
                    UNDEFINED X cApplyRetainage
                    UNDEFINED X cApplyFreight
                    VA evt_GenerateWorkorder <- cGenerateWorkOrder
                    UNDEFINED X cSuppressErrorMessage
                    UNDEFINED X cErrorCode
                    UNDEFINED X cCallMaterialsIssue
0097             If VA evt_GenerateWorkorder is not equal to "1"
0098                //
0099                // line being processed is a Non Work Order Configured Item
0100                // add the line to the Configured Items cache
0101                //
0102                Process Configured Items Cache
                       VA frm_Job_Number -> mnConfigItemJobNumber
                       VA frm_ComputerID -> szComputerID
                       GC Order Number -> mnDocumentOrderInvoiceE
                       GC Or Ty -> szOrderType
                       GC Order Co -> szCompanyKey
                       GC Line Number -> mnLineNumber
                       "7" -> szCacheActionCode
                       UNDEFINED X idCacheCursor
                       "6" -> mnNumberKeys
                       <Blank> -> cSuppressErrorMessage
                       UNDEFINED X szErrorMessageID
                       UNDEFINED X mnNumbOfCpntPerParent
                       UNDEFINED X mnNumbOfCpntPerBaseLine
0103                //
0104             End If
0105             //
0106          End If
0107       End If
0108       //
0109    End If
0110    //
0111    VA evt_CurrentGridRowNumber = [VA evt_CurrentGridRowNumber]+1
0112    //
0113 End While
0114 //
0115 // clear the Component Item cache
0116 //
0117 Process Configured Items Cache
        VA frm_Job_Number -> mnConfigItemJobNumber
        VA frm_ComputerID -> szComputerID
        UNDEFINED X mnDocumentOrderInvoiceE
        UNDEFINED X szOrderType
        UNDEFINED X szCompanyKey
        UNDEFINED X mnLineNumber
        "5" -> szCacheActionCode
        UNDEFINED X idCacheCursor
        "2" -> mnNumberKeys
        "1" -> cSuppressErrorMessage
        UNDEFINED X szErrorMessageID
        UNDEFINED X mnNumbOfCpntPerParent
        UNDEFINED X mnNumbOfCpntPerBaseLine

=======================================================================
     CONTROL:  BUTTON OKButtonEditLineLogic [HIDDEN]
     EVENT:  Button Clicked
-----------------------------------------------------------------------
     evt_mnGridRowCounter_MATH01
0001 // ==================================================================
0002 // Author:  Randy Mendyk
0003 // Date:  04/01/03
0004 // SAR Number:  6581256
0005 // Notes:
0006 // This Button will perform the necessary calls to F42UI05 Edit Line for all
0007 // grid rows which have not been processed prior to the clicking of the OK
0008 // button clicked event.  This logic is a modified version of what
0009 // is currently run in the Row is Exited & Changed Asynch event.  Currently,
0010 // the tool only runs the Row is Exited & Changed Asynch event for the grid
0011 // row where focus lies when the OK button is clicked.  If there is more than
0012 // one grid row and the user has not set focus on all grid rows, they will not
0013 // be processed prior to the Button Clicked event of OK button.  This is a
0014 // problem because the call to Ship Confirm Edit Document needs to have all
0015 // lines being confirmed in cache prior to it running in order to process all
0016 // lines.  Because of this, the OK button clicked event will now get the Max
0017 // Number Of Grid Rows.  If the number is greater than Zero, it will call Push
0018 // Button for this button to process any necessary lines.
0019 // ---------------------------------------------------------------------------
0020 // SAR LOG
0021 //
0022 // ==================================================================
0023 //
0024 // ==================
0025 // INITIALIZE VARIABLES
0026 // ==================
0027 VA evt_mnGridRowCounter_MATH01 = "1"
0028 //
0029 // ===========================================================================
0030 // While the row number is less than or equal to the total number of grid rows
0031 //       Get the GC values for the current row number being processed
0032 //        Increment the grid row counter
0033 //        If the grid row needs to be run through Edit Line
0034 //              Perform the necessary logic to prep for Edit Line call
0035 //              Call edit line for the grid row
0036 //              Perform the necessary logic after the Edit Line call
0037 // End of processing
0038 // ===========================================================================
0039 //
0040 While VA evt_mnGridRowCounter_MATH01 is less than or equal to VA frm_mnMaxNumOfGridRows_MATH01
0041    Get Grid Row(FC Grid, VA evt_mnGridRowCounter_MATH01)
0042    VA evt_mnGridRowCounter_MATH01 = [VA evt_mnGridRowCounter_MATH01]+1
0043    //
0044    //      ROW HAS CHANGED OR HAS BEEN SELECTED FOR SHIP CONFIRM
0045    //
0046    If GC RowChanged is equal to "Y"
        Or GC Sel = 1 is equal to "1"
        And GC PreviousSelect Value is not equal to "1"
0047       //
0048       //     SET DEFAULT VALUES FROM SHIP CONFIRM DEFAULT SCREEN.
0049       //
0050       If FI mnTRAN_TransportationJobNumber is not equal to <Zero>
0051          //  P4205 was called by Transportation.  Use Passed in ShipDate.
0052          //   (Do not allow overwrite of Carrier Number in F4211.)
0053          GC Actual ShipDate = VA frm_Default_ShipDate
0054          GC TransactionTime - Bulk = VA frm_DefaultLoadTime
0055          //
0056          // =======================================================================
0057          // Demand Scheduling - Times- Shipment Confirmation
0058          // =======================================================================
0059          If VA frm_cDemandSchedReleased_DSRFU is equal to "1"
0060             GC ActualShip Time = VA frm_mnDefaultShipTime_TME0
0061          End If
0062       Else
0063          //   Proceed with normal processing.
0064          If GC Actual ShipDate is less than or equal to <Blank>
0065             GC Actual ShipDate = VA frm_Default_ShipDate
0066          End If
0067          //
0068          // =======================================================================
0069          // Demand Scheduling - Times- Shipment Confirmation
0070          // =======================================================================
0071          If VA frm_cDemandSchedReleased_DSRFU is equal to "1"
0072             If GC ActualShip Time is equal to <Zero>
0073                GC ActualShip Time = VA frm_mnDefaultShipTime_TME0
0074             End If
0075          End If
0076          //
0077          If GC TransactionTime - Bulk is equal to <Zero>
0078             GC TransactionTime - Bulk = VA frm_DefaultLoadTime
0079          End If
0080          If GC CarrierNumber is less than or equal to <Zero>
0081             GC CarrierNumber = VA frm_Default_CarrierNumber
0082             GC CarrierNumberSAVE = VA frm_Default_CarrierNumber
0083          End If
0084       End If
0085       //
0086       If GC ContainerI.D. is less than or equal to <Blank>
0087          GC ContainerI.D. = VA frm_Default_ContainerID
0088          GC ContainerI.D._SAVE = VA frm_Default_ContainerID
0089       End If
0090       //
0091       // =====================================
0092       // CALL SHIP CONFIRM EDITLINE
0093       // =====================================
0094       F42UI05 Edit Line
              GC Error Code [HIDDEN] <- cErrorConditions
              GC Record Written [HIDDEN] <> cRecordWritten
              GC Order Number -> mnOrderNumber
              GC Or Ty -> szOrderType
              GC Order Co -> szOrderCompany
              GC Line Number -> mnLineNumber
              GC Branch/ Plant -> szBranchPlant
              GC Location <> szLocation
              GC Lot/Serial -> szLot
              GC Quantity Shipped <> mnEnteredShipQuantity
              GC Quantity Backordered -> mnEnteredBackorderQuantity
              GC Quantity Canceled -> mnEnteredCancelQuantity
              GC Ln Ty -> szEnteredLineType
              GC Container I.D. -> szContainerID
              GC Carrier Number -> mnCarrier
              GC Actual Ship Date -> jdActualDeliveryDate
              "EP4205" -> szProgramID
              "1" -> cWriteIfWarning
              GC Description -> szDescription
              VA frm_Job_Number <> mnJobnumberA
              VA frm_UserID -> szUserId
              VA frm_VersionName -> szVersion
              GC A C [HIDDEN] -> cActionCode
              GC Edit Mode [HIDDEN] -> cModeProcessing
              GC Shipment Number [HIDDEN] -> mnTRAN_ShipmentNumber
              FI jdTRAN_DELIVERY_DATE -> jdTRAN_DeliveryDate
              FI cTRAN_InventoryAffectFlag -> cTRAN_InventoryAffectFlag
              FI szTRAN_OverrideDocType -> szTRAN_OverrideDocumentType
              FI mnTRAN_OverrideDocNumber -> mnTRAN_OverrideInventoryDocNum
              FI szTRAN_OverrideNextStatusCode -> szTRAN_OverrideNextStatus
              FI cTRAN_OverrideLeaveShippable -> cTRAN_OverrideLeaveShippable
              GC Ambient Volume <> mnBULK_AmbientQtyEntered
              GC Ambient  Volume UOM <> szBULK_AmbientQtyEnteredUOM
              GC Standard Volume <> mnBULK_StandardQtyEntered
              GC Standard Volume UOM <> szBULK_StandardQtyEnteredUOM
              GC Weight Quantity <> mnBULK_WeightQtyEntered
              GC Temperature <> mnBULK_Temperature
              GC Temp Type <> cBULK_ProductTemperatureType
              GC Display Density <> mnBULK_ProductDensity
              GC Density Temp <> mnBULK_DensityTemperature
              GC Density  Temp Type <> cBULK_DensityTemperatureType
              GC Transaction Time - Bulk <> mnBULK_TransactionTime
              GC Weight  Qty UOM <> szBULK_WeightQtyEnteredUOM
              GC Density Type <> cBULK_ProductDensityType
              GC Vol Cor Factor <> mnBulk_VolumeCorrectionFactors
              GC Original OrderCo [HIDDEN] -> szOriginal_CompanyKeyOrderNo
              GC Original OrderType [HIDDEN] -> szOriginal_OrderType2
              GC Original OrderNum [HIDDEN] -> mnOriginal_OrderNumber
              GC Original LineNum [HIDDEN] -> mnOriginal_LineNumber_3
              GC Memo Lot 1 <> szMemoLotField1
              GC Memo Lot 2 <> szMemoLotField2
              GC Supplier Lot Number <> szVendorLotNumber
              GC XT4111 Line Number [HIDDEN] <> mnXT4111LineNumber
              GC B4200310 Line Number [HIDDEN] <> mnB4200310LineNumber
              GC Unit of Measure -> szUnitOfMeasureAsInput
              GC Quantity Shipped - Ovr_Undr [HIDDEN] -> mnMultiLocQtyShipVariance
              GC UORG - QtyOrdered-Parent [HIDDEN] -> mnMultiLocParentOrderQuantity
              GC Ship To Number -> mnAddressNumberShipTo
              GC Ln Ty -> szLineType_2
              GC Supp No -> mnContractSupplementDistri
              GC Agreement Number -> szContractNumberDistributi
              FI szTRAN_PrimaryVehicleId -> szTRAN_PrimaryVehicleId
              FI szTRAN_RegistrationLicNumber -> szTRAN_RegistrationLicenseNum
              FI szTRAN_OverrideCompanyKey -> szTRAN_DocumentCompany
              FI jdTRAN_LoadConfirmDate_2 -> jdTRAN_LoadConfirmDate
              FI mnTRAN_TimeLoad_2 -> mnTRAN_TimeLoad
              VA frm_ComputerID -> szComputerID
              GC Secondary Qty Shipped -> mnUnitsSecondaryQtyOr
              GC Secondary UoM -> szUnitOfMeasureSecondary
              GC Secondary Quantity - Over Under [HIDDEN] -> mnMultiLocSecondaryQtyShipVar
              GC UORG - Qty Ordered - Dual [HIDDEN] -> mnMultiLocSecondaryOrderQty
              GC Check Exp. Date [HIDDEN] <> cCheckExpirationDate
              GC Check Sell By Date [HIDDEN] <> cCheckSellByDate
              GC Check Best Before Date [HIDDEN] <> cCheckBestBeforeDate
              GC Based On Date [HIDDEN] <> jdBasedOnDate
              GC Lot Effectivity Date <> jdLotEffectivityDate
              VA frm_ShipAscendingDateActive <> cShipAscendingDateFlag
              GC Sell By Date [HIDDEN] <> jdSellByDate
              GC Best Before Date [HIDDEN] <> jdBestBeforeDate
              GC User Lot Date 1 [HIDDEN] <> jdUserLotDate1
              GC User Lot Date 2 [HIDDEN] <> jdUserLotDate2
              GC User Lot Date 3 [HIDDEN] <> jdUserLotDate3
              GC User Lot Date 4 [HIDDEN] <> jdUserLotDate4
              GC User Lot Date 5 [HIDDEN] <> jdUserLotDate5
              GC Inventory Transaction Type [HIDDEN] <> mnInvTransactionType
              GC Exit/ Entry -> szPortOfEntryExit
              GC Actual Ship Time -> mnActualShipmentTime
              FI cCalledByTransportation -> cCalledByTransportation
0095       VA frm_RecordsInCache = "Y"
0096       //
0097       If GC Sel = 1 is not equal to "1"
0098          GC Sel = 1 = "1"
0099       End If
0100       If GC ErrorCode is equal to <Blank>
           Or GC ErrorCode is equal to <Null>
0101          GC PreviousSelect Value = "1"
0102       Else
0103          GC PreviousSelect Value = "0"
0104       End If
0105       GC RowChanged = "N"
0106       // =====================================
0107       // Pinnacle - Multiple Lot Dates
0108       // =====================================
0109       If GC Lot EffectivityDate_Save is not equal to GC Lot EffectivityDate
0110          GC Lot EffectivityDate_Save = GC Lot EffectivityDate
0111       End If
0112       If GC Lot ExpirationDate_Save is not equal to GC Lot ExpirationDate
0113          GC Lot ExpirationDate_Save = GC Lot ExpirationDate
0114       End If
0115       // =====================================
0116       // End Pinnacle - Multiple Lot Dates
0117       // =====================================
0118       //
0119       // SAR 3242179 - 07/20/99 RB5679171
0120       // perform Update Configuration if no errors and Comitted is H or K.
0121       //
0122       If GC Committed is equal to "H,K"
           And GC ErrorCode is not equal to "2"
0123          Press Button(FC Configuration)
0124       End If
0125    End If
0126 End While

Wednesday October 01, 2014  16:57
